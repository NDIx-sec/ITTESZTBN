"use strict";function checkReady(){is_ready.config&&is_ready.html?(clearTimeout(waitForReady),sharedReady(),clientReady(),$.ajaxSetup({cache:!1})):waitForReady=setTimeout((function(){checkReady()}),100)}localState.layout=localState.layout||[],checkReady(),$.post("api/",{do:"getClientHtml"},(function(e){$(".bodycontent").html(e.html),$("div.main").hide(),is_ready.html=!0}));let hide_emojis,clientEventListeners=[],allow_hide=!0;function clientReady(){if(Layout.Init(),Language.Init(AppData.profile.user_lang),!Settings.Init())return;Navigation.Init(),Modal.Init(),Game.Init(),Agenda.Init(),Speakers.Init(),Useful.Init(),Docs.Init(),Channels.Init(),Quiz.Init(),Attendees.Init(),Profile.Init(),Qrcode.Init(),Roomlist.Init(),ChangePass.Init(),Notes.Init(),Points.Init(),Moderate.Init(),Stage.Init(),Issues.Init(),Bookings.Init(),Weblinks.Init(),Messageboard.Init(),Namecards.Init(),Photos.Init(),Broadcast.Init(),Chat.Init(),FavoriteAgenda.Init(),BookedAgenda.Init(),Gdpr.Init(),Translator.Init(),Soundchannels.Init(),Gallery.Init(),Camerastream.Init(),Notifications.Init(),Trueconf.Init(),Sponsors.Init(),Ondemandvideos.Init(),Unity3d.Init(),TranslatorRelay.Init(),Texts.Init(),Tetris.Init(),Modulsettings.Update(),setHomeScreenVideo(),1==AppData.profile.presi_control?SpeakerPresentation.Init():$(".speaker_presentation").remove(),Presentation.Init(),startEnigma(),startCatchit(),$(document).on("animationend",lazyImages),new MutationObserver((function(e,t){for(var a in e)"enigma"==$(e[a].target).attr("id")&&($(e[a].target).is(":visible")||enigmaGame.reset_game())})).observe($("#enigma").get(0),{attributes:!0,childList:!0,subtree:!0}),new MutationObserver((function(e,t){for(var a in e)"catchit"==$(e[a].target).attr("id")&&($(e[a].target).is(":visible")||catchit_game.hideGame())})).observe($("#catchit").get(0),{attributes:!0,childList:!0,subtree:!0}),new MutationObserver((function(e,t){for(var a in e)"weblinks-details"==$(e[a].target).attr("id")&&($(e[a].target).is(":visible")||(clearTimeout(Weblinks.loadtimer),$("#weblinksIframeId").unbind("load"),$("#weblinksIframeId").attr("src","")))})).observe($(".bodycontent > #weblinks-details").get(0),{attributes:!0,childList:!0,subtree:!0}),new MutationObserver((function(e,t){for(var a in e)"tetris"==$(e[a].target).attr("id")&&($(e[a].target).is(":visible")||Tetris.pauseGame())})).observe($("#tetris").get(0),{attributes:!0,childList:!0,subtree:!0});let e=$("#landing"),t=$(".stream_reactions");e.on("mouseover touchend",(function(){AppData.modulsettings.show_emoji_reactions&&$(".videostream, .trueconf").is(":visible")&&($(".stream_reactions").removeClass("hidden"),clearTimeout(hide_emojis),hide_emojis=setTimeout(hideEmojis,2e3))})),e.on("mousemove",(function(){clearTimeout(hide_emojis),AppData.modulsettings.show_emoji_reactions&&$(".videostream, .trueconf").is(":visible")&&($(".stream_reactions").removeClass("hidden"),hide_emojis=setTimeout(hideEmojis,2e3))})),e.on("mouseleave",(function(){AppData.modulsettings.show_emoji_reactions&&$(".videostream, .trueconf").is(":visible")&&(clearTimeout(hide_emojis),hide_emojis=setTimeout(hideEmojis,2e3))})),t.on("mouseover",(function(){allow_hide=!1})),t.on("mouseleave",(function(){allow_hide=!0}));var a=new URLSearchParams(window.location.search);if(a.has("share")){var n=new URLSearchParams(atob(a.get("share"))),o=n.get("m").toLowerCase(),i=o.charAt(0).toUpperCase()+o.slice(1);n.has("i")?"function"==typeof window[i].showDetails&&(localState.layout.push(o+"-details"),window[i].showDetails(n.get("i"))):Layout.show(o);var r=new URL(window.location);r.hash="",r.search="",history.pushState({},"",r.toString())}}function refreshDays(){$.post("api/",{do:"getDays"},(function(e){AppData.days=e,Agenda.BuildFromSource(),Issues.BuildFromSource(),Layout.hide("issues-details")}))}function fakeReactions(e){AppData.modulsettings.allowreactions&&randInt(0,100)>30&&setTimeout((function(){null!=e?"laugh"==e?$("#landing .reactions .laugh").trigger("click"):"clap"==e&&$("#landing .reactions .clap").trigger("click"):randInt(0,100)>50?$("#landing .reactions .laugh").trigger("click"):$("#landing .reactions .clap").trigger("click")}),randInt(100,400))}function getIsPremium(){Modal.alert(Language.getItem("check-premium"),(function(){location.reload()})),checkPremium()}function checkPremium(){setTimeout((function(){$.ajax({method:"post",url:"api/",data:{do:"checkPremium"},success:function(e){1==e.premium?location.reload():checkPremium()},error:function(){checkPremium()}})}),5e3)}var trueconf_opened=!1,trueconf_translator_opened=!1;function openTrueConfCall(e,t,a,n,o){$.ajax({method:"post",url:"api/",data:{do:"openTrueConfCall",room:e,server:t,guestname:AppData.profile.name[localState.lang]},success:function(t){""!=t.trueconf_url?(writeDbLog("open trueconf room",t.trueconf_url,"user_logs","trueconf"),!0===n?window.open(t.trueconf_url,"chat_"+e):(1==o?($("#landing .landing_elements .trueconf_translator").show(),$("#trueconf_iframe_translator").attr("src",t.trueconf_url),trueconf_translator_opened=!0):($("#landing .landing_elements .trueconf").show(),$("#trueconf_iframe").attr("src",t.trueconf_url),AppData.modulsettings.show_emoji_reactions?$(".stream_reactions").removeClass("hidden"):$(".stream_reactions").addClass("hidden"),trueconf_opened=!0),Layout.hideAll(),Broadcast.stopVideoStream(),Navigation.hideMenu()),""!=a&&null!=a&&Channels.setChannel(a)):(Modal.alert(Language.getItem("conference-not-available")),$("#default_nav").find("[data-target='trueconf']").css("border",""))}})}$(document).on("click",".trueconf-button.hangup",(function(){closeTrueConfCall($(this).attr("data-type"))})),window.addEventListener("message",(e=>{if("https://meeting2.rentit.hu"!==e.origin&&"https://meeting3.rentit.hu"!==e.origin&&"https://meeting5.rentit.hu"!==e.origin&&"https://meeting6.rentit.hu"!==e.origin||(console.log(e),"connectionClosed"===e.data.type&&closeTrueConfCall("default")),"open3D"===e.data.type&&Unity3d.load3DPlayer(e.data.scene||"default",e.data.url),"callRoom"===e.data.type&&(closeTrueConfCall(),openTrueConfCall(e.data.room,"workshop")),AppData.settings.infopanel_url.indexOf(e.origin)>-1&&("openTrueConf"===e.data.type&&Unity3d.call_exhibitor(e.data.room),"openChat"===e.data.type&&Unity3d.openTextChat(e.data.uid),"fisu_dwf_360"===e.data.type&&Ondemandvideos.showList(e.data.target),"open_eep"===e.data.type)){var t=AppData.settings.infopanel_url+"/"+e.data.target;t+="?pid="+encodeURIComponent(btoa(AppData.profile.id)),Weblinks.showPortal(t)}}));let from3d=!1;function closeTrueConfCall(e){trueconf_opened&&"default"==e&&($("#trueconf_iframe").attr("src",""),$("#landing .landing_elements .trueconf").hide(),$("#default_nav").find("[data-target='trueconf']").css("border",""),trueconf_opened=!1),trueconf_translator_opened&&"translator"==e&&($("#trueconf_iframe_translator").attr("src",""),$("#landing .landing_elements .trueconf_translator").hide(),$("#default_nav").find("[data-target='trueconf']").css("border",""),trueconf_translator_opened=!1),!1!==from3d&&"3d"!=e&&(trueconf_opened=!1,Unity3d.load3DPlayer("default",from3d)),$(".stream_reactions").addClass("hidden")}function logVideoWatch(e,t){$.ajax({method:"post",url:"api/",data:{do:"logVideoWatch",action:e,stream_url:t}})}function hideEmojis(){allow_hide&&!$(".trueconf").is(":visible")&&$(".stream_reactions").fadeOut(800,(function(){$(this).removeAttr("style").addClass("hidden")}))}function sendStreamReaction(e){let t;if($(".videostream").is(":visible")&&(t=$(".videostream")),$("#trueconf_iframe").is(":visible")&&(t=$("#trueconf_iframe")),null!=t){let t,a,n=$("<span/>"),o=$(".stream_reactions [data-type='"+e.icon+"']").html();if(n.html(o),n.appendTo($(".landing_elements")),n.addClass("animated_reaction"),e.own)"left"==AppData.modulsettings.emoji_pos?(n.addClass("left"),a=$(".stream_reactions [data-type='"+e.icon+"']").offset().top+$(".stream_reactions [data-type='"+e.icon+"']").height()/2-n.height()/2-$(".landing_elements").offset().top,n.css({top:a})):"top"==AppData.modulsettings.emoji_pos?(n.addClass("top"),t=$(".stream_reactions [data-type='"+e.icon+"']").offset().left+$(".stream_reactions [data-type='"+e.icon+"']").width()/2-n.width()/2,n.css({left:t})):(t=$(".stream_reactions [data-type='"+e.icon+"']").offset().left+$(".stream_reactions [data-type='"+e.icon+"']").width()/2-n.width()/2,n.css({left:t}));else{let e=$(window).width()/2;t=e+randInt(-e/2,e/2),n.css({left:t})}setTimeout((function(){n.remove()}),1200)}}function refreshModule(e){null!=AppData[e.appdata]&&(AppData[e.appdata]=e.use_lang?e.data[localState.lang]:e.data);for(let t in e.module)null!=window[e.module[t]]&&"function"==typeof window[e.module[t]][e.callback[t]]&&window[e.module[t]][e.callback[t]].apply(null,e.callback_params?[e.callback_params[t]]:null)}function updateModifiedContent(e){let t=!1,a=e.module.charAt(0).toUpperCase()+e.module.slice(1);!0!==e.only_callback?null!=AppData[e.module]&&($.each(AppData[e.module],(function(a,n){n[e.id_field]==e.id_value&&(AppData[e.module][a]=e.updated_content,t=!0)})),t&&null!=e.callback&&"function"==typeof window[a][e.callback]&&window[a][e.callback].apply(null,[e.callback_params]||null)):"function"==typeof window[a][e.callback]&&window[a][e.callback].apply(null,[e.callback_params]||null)}function lazyImages(){var e=$("img[data-src]:visible:lt(1)");e.length&&(e.attr({src:function(){return $(this).attr("data-src")},"data-src":null}),e=null,requestAnimationFrame(lazyImages))}function lazyImagesBg(){var e=$("[data-lazyloadbg]");e.length&&(e.attr({style:function(){return'background-image: url("'+$(this).attr("data-lazyloadbg")+'");'},"data-lazyloadbg":null}),e=null,requestAnimationFrame(lazyImagesBg))}function nl2br(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/(\r\n|\n\r|\r|\n)/g,"<br>$1")}function nl2brStrict(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/(\r\n|\n\r|\r|\n)/g,"<br>$1")}function nl2brOnly(e){return String(e).replace(/(\r\n|\n\r|\r|\n)/g,"<br>$1")}function makeTimeFormat(e,t){return""!=e&&"12"===t?(parseInt(e)>=13?"0"+(parseInt(e)-12)+e.substr(e.indexOf(":")):e)+(parseInt(e)>=12?"PM":"AM"):e}function logOut(){Modal.confirm(Language.getItem("logout-text"),(function(){writeDbLog("logout","","user_logs","logout"),$.post("api/",{do:"logOut"},(function(){void 0!==window.webkit&&window.webkit.messageHandlers.logOut.postMessage("logout"),"undefined"!=typeof Android&&null!==Android&&Android.logout()})),void 0!==window.webkit&&window.webkit.messageHandlers.logOut.postMessage("logout"),"undefined"!=typeof Android&&Android.logout()}))}function forceLogOut(){writeDbLog("force logout","","user_logs","logout"),$.post("api/",{do:"logOut"},(function(){void 0!==window.webkit&&window.webkit.messageHandlers.logOut.postMessage("logout"),"undefined"!=typeof Android&&null!==Android&&Android.logout()})),void 0!==window.webkit&&window.webkit.messageHandlers.logOut.postMessage("logout"),"undefined"!=typeof Android&&Android.logout()}function setHomeScreenVideo(){var e=videojs("my-video-bg");if(AppData.settings.showHomeScreenVideo){if("homescreenVideo"in AppData.settings){let t=AppData.medias.find((function(e){return e.id===AppData.settings.homescreenVideo}));t&&null!=t.files[localState.lang].file&&(e.paused||e.pause(),e.src(t.files[localState.lang].file),e.load(),e.play(),$("#playerElementBackground").show())}}else e.paused(!0),$("#playerElementBackground").hide()}$(document).on("click",".stream_reactions .reaction_emoji",(function(e){let t=$(this).attr("data-type");writeDbLog(t,localState.currentChannel,"user_logs"),Socket.Send("sendStreamReaction",{icon:t,own:!1},{channel:localState.currentChannel}),sendStreamReaction({icon:t,own:!0})})),$(document).on("click",".logout",logOut);
var Modulsettings=function(){"use strict";function t(){$.post("api/",{do:"getModulSettings"},(function(t){AppData.modulsettings=t,Docs.renderList(),Profile.Init(),$("#landing").find(".open-main.broadcast").toggleClass("blinkingicon",AppData.modulsettings.showredalert),$("#landing").find("#default_nav .open-main.broadcast").toggleClass("color-primary",!AppData.modulsettings.showredalert),AppData.modulsettings.showredalert?$("#landing").find(".open-main.broadcast").css("color",AppData.settings.colorPrimary):$("#landing").find(".open-main.broadcast").css("color",""),Agenda.Build(),Agenda.showFavorite("sub"),Agenda.showFavorite(),Agenda.toggleRequestSpeakerGotoLink(),Agenda.toggleItemArrows(),Speakers.toggleRequestBusinessCard(),Speakers.toggleRequestSpeakerGotoLink(),Speakers.toggleSocial(),Speakers.renderList(),Speakers.renderDetails(),Attendees.toggleRequestBusinessCard(),Attendees.toggleSocial(),Attendees.renderList(),Gallery.renderDetails(),Photos.renderList(),Broadcast.setRunawayDatas(),Broadcast.setBroadcastPoster(),Broadcast.BuildBroadcast(),Broadcast.showReactions(),Broadcast.showTranslator(),Broadcast.showChatButton(),Broadcast.showTexttracks(),Trueconf.showTranslator(),Translator.toggleRelayBtns(),Messageboard.showMsgBoard(),AppData.modulsettings.attentionchecker?Broadcast.enableAttentionGuard():Broadcast.disableAttentionGuard(),Issues.Build(),AppData.modulsettings.showvideochat?$("#chat-details .video-chat").show():$("#chat-details .video-chat").hide(),Chat.refresh();let o=$("div.main");o.find(".header-primary .data-title").text(AppData.modulsettings.title[localState.lang]),o.find(".header-primary .data-subtitle").text(AppData.modulsettings.subTitle[localState.lang]),"text"==AppData.settings.foregroundtype&&o.filter("#landing").find(".hero").html(AppData.modulsettings.fgtext[localState.lang]),Issues.maxCharacterCount(),Bookings.BuildFromSourceClient(),a(),t=null}))}function a(){if(0==AppData.modulsettings.cdown_showonclient&&0==AppData.modulsettings.bc_landingbutton?$("#landing .countdown_bc").hide():$("#landing .countdown_bc").show(),showCountDown(AppData.modulsettings.cdown_showonclient,AppData.modulsettings.cdown_clientpos),AppData.modulsettings.bc_landingbutton?$("#landing .countdown_bc .bc_button").show():$("#landing .countdown_bc .bc_button").hide(),"translator"==AppData.profile.group&&AppData.modulsettings.translator_disallow_mic?$("#landing #trueconf_iframe").attr("allow","microphone 'none'; camera; autoplay; display-capture"):$("#landing #trueconf_iframe").attr("allow","microphone; camera; autoplay; display-capture"),["top","bottom","left"].indexOf(AppData.modulsettings.emoji_pos)>-1?$(".stream_reactions").removeClass("top bottom left").addClass(AppData.modulsettings.emoji_pos):$(".stream_reactions").removeClass("top bottom left").addClass("bottom"),AppData.modulsettings.show_quickmenu&&($("#minimal_nav").appendTo($(".bodycontent")),localState.layout.length>0&&$("#minimal_nav").addClass("topAnimationDown"),Navigation.setMinimalisticMenu()),$("nav#minimal_nav").toggle(AppData.modulsettings.show_quickmenu),AppData.modulsettings.show_quickmenu?$("#docs-details embed").addClass("w_quickmenu"):$("#docs-details embed").removeClass("w_quickmenu"),"landingbutton_bgcolor"in AppData.modulsettings&&"landingbutton_textcolor"in AppData.modulsettings){var t=".landingbutton { color: "+AppData.modulsettings.landingbutton_textcolor+" !important; background-color: "+AppData.modulsettings.landingbutton_bgcolor+" !important;}";t+=".play-btn-cont { color: "+AppData.modulsettings.landingbutton_bgcolor+" !important;}",$("head").append("<style>"+t+"</style>")}}return{Init:function(){return t(),!0},BuildFromSource:t,Update:a}}();
var Settings=function(){"use strict";function e(){if(null==AppData.profile&&-1==location.href.indexOf("login"))return location.href=location.href.replace("/client.html","/login.html"),!1;var e=AppData.settings||[],a="",t=$("div.main");if("bgImage"in e){let a=AppData.medias.find((function(a){return a.id==e.bgImage}));a&&null!=a.files[localState.lang]&&t.filter("#landing").find("header").css("backgroundImage",'url("'+a.files[localState.lang].file+'")')}if(t.filter("#landing").find(".hero").hide(),"image"==AppData.settings.foregroundtype&&"fgImage"in e){let a=AppData.medias.find((function(a){return a.id==e.fgImage}));a&&null!=a.files[localState.lang].file&&t.filter("#landing").find(".hero").html("").css("backgroundImage",'url("'+a.files[localState.lang].file+'")').show()}if("text"==AppData.settings.foregroundtype&&AppData.modulsettings.fgtext&&t.filter("#landing").find(".hero").css("backgroundImage","none").html(AppData.modulsettings.fgtext[localState.lang]).show(),"logo"in e){let a=AppData.medias.find((function(a){return a.id==e.logo}));a&&null!=a.files[localState.lang]&&(t.filter("#landing").find("header .logo").attr("src",a.files[localState.lang].file),t.find(".header-primary .logo").attr("src",a.files[localState.lang].file),$("#unity3d-details .loader .loader_logo").attr("src",a.files[localState.lang].file))}if(function(e){var a=e||"landing";-1===$.inArray("profile",localState.layout)&&$("div.main").not("#landing").hide();$.each(localState.layout,(function(e,a){Layout.show(a,!0)})),$("div#landing").show(),$("div.main header .close-main").show(),$("div.main header .hamburger").parent().show(),$("div.main header .header-primary").removeClass("disable-pe"),"function"==typeof Surveys.Init&&Surveys.Init();if(a.indexOf("#")>-1){var t=a.split("#"),n=t[0];n=n.charAt(0).toUpperCase()+n.slice(1),window[n].showDetails(t[1],!1),a=t[0]+"-details"}"landing"!=a&&($("div#"+a).show(),AppData.settings.allow_home_navigation?($("div#"+a+" header .close-main").show(),$("div#"+a+" header .hamburger").parent().show(),$("div#"+a+" header .header-primary").removeClass("disable-pe")):($("div#"+a+" header .close-main").hide(),$("div.main header .hamburger").parent().hide(),$("div#landing header .hamburger").parent().show(),$("div.main header .header-primary").addClass("disable-pe"),$("div#landing header .header-primary").removeClass("disable-pe")));if(!1===AppData.profile.game&&""!=AppData.settings.start_survey&&null!=AppData.settings.start_survey){AppData.surveysdata.find((function(e){return e.survey==AppData.settings.start_survey}))||Surveys.showDetails(AppData.settings.start_survey)}""!=AppData.settings.start_survey&&null!=AppData.settings.start_survey||Layout.hide("surveys-details")}(e.startPage),"game"===e.startPage?$(".open-main.hamburger").hide():$(".open-main.hamburger").show(),"logoPosition"in e&&(t.filter("#landing header").find(" .container").not(".navplusbutton").css("justify-content",e.logoPosition),t.filter("#landing").find("header .container .navplusbutton").css("justify-content","flex-end")),"user"in e&&(e.user=AppData.profile.givenname[localState.lang]||e.user,t.filter("#welcome").find("article .data-user").html(e.user),t.filter("#hamburger").find(".data-user").html(e.user)),t.filter("#hamburger").find(".data-img").attr("src",AppData.profile.img?"upload/users/"+AppData.profile.img+"?r="+Math.random():"img/profile-picture-placeholder.png"),"userInfo"in e&&("ip"===e.userInfo?t.find(".header-primary .data-user").html(AppData.server.client_addr||"NOIP"):t.find(".header-primary .data-user").html(e.user)),"showLogout"in e&&t.find(".logout").toggleClass("hidden","false"===String(e.showLogout)),"showHome"in e&&t.find(".home").toggleClass("hidden","false"===String(e.showHome)),AppData.profile&&$("div#game").find("header .data-subtitle").html(AppData.profile.name[localState.lang]||"Unknown"),"showVersion"in e&&($("#software").toggle("true"===String(e.showVersion)),"true"===String(e.showVersion)?"floating"==AppData.settings.homeScreen&&$("#default_nav").addClass("elevated"):"floating"==AppData.settings.homeScreen&&$("#default_nav").removeClass("elevated")),"textDirection"in e&&$(document.documentElement).attr("dir",e.textDirection),"headerReverse"in e&&(t.find(".header-primary").toggleClass("reverse","true"===String(e.headerReverse)),$("div#hamburger").toggleClass("reverse","true"===String(e.headerReverse))),"changeLang"in e&&t.find(".changeLang").closest("fieldset").toggleClass("hidden","false"===String(e.changeLang)),"colorPrimary"in e&&(a+=".color-primary { color: "+e.colorPrimary+" !important; }",a+=".bg-primary { background-color: "+e.colorPrimary+" !important; }",a+=".border-primary { border-color: "+e.colorPrimary+" !important; }",a+="@keyframes blinkingiconanimation3 {50% {color: #ffffff; background-color: "+e.colorPrimary+"}}",t.find(".header-secondary").css("backgroundColor",e.colorPrimary)),"colorSecondary"in e&&(a+=".color-accent { color: "+e.colorSecondary+" !important; }",a+=".bg-accent { background-color: "+e.colorSecondary+" !important; }",a+=".border-accent { border-color: "+e.colorSecondary+" !important; }"),"colorIconBackground"in e&&(a+=".color-primary { background-color: "+e.colorIconBackground+" !important; }"),"colorIconText"in e&&(a+=".color-icon-text { color: "+e.colorIconText+" !important; }"),"iconTextShadow"in e)if(e.iconTextShadow){let t="#000";null!=e.colorIconTextShadow&&(t=e.colorIconTextShadow),a+="#default_nav .wrapper .data-title { text-shadow: 1px 1px 3px"+t+" !important; }"}else a+="#default_nav .wrapper .data-title { text-shadow: none !important; }";switch("bubble"in e&&("hidden"==e.bubble?(t.find("#showBubble1").hide(),t.find("#showBubble2").hide()):(t.find("#showBubble1").show(),t.find("#showBubble2").show(),"reverse"==e.bubble?(t.find("#showBubble1").addClass("reverse"),t.find("#showBubble2").addClass("reverse")):(t.find("#showBubble1").removeClass("reverse"),t.find("#showBubble2").removeClass("reverse")))),t.find(".header-primary .data-title").text(AppData.modulsettings.title[localState.lang]),t.find(".header-primary .data-subtitle").text(AppData.modulsettings.subTitle[localState.lang]),a.length&&$("head").append("<style>"+a+"</style>"),AppData.settings.homeScreen){case"classic":$("nav#default_nav").removeClass("floating panel"),$("nav#default_nav .wrapper").removeClass("animated fadeIn fadeOut").show(),$(".navplusbutton").addClass("hidden"),$("nav#default_nav .closemenu").addClass("hidden"),$("article").removeClass("articlebgvideo"),$("article .container").removeClass("containerbgvideo"),$("#default_nav").css("background-color",AppData.settings.colorMenuBackground),$("div.main").not("#hamburger").not("#modal").css("background-color","");break;case"floating":$("nav#default_nav").addClass("floating"),AppData.settings.menupanel?$("nav#default_nav").addClass("panel").removeClass("not-panel"):$("nav#default_nav").addClass("not-panel").removeClass("panel"),$("#landing .wrapper").not(".navplusbutton").hide(),$(".navplusbutton").removeClass("hidden"),$("nav#default_nav .closemenu").removeClass("hidden"),$("#default_nav").removeClass("opened blur"),$("article").addClass("articlebgvideo"),$("article .container").addClass("containerbgvideo"),$("#default_nav").css("background-color",""),$("div.main").not("#hamburger").not("#modal").not(".system").css("background-color","transparent"),$("div#landing .landing_elements").find(".trueconf").css("z-index","1000"),$("#default_nav").appendTo($(".bodycontent"))}$("nav#default_nav").show();var n=hexToRgb(AppData.settings.colorMenuBackground);let r=AppData.settings.menuOpacity||50;$("#navplus i").hasClass("fa-minus")&&$("#navplus").find(".container").css("background-color","rgba("+n.r+","+n.g+","+n.b+", "+r/100+")"),$("#landing .landing_elements .moderate_cont").is(":visible")&&$("#navplus").find("[data-target='moderate']").css("border","2px solid "+AppData.settings.colorIconBorder),$("#landing .landing_elements .stage_cont").is(":visible")&&$("#navplus").find("[data-target='stage']").css("border","2px solid "+AppData.settings.colorIconBorder);let o=hexToRgb("#FFFFFF");"colorHeaderBackground"in e&&(o=hexToRgb(AppData.settings.colorHeaderBackground));let i=1;return"headerOpacity"in e&&(i=AppData.settings.headerOpacity/100),$("div.main > header > section").css("background-color","rgba("+o.r+","+o.g+","+o.b+", "+i+")"),0==i?$("div.main > header").css("background-position-y",$("div.main > header > section").height()+"px"):$("div.main > header").css("background-position-y",""),"colorHeaderText"in e&&$("div.main > header > .header-primary").css("color",AppData.settings.colorHeaderText),AppData.settings.showShare||"admin"==AppData.profile.group?$(".sharebutton, .share_video").removeClass("hidden"):$(".sharebutton, .share_video").addClass("hidden"),AppData.settings.showMuteVideo?$(".mute-video-button").removeClass("hidden"):$(".mute-video-button").addClass("hidden"),Namecards.Init(),!0}return{Init:e,BuildFromSource:function(){$.post("api/",{do:"getSettings"},(function(a){AppData.settings=a,document.title=AppData.modulsettings.browsertitle[localState.lang],setFavicon(),AppData.settings.blink_menu_icon?$(".navplusbutton").children().addClass("blink_button").removeClass("color-primary"):$(".navplusbutton").children().removeClass("blink_button").addClass("color-primary"),e();var t=videojs("my-video-bg");AppData.settings.showHomeScreenVideo?setHomeScreenVideo(t):(t.paused(!0),$("#playerElementBackground").hide()),setHomeScreenVideo(),a=null,Layout.BuildFromSource()}))}}}();
var navplus_opened=!1,Navigation=function(){"use strict";var n,a,t,e,i,o;let s=!1;function l(){$("nav#minimal_nav > .container").html(""),$("nav#default_nav > .container").html(""),$("div#landing > header > .landing_elements > #navplus > .container").html(""),$("div#hamburger > nav > .navList").html(""),AppData.navigation.sort((function(n,a){return void 0!==n.sort_id&&void 0!==a.sort_id?parseInt(n.sort_id)>parseInt(a.sort_id)?1:-1:0})),o=AppData.navigation.filter((function(n){return n.group&&n.group.indexOf(AppData.profile.group)>-1})),void 0===AppData.navigation.find((function(n){return"profile"===n.module&&n.visible&&n.group&&n.group.indexOf(AppData.profile.group)>-1}))?$("#hamburger .profile").hide():$("#hamburger .profile").show(),$.each(AppData.navigation||[],(function(s,l){var d,r,u=n.clone(),p=n.clone(),c=a.clone();$.each([u,c,p],(function(n,a){if(a.find(".open-main").attr("data-target",l.module),a.find(".open-main").attr("data-id",l.id),l.only_premium&&(AppData.profile.is_premium?a.find(".open-main").removeClass("premium_content"):a.find(".open-main").addClass("premium_content")),""!=l.extra_class&&null!=l.extra_class&&a.find(".open-main").addClass(l.extra_class||"").removeClass("color-primary"),"broadcast"===l.module&&(a.find(".open-main").addClass("broadcast"),AppData.modulsettings.showredalert&&(a.find(".open-main").removeClass("color-primary").addClass("blinkingicon"),a.find(".open-main").css("color",AppData.settings.colorPrimary))),"soundchannels"===l.module&&a.find(".open-main").addClass("soundchannels"),l.target&&a.find(".open-main").attr("data-targetid",l.target),a.find(".open-main").removeClass("only_image"),l.image&&(l.image_on_normal||l.image_on_quick)){let n=AppData.medias.find((function(n){return n.id==l.image}));n&&(a.find(".data-img").attr("src",n.files[localState.lang].file),a.find(".open-main").addClass("only_image"))}if(a.toggleClass("img_normal",1==l.image_on_normal),a.toggleClass("img_quick",1==l.image_on_quick),void 0===l.icon||""===l.icon){var t=AppData.modules.filter((function(n){return n.id===l.module}));t.length>0&&(a.find(".data-icon").addClass(t[0].icon),a.find(".open-main").attr("data-icon",t[0].icon),c.attr("data-icon",t[0].icon))}else a.find(".data-icon").addClass(l.icon),a.find(".open-main").attr("data-icon",l.icon),c.attr("data-icon",l.icon);a.find(".data-title").text(l.name[localState.lang]),d=AppData.profile.menus.filter((function(n){return n.id===l.id})),r=o.filter((function(n){return n.id===l.id})),a.toggleClass("hidden",!("true"===String(l.visible)&&(d.length>0?"1"===d[0].show:r.length>0))),l.icon_blink_icon&&a.find(".open-main").attr("style","background-color: "+l.icon_blink_icon),a.find(".open-main").hasClass("blink_icon")||a.find(".open-main").attr("style","background-color: none")})),c.attr("data-target",l.module),c.attr("data-id",l.id),c.attr("data-targetid",l.target),l.only_in_minimalistic_menu||u.appendTo(t),l.show_in_minimalistic_menu&&p.appendTo(e),c.appendTo(i),u=c=null})),i.appendTo("div#hamburger > nav > .navList"),$(".navplusbutton").remove(),$("#default_nav .closemenu").remove();var s=n.clone();s.find(".data-icon").addClass("fas fa-plus"),s.find(".data-title").html(Language.getItem("menu")),s.find(".data-title").removeClass("color-icon-text").addClass("color-primary"),s.addClass("navplusbutton"),s.appendTo($(".bodycontent"));var l=n.clone();l.find(".data-icon").addClass("fas fa-plus"),l.addClass("closemenu"),l.appendTo(t),"classic"===AppData.settings.homeScreen&&(s.addClass("hidden"),l.addClass("hidden")),e.appendTo("nav#minimal_nav > .container"),t.appendTo("nav#default_nav > .container"),$("nav#minimal_nav > .container .wrapper").find(".data-title").remove(),$("div#landing nav").show(),"floating"!==AppData.settings.homeScreen||$("#default_nav").hasClass("opened")||$("nav#default_nav .wrapper").not(".navplusbutton").hide(),"floating"==AppData.settings.homeScreen&&1==AppData.settings.show_menu_on_load&&d(),AppData.settings.blink_menu_icon?$(".navplusbutton").children().addClass("blink_button").removeClass("color-primary"):$(".navplusbutton").children().removeClass("blink_button").addClass("color-primary"),u(),$("nav#minimal_nav > .container .wrapper").find(".open-main").removeClass("color-primary"),$("nav#minimal_nav").toggle(AppData.modulsettings.show_quickmenu),$("nav#default_nav").show()}function d(){if("floating"==AppData.settings.homeScreen){$("#default_nav .wrapper").fadeIn(400),$("#default_nav").addClass("opened");var n=hexToRgb(AppData.settings.colorMenuBackground);let a=AppData.settings.menuOpacity||50;null!=n&&$("#default_nav").addClass("blur").css("background-color","rgba("+n.r+","+n.g+","+n.b+", "+a/100+")")}}function r(){"floating"==AppData.settings.homeScreen&&s&&($("#default_nav").addClass("closing"),$("#default_nav .wrapper").fadeOut(400,(function(){$("#default_nav").removeClass("opened closing"),$(".navplusbutton").fadeIn(400),$("#default_nav").css("background-color","").removeClass("blur")})))}function u(){p()}function p(){let n=$("article").not(".info"),a=$(window).width(),t=$(window).width()-45;if(AppData.modulsettings.show_quickmenu){let e=$("#minimal_nav").find(".container"),i="quickmenu_pos"in AppData.modulsettings&&""!==AppData.modulsettings.quickmenu_pos?AppData.modulsettings.quickmenu_pos:"top";if(e.removeClass("top left right").addClass(i),c(),a<780)switch(i){case"left":n.css("width",t+"px").css("left","45px").css("top","0").css("right","0");break;case"right":n.css("width",t+"px").css("left","0").css("top","0").css("right","45px");break;case"top":n.css("width",a+"px").css("left","0").css("top","45px").css("right","0")}else n.css("width","");c()}else n.css("width","").css("left","0").css("top","0").css("right","0")}function c(){let n=hexToRgb("quickmenu_bg_color"in AppData.modulsettings&&""!==AppData.modulsettings.quickmenu_bg_color?AppData.modulsettings.quickmenu_bg_color:"#000000"),a="quickmenu_transparency"in AppData.modulsettings&&""!==AppData.modulsettings.quickmenu_transparency?AppData.modulsettings.quickmenu_transparency/100:"100";$("#minimal_nav").find(".container").css("color",AppData.modulsettings.quickmenu_icon_color).css("background-color","rgba("+n.r+","+n.g+","+n.b+", "+a+")")}return $(document).on("mouseup touchend",".navplusbutton .open-main, #default_nav .closemenu",(function(n){s=!0,$("#default_nav").hasClass("opened")?(r(),AppData.settings.blink_menu_icon?$(".navplusbutton").children().delay(500).queue((function(){$(".navplusbutton").children().clearQueue().removeClass("color-primary").addClass("blink_button")})):$(".navplusbutton").children().removeClass("blink_button").addClass("color-primary")):($(".navplusbutton").children().removeClass("blink_button").addClass("color-primary"),d())})),$(document).on("mouseup touchend",".mute-video-button",(function(n){n.preventDefault();var a=videojs("my-video-bg");$(".mute-video-button i").hasClass("fa-volume-mute")?(a.muted(!1),$(".mute-video-button i").removeClass("fa-volume-mute").addClass("fa-volume-up")):(a.muted(!0),$(".mute-video-button i").removeClass("fa-volume-up").addClass("fa-volume-mute"))})),$(window).resize((function(){p()})),{Init:function(){n=$("template#navItem").contents(),a=$("template#tplMenuItem").contents(),t=$(document.createDocumentFragment()),e=$(document.createDocumentFragment()),i=$(document.createDocumentFragment()),l(),AppData.modulsettings.show_quickmenu&&p()},BuildFromSource:function(){$.post("api/",{do:"getNavigation"},(function(n){AppData.navigation=n.nav,AppData.profile.menus=n.user_menus,$.each(AppData.navigation||[],(function(n,a){"visible"in a&&Layout._eachInitNavigation(n,a)})),l(),n=null}))},showMenu:d,hideMenu:r,setAllowCloseMenu:function(){s=!0},setMinimalisticMenu:u,setQuickMenuColors:c}}();
var Layout=function(){"use strict";var e,t,a,n,i,o=!1,s={},l=!1;function r(e,n){var i=t.clone(),o=a.clone();0===$("#"+n.id+" header").length&&(AppData.modules.find((function(e){return e.id===n.id}))&&0===$("#"+n.id+" header").length&&(i.find(".data-back").text("Data-back"),i.prependTo("#"+n.id),o.appendTo("#"+n.id),i=o=null));"floating"==AppData.settings.homeScreen&&$("#"+n.id+" article .container").wrap('<div class="outer"/>');let s=$("<div/>").addClass("buttoncont");if($("#"+n.id+" article .outer").append(s),0===$("#"+n.id+" article .outer .buttoncont .closebutton").length){let e=$("<div/>").addClass("closebutton color-primary");e.append('<i class="fas fa-times"></i>'),s.append(e)}if(0===$("#"+n.id+" article .outer .buttoncont .backbutton").length){let e=$("<div/>").addClass("backbutton color-primary close-main");e.append('<i class="fas fa-chevron-left"></i>'),s.append(e)}if(0===$("#"+n.id+" article .outer .buttoncont .sharebutton").length){let e=$("<div/>").addClass("sharebutton color-primary hidden");e.append('<i class="fas fa-share"></i>'),s.append(e)}}function d(e,t){if(1==t.visible&&1===$("#"+t.module+" header").length){var a;if(null!=t.icon&&""!=t.icon)a=t.icon;else a=AppData.modules.find((function(e){return e.id===t.module})).icon;var n=t.module;""!=t.target&&null!=t.target&&(n+="-details"),localState.layoutActiveMenu===t.id&&($("#"+n+" header").find("h3 .data-icon").removeClass().addClass("data-icon "+a),$("#"+n+" header").find("h3 .data-label").html(t.name[localState.lang]))}}function c(e,n){var i=t.clone(),o=a.clone(),s=$("#"+n.id.replace("-details",""));0===$("#"+n.id+"-details header").length&&(i.find(".data-icon").addClass(s.find("header .data-icon").attr("class")),i.prependTo("#"+n.id),o.appendTo("#"+n.id),i=null),"floating"==AppData.settings.homeScreen&&$("#"+n.id+" article .container").wrap('<div class="outer"/>');let l=$("<div/>").addClass("buttoncont");if($("#"+n.id+" article .outer").append(l),0===$("#"+n.id+" article .outer .buttoncont .closebutton").length){let e=$("<div/>").addClass("closebutton color-primary");e.append('<i class="fas fa-times"></i>'),l.append(e)}if(0===$("#"+n.id+" article .outer .buttoncont .backbutton").length){let e=$("<div/>").addClass("backbutton color-primary close-main");e.append('<i class="fas fa-chevron-left"></i>'),l.append(e)}if(0===$("#"+n.id+" article .outer .buttoncont .sharebutton").length){let e=$("<div/>").addClass("sharebutton color-primary hidden");e.append('<i class="fas fa-share"></i>'),l.append(e)}}function u(){var e=$(this).closest("div.main").find("article");e.animate({scrollTop:0},300,"linear"),e=null}function p(){s.self=this,s.scrollX=s.self.scrollTop,s.height=s.self.offsetHeight,l||(l=!0,requestAnimationFrame(m))}function m(){l=!1,s.scrollX>2*s.height/3?($(s.self).find(".container").css("marginBottom","45pt"),$(s.self).next(".scroll-top-wrapper").removeClass("hidden fadeOutDown").addClass("fadeInUp")):($(s.self).find(".container").css("marginBottom",""),$(s.self).next(".scroll-top-wrapper").removeClass("fadeInUp").addClass("hidden fadeOutDown"))}function f(t,a){a=a||!1;var n=$("#"+t).not("#landing, #game"),i=n.hasClass("system"),o=e.clone();"gdpr"!=t&&Navigation.setAllowCloseMenu();let s=AppData.navigation.find((function(e){return e.id==localState.layoutActiveMenu})),l=!1;if(s&&s.open_in_main&&(a=!0,l=!0),"camerastream"==t)return void Camerastream.startStream();if("chat"==t&&!AppData.profile.pubProfile)return void Modal.alert(Language.getItem("enable-profile"));if("speaker-presentation"==t)return void(localState.presentation&&($(".speaker_presentation").is(":visible")?(SpeakerPresentation.hide(),$("#default_nav").find("[data-target='speaker-presentation']").css("border","")):(SpeakerPresentation.show(),$(".speaker_presentation").is(":visible")&&$("#default_nav").find("[data-target='speaker-presentation']").css("border","2px solid "+AppData.settings.colorIconBorder))));var r,d;("booked-agenda"===t&&$.post("api/",{do:"addScoresToUser",type:"favourites-menu",score:"50"},(function(){})),Layout.hide("hamburger"),"activeElement"in document&&document.activeElement.blur(),n.length&&!n.is(":visible"))&&(l||(localState.layout=localState.layout.filter((function(e){return e!==t})),localState.layout.push(t)),$(".bubbles1, .bubbles2").hide(),n.hasClass("reverse")?(r="fadeOut"+("classic"===AppData.settings.homeScreen?"Left":""),d="fadeIn"+("classic"===AppData.settings.homeScreen?"Left":"")):(r="fadeOut"+("classic"===AppData.settings.homeScreen?"Right":""),d="fadeIn"+("classic"===AppData.settings.homeScreen?"Right":"")),a?(l||n.appendTo(".bodycontent"),n.show().css("display","flex")):(n.show().css("display","flex").removeClass(r+" fadeOut").addClass(i?"animated faster fadeIn":"animated faster "+d),l||n.appendTo(".bodycontent")),i||"classic"!==AppData.settings.homeScreen&&"hamburger"!=t||l||o.show().addClass("animated faster fadeIn").insertBefore(n),""!=t&&AppData.settings.homeScreen,localState.layout.length>1&&"hamburger"!=t&&setTimeout((function(){"floating"===AppData.settings.homeScreen&&$("#"+localState.layout[localState.layout.length-2]).hide()}),300),localState.layout.length>0&&"hamburger"!=t&&"classic"==AppData.settings.homeScreen&&!l&&Broadcast.minifyPlayer(),localState.layout.length>1&&!l&&"classic"!==AppData.settings.homeScreen?$(".backbutton").show():$(".backbutton").hide());let c=t.charAt(0).toUpperCase()+t.slice(1);null!=window[c]&&"function"==typeof window[c].shown&&window[c].shown(),localState.layout.length>0&&AppData.modulsettings.cdown_showonclient&&$("#landing .countdown_bc").addClass("hidden"),localState.layout.length>0&&$(".videostream").appendTo($(".videostream").parent()),AppData.modulsettings.show_quickmenu&&"hamburger"!==t&&($("#minimal_nav").removeClass("topAnimationUp").addClass("topAnimationDown"),localState.layout.length>0&&$(window).width()),AppData.modulsettings.show_quickmenu&&"hamburger"===t&&$("#minimal_nav").css("z-index",""),n=i=o=null}function h(e,t){t=t||!1;var a=$("#"+e).not("#landing, #game"),n=a.hasClass("system"),i=a.prev("div.main.backdrop"),o=a.find(".scroll-top-wrapper");if("camerastream"!=e){if("activeElement"in document&&document.activeElement.blur(),a.length&&a.is(":visible")){var s,l;if(localState.layout=localState.layout.filter((function(t){return t!==e})),o.removeClass("fadeInUp").addClass("hidden"),a.trigger("hide"),t)"classic"!==AppData.settings.homeScreen&&"hamburger"!=e||i.remove(),a.hide(),a=n=i=o=null;else a.hasClass("reverse")?(s="fadeOutLeft",l="fadeInLeft"):(s="fadeOutRight",l="fadeInRight"),"floating"===AppData.settings.homeScreen&&(s="fadeOut",l="fadeIn"),a.on("animationend animationcancel",(function(t){var l=t.target||t.originalEvent.target;l===this&&(a.off("animationend animationcancel").removeClass("animated faster fadeOut "+s).hide(),"classic"!==AppData.settings.homeScreen&&"hamburger"!=e||i.remove(),1===$("div.main:visible").length&&(AppData.modulsettings.show_quickmenu&&$("#minimal_nav").removeClass("topAnimationDown").addClass("topAnimationUp"),"hidden"==AppData.settings.bubble?$(".bubbles1, .bubbles2").hide():$(".bubbles1, .bubbles2").show()),a=n=i=o=null),l=null})).removeClass("faster fadeIn "+l).addClass(n?"animated faster fadeOut":"animated faster "+s),n||"classic"!==AppData.settings.homeScreen&&"hamburger"!=e||i.removeClass("fadeIn").addClass("animated faster fadeOut");0===localState.layout.length&&"floating"==AppData.settings.homeScreen&&$("#default_nav").show(),0===localState.layout.length&&AppData.modulsettings.show_quickmenu&&$(window).width()<780&&Navigation.setQuickMenuColors()}if(Navigation.hideMenu(),localState.layout.length>1?$(".backbutton").show():$(".backbutton").hide(),0===localState.layout.length){let e=$("#landing header .landing_elements .main");e.length>0?$(".videostream").insertBefore(e.first()):0==$("#landing header .landing_elements").has($(".videostream")).length&&$(".videostream").appendTo($("#landing header .landing_elements")),AppData.modulsettings.cdown_showonclient&&$("#landing .countdown_bc").removeClass("hidden"),Broadcast.restorePlayer(),Trueconf.showTranslator()}A(),AppData.modulsettings.show_quickmenu&&0===localState.layout.length&&$("#minimal_nav").removeClass("topAnimationDown").addClass("topAnimationUp"),AppData.modulsettings.show_quickmenu&&"hamburger"===e&&$("#minimal_nav").css("z-index","2")}else Camerastream.stopStream()}function g(){localState.layout=[],$(".bodycontent > div.main:visible").not(".backdrop").each(v)}function v(e,t){h(t.id)}function b(){let e=$(this).data("target"),t=$(this).data("id"),a=$(this).data("targetid"),n=$(this).data("icon");if("true"==$(this).attr("data-notnav")){let i=AppData.navigation.find((function(t){return t.module==e}));i&&(t=i.id,a=i.target,n=i.icon)}let i,o,s=AppData.navigation.find((function(e){return e.id==t}));if(writeDbLog(e,void 0!==s?s.name[localState.lang]:"","user_logs","menuopen"),localState.layoutActiveMenu=t,a){if(void 0!==s){if($("#"+e+"-details header").find("h3 .data-icon").removeAttr("class").addClass("data-icon "+n),o=$("#"+e+"-details"),w(s,o,e+"-details"))return void console.log("finished?")}i=e.charAt(0).toUpperCase()+e.slice(1),window[i].showDetails(a),"function"==typeof window[i].showList&&window[i].showList(a),s.open_in_main||Navigation.hideMenu()}else if(void 0!==e){e=e.toLowerCase();let t=$("#"+e+" header");if(void 0!==s){if(t.find("h3 .data-icon").removeAttr("class").addClass("data-icon "+n),t.find("h3 .data-label").html(s.name[localState.lang]),o=$("#"+e),w(s,o,e))return void console.log("no target finished?")}i=e.charAt(0).toUpperCase()+e.slice(1),null!=window[i]&&"function"==typeof window[i].showList&&window[i].showList(""),Layout.show(e)}for(let e in clientEventListeners)"open"==clientEventListeners[e].type&&$(document).trigger(clientEventListeners[e].event_name);A()}function w(e,t,a){if(e.open_in_main){if(t.appendTo($(".landing_elements")),t.attr("data-width",e.width_in_main),0==$(".closemainbutton",t).length){let n=$("<div/>").addClass("closemainbutton color-primary open-main").attr("data-target",a).attr("data-id",e.id).attr("data-notnav","true");n.append('<i class="fas fa-times-circle"></i>'),t.append(n)}if(null!=e.width_in_main&&e.width_in_main>0){let n=e.width_in_main,i=0,o=$("#landing .landing_elements > div").not(".hero, .main, .countdown_bc").is(":visible"),s=$("#landing .landing_elements > div.main").not("#"+a).is(":visible");o||s||(n=100,i=1),t.css({flex:"0 "+i+" "+n+"%"})}$("header",t).hide()}else t.appendTo($(".bodycontent")),$("header",t).show();"hamburger"!=a&&Layout.hide("hamburger");let n=!1;return t.is(":visible")&&($(".closemainbutton",t).remove(),Layout.hide(a),$("header",t).show(),n=!0),n}function A(){let e=!0;$.each($("#landing .landing_elements > div.main"),(function(){let t=$(this).attr("data-width"),a=0,n=$("#landing .landing_elements > div").not(".hero, .main, #playerElementBackground, .countdown_bc").is(":visible"),i=$("#landing .landing_elements > div.main").not(this).is(":visible");(null==t||n)&&(console.log("-----------------not only with percent---------------"),e=!1),n||i||(t=100,a=1),null!=t?$(this).css({flex:"0 "+a+" "+t+"%"}):$(this).css({flex:""})})),e&&$.each($("#landing .landing_elements > div.main"),(function(){$(this).css({flex:"1 1 100%"})}))}function y(){if(AppData.profile&&"name"in AppData.profile){var e=$("div.main header .data-subtitle");e.removeClass("fadeIn").addClass("animated fadeOut"),e.on("animationend animationcancel",(function(t){e.off("animationend animationcancel").html(o?AppData.modulsettings.subTitle[localState.lang]:"userInfo"in AppData.settings&&"ip"===AppData.settings.userInfo?AppData.server.client_addr||"NOIP":AppData.profile.name[localState.lang]).removeClass("fadeOut").addClass("fadeIn"),o=!o,e=null})),setTimeout(y,5e3)}}function S(){$("#software .software_inner span").stop(),D()}function D(){cancelAnimationFrame(n);for(var e,t=/\[img:([0-9a-zA-Z]{8})\]/g,a=[];e=t.exec(AppData.settings.statusline);)a.push(e);var i=AppData.settings.statusline,o=0;for(var s in 0,a){var l=AppData.medias.find((function(e){return e.id==a[s][1]}));if(l&&null!=l.files[localState.lang]){let e=l.files[localState.lang].file;0;var r=new Image;r.src=e,r.onload=function(){++o==a.length&&_()&&(n=requestAnimationFrame(k))};let t='<img class="footer_item" src="'+e+'">';l.link&&(t='<img class="footer_item external-link" data-link="'+l.link+'" src="'+e+'">'),l.sponsor&&(t='<img class="footer_item sponsorinner-link" data-sponsorlink="'+l.sponsor+'" src="'+e+'">'),i=i.replace(a[s][0],t)}else i=i.replace(a[s][0],"")}for(var d,c=/\[text:([^\]]*)\]/g,u=[];d=c.exec(i);)u.push(d);for(var s in u)i=i.replace(u[s][0],'<div class="footer_item"><span>'+u[s][1]+"</span></div>");var p='<div class="sline">'+i+"</div>";$("#software").css({position:"fixed",top:"-1000px"}).appendTo($("body")),$("#software .software_inner").html(p),0==a.length&&_()}function _(){if("true"===String(AppData.settings.showVersion)){var e=0;if($(".software_inner .sline .footer_item").each((function(){e+=Math.ceil($(this).outerWidth())})),0!==e&&$(".software_inner .sline").css("width",e),$("#software").css({position:"",top:""}).appendTo($("#landing")),0,"classic"!=AppData.settings.homeScreen){$(".main").not(".system, #unity3d-details, #landing, #hamburger").addClass("hasfooter"),C($(".hasfooter:visible article"))}return e>$("#software .software_inner").outerWidth()}if("classic"!=AppData.settings.homeScreen){$(".main").not(".system, #unity3d-details, #landing, #hamburger").removeClass("hasfooter"),C($(".main:visible article").not(".system, #unity3d-details, #landing, #hamburger"))}return!1}function C(e){let t=$("article .container:visible",$(".main").not(".system, #unity3d-details, #landing, #hamburger"));if(t.length>0){let a=(e.outerHeight()-t.outerHeight())/2;t.css("margin-top",a+"px")}}function k(){if(n=requestAnimationFrame(k),_()){var e=$("#software .software_inner .sline .footer_item").first(),t=$("#software .software_inner .sline").css("transform").split(/[()]/)[1].split(",")[4]-.5;$("#software .software_inner .sline").css({transform:"translateX("+t+"px)"}),-e.outerWidth()>t&&(e.appendTo($("#software .software_inner .sline")),$("#software .software_inner .sline").css({transform:"translateX(0)"}))}}return $(document).on("mouseup touchend",".open-main",(function(e){if(e.preventDefault(),Navigation.setAllowCloseMenu(),!$(this).parent().hasClass("navplusbutton")){b.call(this)}})),$(document).on("mouseup touchend",".premium_content",(function(e){e.preventDefault(),Modal.confirmWithDismiss(Language.getItem("premium_content"),(function(){window.open("https://online.itbn.hu/payment/?uid="+AppData.profile.hash+"&lang="+localState.lang),setTimeout((function(){getIsPremium()}),1e3)}))})),$(document).on("click",".swap-main",(function(e){e.preventDefault(),Navigation.setAllowCloseMenu();var t=$(this).data("target"),a=$(this).data("id"),n=AppData.navigation.find((function(e){return e.id==a}));let i,o;if(localState.layoutActiveMenu=a,"hamburger"!==t&&writeDbLog(t,void 0!==n?n.name[localState.lang]:"","user_logs","menuopen"),$(this).data("targetid")){if(void 0!==n){if($("#"+t+"-details header").find("h3 .data-icon").removeAttr("class").addClass("data-icon "+$(this).data("icon")),i=$("#"+t+"-details"),w(n,i,t+"-details"))return}o=t.charAt(0).toUpperCase()+t.slice(1),window[o].showDetails($(this).data("targetid")),"function"==typeof window[o].showList&&window[o].showList($(this).data("targetid"))}else{if(t=t.toLowerCase(),void 0!==n){var s=$("#"+t+" header");if(s.find("h3 .data-icon").removeAttr("class").addClass("data-icon "+$(this).data("icon")),s.find("h3 .data-label").html(n.name[localState.lang]),i=$("#"+t),w(n,i,t))return}o=t.charAt(0).toUpperCase()+t.slice(1),null!=window[o]&&"function"==typeof window[o].showList&&window[o].showList(""),Layout.swap(t),t=null}for(let e in clientEventListeners)"swap"==clientEventListeners[e].type&&$(document).trigger(clientEventListeners[e].event_name);A()})),$(document).on("click",".close-main",(function(e){e.preventDefault(),"floating"===AppData.settings.homeScreen&&($("#"+localState.layout[localState.layout.length-2]).show(),$("#"+localState.layout[localState.layout.length-2]).attr("style","background-color: transparent")),"floating"===AppData.settings.homeScreen?$("#navplus").find(".container .open-main").css("border",""):$("nav").find(".container .open-main").css("border","");var t=$(this).closest("div.main").prop("id");Layout.hide(t),localState.layoutActiveMenu=void 0,t=null})),$(document).on("click","#software .sline .external-link",(function(){let e=$(this).attr("data-link");window.open(e)})),$(document).on("click","#software .sline .sponsorinner-link",(function(){let e=$(this).attr("data-sponsorlink");Sponsors.showDetails(e)})),$(document).on("click touchend","div.main.backdrop",(function(e){e.preventDefault(),Layout.hide("hamburger")})),$(document).on("mouseup touchend","img.logo",g),$(document).on("click",".home",g),$(document).on("mouseup touchend",".closebutton",g),$(document).on("mouseup touchend",".sharebutton, .share_video",(function(){var e=window.location,t="",a="";localState.layout.length>0&&((t=localState.layout[localState.layout.length-1]).indexOf("-details")>-1&&(t=t.replace("-details",""),a=""!=localState[t].itemIndex&&null!=localState[t].itemIndex?"&i="+localState[t].itemIndex:""),t="?m="+t),e=e+"?share="+btoa(t+a),console.log(e),navigator.clipboard?navigator.clipboard.writeText(e).then((function(){Modal.alert(Language.getItem("share-url-copied")+"<br>"+e)}),(function(){Modal.alert(Language.getItem("cannot-copy-share-url")+"<br>"+e)})):Modal.alert(Language.getItem("cannot-copy-share-url")+"<br>"+e)})),$(window).on("resize orientationchange",(function(){var e=$(".bubbles1, .bubbles2");$("#resolution").text(screen.width+"x"+screen.height),"hidden"!=AppData.settings.bubble?e.is(":visible")&&($(e).hide(),requestAnimationFrame((function(){e.show(),e=null}))):$(e).hide()})),{Init:function(){var n=$("div.details"),o=$("div.main:not(.details, .system)");D(),$(window).on("resize",(function(){clearTimeout(i),i=setTimeout((function(){D()}),500)})),e=$("template#backdrop").remove().contents(),t=$("template#mainModuleHeader").remove().contents(),a=$("template#mainScrollTop").remove().contents(),$.each(o,r);var s=AppData.navigation.filter((function(e){return null!==e.group&&e.group.indexOf(AppData.profile.group)>-1}));$.each(s,d),$.each(n,c);for(var l=document.querySelectorAll("div.main:not(#profile):not(#surveys-details):not(#game) article"),m=0;m<l.length;m++)l[m].addEventListener("scroll",p,{passive:!0});$(document).on("click","div.main .scroll-top",u),y(),void 0!==AppData.modulsettings.broadcastThumbnail&&""!=AppData.modulsettings.broadcastThumbnail&&Broadcast.setBroadcastPoster(),document.title=AppData.modulsettings.browsertitle[localState.lang],setFavicon(),"floating"===AppData.settings.homeScreen&&($("div.main").not("#hamburger").not("#modal").not(".system").not("#docs-details").css("background-color","transparent"),$("#landing .landing_elements").find(".trueconf").css("z-index","1000")),delete Layout.Init,n=l=null},show:f,dashboardShow:function(e){var t=e,a=t.substr(0,t.indexOf("###")),n=t.substr(t.indexOf("###")+3);let i="[data-target='"+a+"']";""!=n&&(i+="[data-targetid='"+n+"']"),$(i).trigger("mouseup")},dashboardHide:function(e){"weblinks-iframe"===e?Weblinks.closeWeblinkIframe():Layout.hide(e)},hide:h,swap:function(e){if(!AppData.modulsettings.showgdpr||1==AppData.profile.gdpr){var t=$("#"+e);t.siblings(".bodycontent > div.main:visible").not(".backdrop").each(v),f(e),"hamburger"!==e&&$("#minimal_nav").removeClass("topAnimationUp").addClass("topAnimationDown"),t=null}},BuildFromSource:S,GetMediasFromSource:function(){$.ajax({method:"post",url:"api/",data:{do:"getMedias"},success:function(e){AppData.medias=e,S()}})},hideAll:g,_eachInitNavigation:d,setMainSizes:A}}();
var Toast=function(){var a,e="animated faster fadeInDown active",t="animated faster fadeOutUp";function s(){$("div.main header .toast").filter(".active").each(i)}function i(){var a=$(this);a.removeClass(e).addClass(t).on("animationend animationcancel",(function(e){(e.target||e.originalEvent.target)===this&&a.off("animationend animationcancel").removeClass(t).hide()}))}return $(document).on("click","header .toast .close",s),{show:function(i,n){if(!i)return!1;var o,r=$("div.main:visible").not(".system, .backdrop").last().find("header .toast");switch(n){case"success":o=$('<i class="status fas fa-check"></i>');break;case"error":o=$('<i class="status fas fa-exclamation"></i>');break;default:o=$("")}r.find(".status").remove(),o.addClass("flex-min-content").insertBefore(r.find(".msg")),r.show().removeClass(t).addClass(e).find(".msg").text(i),clearTimeout(a),a=setTimeout(s,5e3)}}}();
var Game=function(){"use strict";return $(document).on("change","#game input[type=radio], #game input[type=checkbox]",(function(){var e="state-checked animated pulse",a=$(this).closest("label");"radio"===this.type&&a.siblings().removeClass(e),a.toggleClass(e,this.checked),100*($("#game").find(".exhibition_quiz .state-checked.correct").length||0),$("#game").find("[type=submit]").toggleClass("disabled",5!==$("#game").find(".exhibition_quiz .state-checked").length)})).on("click","#game .survey-star .fa-star",(function(){var e=$(this);e.prevAll().addBack().removeClass("far").addClass("fas"),e.nextAll().removeClass("fas").addClass("far"),e.closest(".item").find("input").val(e.index()+1).trigger("change")})).on("submit","#game form",(function(e){var a;e.preventDefault(),$(this).hide(),$(this).closest("div.main").find(".done").show(),$("#game form").serializeArray(),$.ajax({method:"post",url:"api/",data:{do:"saveMeeVet",meevet:meevet_result}}),(a=$("#game form")).find("input[type=hidden]").val(""),a.find("input[type=radio], input[type=checkbox]").prop("checked",!1),a.find("label").removeClass("state-checked animated pulse"),a.find(".fa-star").removeClass("fas").addClass("far"),a.find("textarea").val(""),a.find(".state-checked").removeClass("state-checked"),a.find("[type=submit]").addClass("disabled")})),{Init:function(){0}}}();
var Agenda=function(){"use strict";var a,e,t,n,i,d,o,l;function s(){$(".agenda_day_tab").removeClass("active bg-primary"),$(this).addClass("active bg-primary"),localState.agenda={dayIndex:$(this).attr("data-dayid")||0,itemIndex:0},p()}function r(){$("#agenda-details .speakersList .item").each((function(a,e){!0===AppData.modulsettings.showspeakergotolink?($(e).addClass("link"),$(e).find(".chevron").show()):($(e).removeClass("link"),$(e).find(".chevron").hide())}))}function c(a){$.post("api/",{do:"getAgenda"},(function(e){AppData.agenda=e,g(a),FavoriteAgenda.Build(),Issues.Build(),e=null}))}function g(e){(AppData.agenda||[]).sort((function(a,e){return a.date==e.date?a.timeStart<e.timeStart?-1:a.timeStart>e.timeStart?1:0:a.date<e.date?-1:1})),(AppData.days||[]).sort((function(a,e){return AppData.modulsettings.agendasortbyorder?void 0!==a.sort_id&&void 0!==e.sort_id?parseInt(a.sort_id)>parseInt(e.sort_id)?1:-1:void 0:a.date.localeCompare(e.date)})),AppData.modulsettings.agendatabs&&function(){a={};for(var e=0;e<AppData.agenda.length;e++){var t=AppData.agenda[e];let i=t.day;"string"==typeof t.day&&(i=[t.day]);for(let e=0;e<i.length;e++){null==a[i[e]]&&(a[i[e]]={});var n="no_channel";"no_channel"!=(n=""==t.rooms||null==t.rooms?"no_channel":t.rooms)&&(null==a[i[e]][n]&&(a[i[e]][n]=[]),a[i[e]][n].push(t))}}}(),u(e),p(),"hidden"!==$("#agenda-details").css("visibility")&&(m("2"),m("1")),x()}function u(a){if(!("days"in AppData)||!(AppData.days||[]).length)return!1;if(AppData.modulsettings.agendatabs){$("#agenda .date-wrapper").hide(),$("#agenda .date-wrapper-tab").show(),$("#agenda #agendaList").hide(),$("#agenda #agendaListTab").show(),$("#agenda .date-wrapper-tab").html("");var n=$("#agenda #agendaDayTab").contents(),i=AppData.days.filter((function(a){return a.active}));let e=0;return $.each(AppData.days,(function(t,d){if(d.active){var o=n.clone();o.attr("data-dayid",d.id),o.html(d.name[localState.lang]),null!=a&&""!=a||0!=e?a==d.id&&o.addClass("active bg-primary"):o.addClass("active bg-primary"),o.appendTo($("#agenda .date-wrapper-tab")),o.css({flex:"1 1 "+100/i.length+"%"}),e++}})),void("agenda"in localState&&null!=a&&""!=a?localState.agenda.dayIndex=a:localState.agenda={dayIndex:$("#agenda .date-wrapper-tab .agenda_day_tab.active").attr("data-dayid"),itemIndex:0})}$("#agenda .date-wrapper").show(),$("#agenda .date-wrapper-tab").hide(),$("#agenda #agendaList").show(),$("#agenda #agendaListTab").hide();var d=$(document.createDocumentFragment());if(e=Language.getItem("months")||[],t=Language.getItem("days")||[],$.each(AppData.days,(function(a,e){if(e.active){let a=$("<option>",{val:e.id,text:e.name[localState.lang]});a.appendTo(d),e.color&&a.css({color:e.color})}})),$("#agenda select.date-selector").html(d),"agenda"in localState){var o=$("#agenda select.date-selector option").map((function(){return this.value})).get().indexOf(a?String(a):localState.agenda.dayIndex);-1===o&&(o=0),$("#agenda select.date-selector").prop("selectedIndex",o),localState.agenda.dayIndex=$("#agenda select.date-selector").val()}else localState.agenda={dayIndex:$("#agenda select.date-selector").val(),itemIndex:0};$("#agenda .date-wrapper .content").text($("#agenda select.date-selector option:selected").text()),d=null}function p(){if(!("agenda"in AppData)||!(AppData.agenda||[]).length)return!1;var e=$("#agenda #agendaList"),t=$("#agenda .agendadocs"),i=localState.agenda,d=$(document.createDocumentFragment());let o=AppData.docs.filter((function(a){return"agendadoc"==a.type}));if(t.empty(),o.length>0&&$.each(o,(function(a,e){let n=$("<div/>").addClass("agendadoc");n.html('<a href="javascript:void(0);" class="color-primary">'+e.title[localState.lang]+"</a>").attr("data-docid",e.id),n.on("click",(function(){Docs.showDetails($(this).attr("data-docid"))})),t.append(n)})),AppData.modulsettings.agendatabs){e=$("#agenda #agendaListTab");var l=a[i.dayIndex],s=$("#agenda #agendaChannelTab");for(var r in l){var c=s.contents().clone(),g=AppData.channels.find((function(a){return a.channel==r}));null!=g?c.find(".agenda_channel_title").html(g.name[localState.lang]):c.find(".agenda_channel_title").html("Other");var u=c.find(".agendaList");$.each(l[r],(function(a,e){var t=Math.abs(new Date("2020/09/23 "+e.timeEnd)-new Date("2020/09/23 "+e.timeStart)),d=Math.floor(t/1e3/60/5);e.minutes=d,e.active=void 0===e.active||e.active;let o=e.day;var l;("string"==typeof e.day&&(o=[e.day]),e.active&&o.indexOf(i.dayIndex)>-1)&&(e.parent||(f(l=n.clone(),e),l.appendTo(u),l=null))})),c.appendTo(d)}}else $.each(AppData.agenda,(function(a,e){e.active=void 0===e.active||e.active;let t=e.day;if("string"==typeof e.day&&(t=[e.day]),e.active&&t.indexOf(i.dayIndex)>-1&&!e.parent){var o=n.clone();f(o,e),o.appendTo(d),o=null}}));e.html(d),e=i=d=null,y()}function f(a,t){var n=AppData.translations.filter((function(a){return a.translation_id===localState.lang}))[0];a.toggleClass("now","now"===t.status),a.toggleClass("ended","ended"===t.status),a.toggleClass("breaking",!t.rooms&&!t.details),a.toggleClass("link",!!t.rooms||!!t.details),a.attr("data-id",t.id),a.find(".data-timeStart").text(makeTimeFormat(t.timeStart,n.time_format)),a.find(".data-timeEnd").text(makeTimeFormat(t.timeEnd,n.time_format));var i,d=AppData.days.find((function(a){return t.day===a.id}))||{},o=new Date(d.date);i="hu"==localState.lang?o.getFullYear()+". "+e[o.getMonth()]+" "+o.getDate()+".":o.getDate()+" "+e[o.getMonth()]+" "+o.getFullYear(),a.find(".data-date").text(i),a.find(".date-cont").toggleClass("hidden","shown_list"!=t.showtime),a.find(".time-cont").toggleClass("hidden","hidden"==t.showtime&&void 0!==t.showtime);var l,s=AppData.channels.find((function(a){return a.channel===t.rooms}))||!1;if(a.find(".data-rooms").attr("data-room-id",t.rooms).text(s?s.name[localState.lang]:"").parent().toggleClass("hidden",!s),l="string"==typeof t.title?t.title:t.title[localState.lang],a.find(".data-title").text(l),t.speakers&&AppData.modulsettings.showspeakersislist){var r;r="string"==typeof t.speakers?[t.speakers]:t.speakers;let e=[];$.each(r,(function(a,t){var n=[],i=AppData.speakers.find((function(a){return a.id===t.speaker_id}));if(i){n.push('<span class="text-bold">'+i.name[localState.lang]+"</span>");let a="object"==typeof i.company?i.company[localState.lang]:i.company;""!=a&&n.push('<span class="text-italic">'+a+"</span>");let t="object"==typeof i.position?i.position[localState.lang]:i.position;""!=t&&n.push(t),e.push(n)}})),e.length>0&&(a.find(".speakers").removeClass("hidden"),a.find(".speakers").html(e.map((a=>"<div>"+a.join("<br>")+"</div>")).join("")))}else a.find(".speakers").addClass("hidden");a.find("[data-lang=now]").text(Language.getItem("now")),a.find("[data-lang=expired]").text(Language.getItem("expired"));var c=70*t.minutes+"px";t.minutes>1&&a.find(".data-title").addClass("no-ellipsis"),a.css({height:c}),"max"==t.use_maxheight&&a.css({"max-height":"200px"})}function m(a){var s,r=AppData.translations.filter((function(a){return a.translation_id===localState.lang}))[0];if("1"===a?(s="",localState.agenda.itemIndex=localState.agendadetails):"2"===a?(localState.agenda.itemIndex=localState.agendasubdetails,s="sub"):(localState.agenda.itemIndex=localState.agendasubsubdetails,s="subsub"),!("agenda"in localState)||!("agenda"in AppData)||!(AppData.agenda||[]).length)return Layout.hide("agenda-details"),!1;var c,g=$("#agenda-"+s+"details article"),u=$("#agenda-"+s+"details .data-label"),p=AppData.agenda.find((function(a){return a.id===localState.agenda.itemIndex}))||AppData.agenda[0],m=AppData.days.find((function(a){return a.id==localState.agenda.dayIndex}))||{},h=new Date(m.date);c="hu"==localState.lang?t[h.getDay()]+", "+h.getFullYear()+". "+e[h.getMonth()]+" "+h.getDate()+".":t[h.getDay()]+", "+h.getDate()+" "+e[h.getMonth()]+" "+h.getFullYear(),u.text("now"===p.status?Language.getItem("now"):"ended"===p.status?Language.getItem("expired"):c),g.find(".data-date").text(c),g.find(".data-timeStart").text(makeTimeFormat(p.timeStart,r.time_format)),g.find(".data-timeEnd").text(makeTimeFormat(p.timeEnd,r.time_format)),g.find(".date-cont").toggleClass("hidden","hidden"==p.showtime&&void 0!==p.showtime);var v,y=AppData.channels.find((function(a){return a.channel===p.rooms}))||!1;g.find(".data-rooms").attr("data-room-id",p.rooms).text(y?y.name[localState.lang]:"").parent().toggleClass("hidden",!y),v="string"==typeof p.title?p.title:p.title[localState.lang];var k=AppData.agenda.filter((function(a){return a.active=void 0===a.active||a.active,a.parent===p.id&&!0===a.active})),S=$(document.createDocumentFragment());$.each(k,(function(a,e){var t=n.clone();f(t,e),t.appendTo(S),t=null})),Boolean(k.length)&&$("#agenda-"+s+"details").attr("data-targetid",p.id),g.find(".apply-booking").hide(),g.find(".join-workshop").hide(),g.find(".join-stream").hide(),g.find(".on_waiting").hide(),g.find(".ondemand").hide();let b=p.ondemand_id;if(""!=b&&null!=b){var D=AppData.ondemandvideos.find((function(a){return a.id==b}));null!=D&&g.find(".ondemand").show().unbind("click").on("click",(function(){Ondemandvideos.showDetails(D.id)}))}if(p.show_apply_btn){let a=p.id,e=g.find(".apply-booking"),t=p;e.show(),e.unbind("click");let n=AppData.profile.agenda_bookings.find((function(e){return e.agenda==a})),i=p.trueconf,d=p.broadcast_id;""!=i&&null!=i&&g.find(".join-workshop").show().unbind("click").on("click",(function(){i.includes(".rentit.hu")?function(a,e){$.ajax({method:"post",url:"api/",dataType:"json",data:{do:"checkTrueConfRoom",room:a,server:"exhibitor"},success:function(a){e(a)}})}(i,(function(a){a.participants.length<50?Bookings.joinTcRoom({},i):Modal.alert(Language.getItem("user-limit-exceeded"))})):window.open(i)})),""!=d&&null!=d&&g.find(".join-stream").show().unbind("click").on("click",(function(){Layout.hideAll(),Broadcast.showDetails(d)})),n?(e.find("span").html(Language.getItem("cancel-booking")),n.waiting&&g.find(".on_waiting").show(),e.on("click",(function(){$.ajax({method:"post",url:"api/",data:{do:"cancelAgendaBooking",id:n.id},success:function(a){Modal.alert(Language.getItem("bookings-cancelled")),AppData.profile=a,Agenda.BuildFromSource(),BookedAgenda.Build(),null!=a.added&&Socket.Send("Profile.updateProfile",null,{uid:a.added})}})}))):(e.find("span").html(Language.getItem("apply-booking")),e.on("click",(function(){$.ajax({method:"post",url:"api/",data:{do:"saveAgendaBooking",agenda:a},success:function(a){if(null!=a.error){var e=Language.getItem(a.error);Modal.alert(e)}else Modal.alert(Language.getItem("bookings-saved")),function(a){var e=AppData.days.filter((function(e){return e.id===a.day}))[0];$.post("api/",{do:"generateIcal",data:{date:e.date+" "+a.timeStart,title:a.title[localState.lang],location:"",url:"",dateend:e.date+" "+a.timeEnd,description:a.details[localState.lang]}},(function(a){console.log("response",a)}))}(t);null!=a.profile&&(AppData.profile=a.profile,BookedAgenda.Build()),Agenda.BuildFromSource()}})})))}if(g.find(".data-title").text(v),g.find(".childrenagenda").html(S).toggle(Boolean(k.length)),g.find(".data-details").html(p.details[localState.lang]),g.find(".item.speaker").remove(),g.find(".speakersList").hide(),p.speakers){var w,A=$(document.createDocumentFragment());w="string"==typeof p.speakers?[p.speakers]:p.speakers,$.each(w,(function(a,e){var t=d.clone(),n=[],i=AppData.speakers.find((function(a){return a.id===e.speaker_id}));i&&($.each(i.values,(function(a,e){"1"===e.showrow?n.unshift("object"==typeof e.title?e.title[localState.lang]:e.title):"2"===e.showrow&&n.push("object"==typeof e.title?e.title[localState.lang]:e.title)})),n.push("object"==typeof i.company?i.company[localState.lang]:i.company),n.push("object"==typeof i.position?i.position[localState.lang]:i.position),t.attr("data-index",i.id),t.find(".data-name").text(i.name[localState.lang]),t.find(".data-info").html(n.join("<br>")).toggleClass("hidden",!n.length),t.find(".data-img").attr("src",i.img?"upload/users/"+i.img:"img/profile-picture-placeholder.png"),!0===AppData.modulsettings.showspeakergotolink?t.toggleClass("link"):(t.removeClass("link"),t.find(".chevron").hide()),t.appendTo(A)),t=null})),A.appendTo(g.find(".speakersList").show()),A=null}if(g.find(".item.doc").remove(),g.find(".docsList").hide(),p.docs){var x=$(document.createDocumentFragment());$.each(p.docs,(function(a,e){var t=o.clone(),n=AppData.docs.find((function(a){return a.id===e.doc_id}));n&&(t.attr("data-index",n.id),t.find(".data-title").text(n.title[localState.lang]),t.appendTo(x)),t=null})),x.appendTo(g.find(".docsList").show()),x=null}if(g.find(".item.survey").remove(),g.find(".surveyList").hide(),p.surveys){var I,L=$(document.createDocumentFragment());$.each(p.surveys,(function(a,e){var t=l.clone();I=AppData.surveys.find((function(a){return a.id===e.survey_id&&!0===a.active})),I&&(t.attr("data-index",I.id),t.find(".data-title").text(I.title[localState.lang]),t.appendTo(L)),t=null})),I&&L.appendTo(g.find(".surveyList").show()),L=null}if(void 0!==p.solutions&&p.solutions[localState.lang].length){var C="<strong>"+AppData.languages[localState.lang]["profile-interests"]+'</strong><ul class="agendainterests">';p.solutions[localState.lang].forEach((function(a){AppData.select_fields.SOLUTIONS[localState.lang][a]&&(C+="<li>"+AppData.select_fields.SOLUTIONS[localState.lang][a]+"</li>")})),C+="</ul>",g.find(".data-interests").show(),g.find(".data-interests>span").html(C),void 0!==g.find(".data-interests>span").html()&&sortListUl(".agendainterests")}else g.find(".data-interests").hide();if(g.find(".item.video").remove(),g.find(".videosList").hide(),p.videos){var T,F=$(document.createDocumentFragment());T="string"==typeof p.videos?[p.videos]:p.videos,$.each(T,(function(a,e){var t=i.clone(),n=AppData.ondemandvideos.find((function(a){return a.id===e.v_id}));n&&(t.attr("data-index",n.id),t.find(".data-name").text(n.title[localState.lang]),t.appendTo(F)),t=null})),F.appendTo(g.find(".videosList").show()),F=null}if(_(s,p.show_add_favorite_button),AppData.profile.favorite_agenda)var B=AppData.profile.favorite_agenda.find((function(a){return a.agenda==p.id}));B?$("i",$("#agenda-"+s+"details .favorite_agenda")).removeClass("far").addClass("fa"):$("i",$("#agenda-"+s+"details .favorite_agenda")).removeClass("fa").addClass("far");var j=AppData.navigation.filter((function(a){return"issues"==a.module&&a.visible})),O=AppData.navigation.filter((function(a){return"notes"==a.module&&a.visible}));0!=j.length&&p.show_new_question_button?$("#agenda-"+s+"details .new-issue").show():$("#agenda-"+s+"details .new-issue").hide(),0!=O.length&&p.show_new_note_button?$("#agenda-"+s+"details .new-note").show():$("#agenda-"+s+"details .new-note").hide(),g=u=p=c=null}function h(){let a=$(this).attr("data-index");Ondemandvideos.showDetails(a)}function v(){var a=$("#agenda #agendaList");localState.agenda={dayIndex:$(this).val()||0,itemIndex:0},$("#agenda .date-wrapper .content").text($("#agenda select.date-selector option:selected").text()),a.on("animationend",(function(e){e.stopPropagation(),(e.target||e.originalEvent.target)===this&&(a.off("animationend").removeClass("fadeOutLeft").addClass("fadeInRight"),p(),requestAnimationFrame((function(){a.on("animationend",(function(){(e.target||e.originalEvent.target)===this&&a.off("animationend").removeClass("fadeInRight fadeOutLeft")}))})))})),requestAnimationFrame((function(){a.removeClass("fadeInRight").addClass("animated faster fadeOutLeft")}))}function y(){AppData.modulsettings.agendaopenitems?$("#agenda .item .chevron").show():$("#agenda .item .chevron").hide()}function k(){AppData.modulsettings.agendaopenitems&&(localState.agenda={dayIndex:$("#agenda select.date-selector").val()||$("#agenda .agenda_day_tab.active").attr("data-dayid")||0,itemIndex:String($(this).data("id"))||0},localState.agendadetails=String($(this).data("id"))||0,writeDbLog("show details",String($(this).data("id"))||0,"user_logs","agenda"),m("1"),Layout.hide("agenda-details",!0),Layout.show("agenda-details"))}function S(){AppData.modulsettings.agendaopenitems&&(localState.agenda={dayIndex:$("#agenda select.date-selector").val()||$("#agenda .agenda_day_tab.active").attr("data-dayid")||0,itemIndex:String($(this).data("id"))||0},localState.agendasubdetails=String($(this).data("id"))||0,writeDbLog("show details",String($(this).data("id"))||0,"user_logs","agenda"),m("2"),Layout.hide("agenda-subdetails",!0),Layout.show("agenda-subdetails"))}function b(){localState.agenda={dayIndex:$("#agenda select.date-selector").val()||$("#agenda .agenda_day_tab.active").attr("data-dayid")||0,itemIndex:String($(this).data("id"))||0},localState.agendasubsubdetails=String($(this).data("id"))||0,writeDbLog("show details",String($(this).data("id"))||0,"user_logs","agenda"),m("3"),Layout.hide("agenda-subsubdetails",!0),Layout.show("agenda-subsubdetails")}function D(){Issues.evtClickItem({data:{mod:!1,id:localState.agenda.itemIndex}})}function w(){var a,e=AppData.agenda.find((function(a){return a.id===localState.agenda.itemIndex}));a="string"==typeof e.title?e.title:e.title[localState.lang],Notes.evtClickItem({data:{title:e?a:""}})}function A(){var a=localState.agenda.itemIndex,e=$(this);$.ajax({method:"post",url:"api/",data:{do:"saveFavoriteAgenda",id:a},success:function(a){"added"==a.status?$("i",e).removeClass("far").addClass("fa"):$("i",e).removeClass("fa").addClass("far"),AppData.profile=a.profile,FavoriteAgenda.Build(),BookedAgenda.Build()}})}function x(){var a=$("#agenda");setTimeout((function(){var e=a.find("classic"===AppData.settings.homeScreen?"article":".scrollbarcontainerbgvideo"),t=e.find(".item.now").get(0);t&&e.animate({scrollTop:t.offsetTop-screen.availHeight/3},300,"linear")}),300)}function _(a="",e=!0){AppData.modulsettings.showfavorite&&e?$("#agenda-"+a+"details .favorite_agenda").show():$("#agenda-"+a+"details .favorite_agenda").hide()}return{Init:function(){n=$("template#tplAgendaItem").remove().contents(),i=$("template#tplAgendaVideo").remove().contents(),d=$("template#tplAgendaSpeaker").remove().contents(),o=$("template#tplAgendaDoc").remove().contents(),l=$("template#tplAgendaSurvey").remove().contents(),e=Language.getItem("months")||[],t=Language.getItem("days")||[],$(document).on("show","#agenda",x).on("change","#agenda select.date-selector",v).on("click","#agenda #agendaList .item:not(.breaking)",k).on("click","#agenda #agendaListTab .item:not(.breaking)",k).on("click","#agenda-details .childrenagenda .item:not(.breaking)",S).on("click","#agenda-subdetails .childrenagenda .item:not(.breaking)",b).on("click","#agenda #speakersList .item",k).on("click","#agenda-details .speaker",Speakers.evtClickDetails).on("click","#agenda-subdetails .speaker",Speakers.evtClickDetails).on("click","#agenda-subsubdetails .speaker",Speakers.evtClickDetails).on("click","#agenda-details .video",h).on("click","#agenda-subdetails .video",h).on("click","#agenda-subsubdetails .video",h).on("click","#agenda-details .new-issue",D).on("click","#agenda-subdetails .new-issue",D).on("click","#agenda-subsubdetails .new-issue",D).on("click","#agenda-details .new-note",w).on("click","#agenda-subdetails .new-note",w).on("click","#agenda-subsubdetails .new-note",w).on("click","#agenda-details .doc",Docs.evtClickDetails).on("click","#agenda-subdetails .doc",Docs.evtClickDetails).on("click","#agenda-subsubdetails .doc",Docs.evtClickDetails).on("click","#agenda-details .survey",Surveys.evtClickDetails).on("click","#agenda-subdetails .survey",Surveys.evtClickDetails).on("click","#agenda-subsubdetails .survey",Surveys.evtClickDetails).on("click","#agenda-details .favorite_agenda",A).on("click","#agenda-subdetails .favorite_agenda",A).on("click","#agenda-subsubdetails .favorite_agenda",A).on("click","#agenda .agenda_day_tab",s),r(),g(),delete Agenda.Init},evtClickDetails:k,showDetails:function(a){writeDbLog("show details",a,"user_logs","agenda"),a&&(null!=localState.agenda?a===localState.agenda.itemIndex&&0!==localState.agenda.itemIndex||(localState.agenda.itemIndex=String(a),localState.agendadetails=String(a),m("1")):localState.agenda={itemIndex:String(a)},Layout.show("agenda-details"))},showFavorite:_,BuildFromSource:c,BuildFromSourceWidthSelectedDay:function(){$.post("api/",{do:"getDays"},(function(a){AppData.days=a;let e=$("#agenda select.date-selector option:selected").val();AppData.modulsettings.agendatabs&&(e=$("#agenda .agenda_day_tab.active").attr("data-dayid")),c(e)}))},BuildDates:u,Build:g,renderList:p,toggleRequestSpeakerGotoLink:r,toggleItemArrows:y,UpdateModule:function(a){let e=$("#agenda select.date-selector option:selected").val();AppData.modulsettings.agendatabs&&(e=$("#agenda .agenda_day_tab.active").attr("data-dayid")),g(null==a?e:a),FavoriteAgenda.Build(),Issues.Build()},shown:function(){$("#agenda .agenda_channel_title").css({top:$("#agenda .date-wrapper-tab").get(0).offsetHeight})}}}();
var Attendees=function(){"use strict";var t,e=20;function a(t){AppData.user_fields.sort((function(t,e){return void 0!==t.sort_id&&void 0!==e.sort_id?parseInt(t.sort_id)>parseInt(e.sort_id)?1:-1:0}));var e,a,n,l=AppData.user_fields.filter((function(t){return!0===t.is_active}));$("#attendees-details .custom_fields").html(""),$.each(l,(function(l,s){(n=$("<section/>")).addClass("item "+("text"===s.field_type?"text-center":"text-justify")),e=$("<div/>"),n.append(e),a="",""!==s.field_icon&&(a="<i class='"+s.field_icon+"'></i> "),s.field_translated?t&&""!==t.values[s.field_name].title&&(e.html(a+t.values[s.field_name].title[localState.lang]),$("#attendees-details .custom_fields").append(n)):t&&""!==t.values[s.field_name].title&&(e.html(a+t.values[s.field_name].title),$("#attendees-details .custom_fields").append(n))}))}function n(){var t=$(this).attr("data-link");window.open(t)}function l(){var e=$("#attendees #attendeesList"),a=$(document.createDocumentFragment());$.each(AppData.attendees,(function(n,l){if(l.active){var s=t.clone(),d=[];$.each(l.values,(function(t,e){"1"===e.showrow&&e.is_active?d.unshift("object"==typeof e.title?e.title[localState.lang]:e.title):"2"===e.showrow&&e.is_active&&d.push("object"==typeof e.title?e.title[localState.lang]:e.title)})),l.is_premium&&AppData.nativesettings.appstore_user!=AppData.profile.id?s.addClass("premium_user"):s.removeClass("premium_user"),s.attr("data-index",l.id),s.find(".data-name").html(l.name[localState.lang]),s.find(".data-info").html(d.join("<br>")).toggleClass("hidden",!d.length||!AppData.modulsettings.attendeeshowinfo),l.img?s.find(".data-img").attr(e.is(":visible")?"src":"data-src","upload/users/"+l.img):s.find(".data-img").attr("src","img/profile-picture-placeholder.png"),s.appendTo(a)}}));let n=$("<div/>").addClass("more-cont");$("<button/>").addClass("btn load-more").html(Language.getItem("load-more")).appendTo(n),n.appendTo(a),e.html(a)}function s(){$("#attendees #attendeesList .load-more").addClass("disabled").prop("disabled",!0).show(),$.ajax({method:"post",url:"api/",data:{do:"loadMoreAttendees",page:localState.attendees.page,lang:localState.lang},success:function(t){$("#attendees #attendeesList .load-more").removeClass("disabled").prop("disabled",!1),localState.attendees.page++,AppData.attendees=AppData.attendees.concat(t.attendees),AppData.user_fields=t.user_fields,p(),0===t.count||t.count<=localState.attendees.page*e?$("#attendees #attendeesList .load-more").hide():$("#attendees #attendeesList .load-more").show(),$("#attendees .no-result").toggle(0===t.count)},error:function(){$("#attendees #attendeesList .load-more").removeClass("disabled").prop("disabled",!1)}})}function d(){AppData.modulsettings.showexchangeprofileattendees?$("#attendees-details").find(".favorite").show():$("#attendees-details").find(".favorite").hide()}function o(){AppData.modulsettings.showsociallinks?$("#attendees-details").find(".social").show():$("#attendees-details").find(".social").hide()}function i(){if("attendees"in localState){var t=$("#attendees-details article"),e=$("#attendees-details .data-label"),n=(localState.attendees,AppData.favorites.find((function(t){return"attendee"===t.type&&t.data===localState.attendees.itemIndex}))),l=Boolean(n),s=Boolean(n)&&!n.sent,i=AppData.attendees.find((function(t){return t.id===localState.attendees.itemIndex}));if(i||null!=localState.attendees.itemIndex&&0!=localState.attendees.itemIndex&&$.ajax({method:"post",url:"api/",data:{do:"getUser",uid:localState.attendees.itemIndex},async:!1,success:function(t){i=t}}),!i)return!1;e.html(i.name[localState.lang]),t.find(".data-img").attr({src:"img/profile-picture-placeholder.png","data-src":null}),i.img&&t.find(".data-img").attr("src","upload/users/"+i.img),i.is_premium&&AppData.nativesettings.appstore_user!=AppData.profile.id?t.find(".avatar").addClass("premium_user"):t.find(".avatar").removeClass("premium_user");var r=i.mobile?atob(atob(i.mobile).substring(1)):"",c=i.email?atob(atob(i.email).substring(1)):"";let u=i.facebook_url?i.facebook_url:"",f=i.twitter_url?i.twitter_url:"",h=i.instagram_url?i.instagram_url:"",m=i.linkedin_url?i.linkedin_url:"";if(t.find(".facebook").attr("data-link",u).toggleClass("hidden",!u),t.find(".twitter").attr("data-link",f).toggleClass("hidden",!f),t.find(".instagram").attr("data-link",h).toggleClass("hidden",!h),t.find(".linkedin").attr("data-link",m).toggleClass("hidden",!m),t.find(".social").toggleClass("hidden",!(u||f||h||m)),t.find(".data-name").html(i.name[localState.lang]),t.find(".data-job").html(i.job[localState.lang]).toggleClass("hidden",!i.job[localState.lang]),t.find(".data-company").html(i.company[localState.lang]).toggleClass("hidden",!i.company[localState.lang]),i.pubPhone?(t.find(".data-phone").show(),t.find(".data-phone>span").html(r)):t.find(".data-phone").hide(),i.pubEmail?(t.find(".data-email").show(),t.find(".data-email>span").html(c)):t.find(".data-email").hide(),i.position[localState.lang].length){var p="<strong>"+AppData.languages[localState.lang]["profile-position"]+"</strong>";p+="<p>"+i.position[localState.lang]+"</p>",t.find(".data-position").show(),t.find(".data-position>span").html(p)}else t.find(".data-position").hide();i.post[localState.lang].length&&"0"!=i.post[localState.lang]?(p="<strong>"+AppData.languages[localState.lang]["profile-post"]+"</strong>",p+="<p>"+AppData.select_fields.USER_POST[localState.lang][i.post[localState.lang]]+"</p>",t.find(".data-post").show(),t.find(".data-post>span").html(p)):t.find(".data-post").hide(),i.degree[localState.lang].length?(p="<strong>"+AppData.languages[localState.lang]["profile-degree"]+"</strong><ul>",i.degree[localState.lang].forEach((function(t){p+="<li>"+AppData.select_fields.DEGREE[localState.lang][t]+"</li>"})),p+="</ul>",t.find(".data-degree").show(),t.find(".data-degree>span").html(p)):t.find(".data-degree").hide(),i.professionaldegree[localState.lang].length?(p="<strong>"+AppData.languages[localState.lang]["profile-professionaldegree"]+"</strong>",p+="<p>"+i.professionaldegree[localState.lang]+"</p>",t.find(".data-professionaldegree").show(),t.find(".data-professionaldegree>span").html(p)):t.find(".data-professionaldegree").hide(),i.goal[localState.lang]?(p="<strong>"+AppData.languages[localState.lang]["profile-goal"]+"</strong>",p+="<p>"+AppData.select_fields.PURPOSE_OF_ITBN_PARTICIPATION[localState.lang][i.goal[localState.lang]]+"</p>",t.find(".data-goal").show(),t.find(".data-goal>span").html(p)):t.find(".data-goal").hide(),i.wherehear[localState.lang].length?(p="<strong>"+AppData.languages[localState.lang]["profile-wherehear"]+"</strong><ul>",i.wherehear[localState.lang].forEach((function(t){p+="<li>"+AppData.select_fields.WHERE_HEAR[localState.lang][t]+"</li>"})),p+="</ul>",t.find(".data-wherehear").show(),t.find(".data-wherehear>span").html(p)):t.find(".data-wherehear").hide(),t.find(".data-wherehear").hide(),i.attended[localState.lang].length?(p="<strong>"+AppData.languages[localState.lang]["profile-attended"]+"</strong><ul>",i.attended[localState.lang].forEach((function(t){p+="<li>"+AppData.select_fields.ATTENDED[localState.lang][t]+"</li>"})),p+="</ul>",t.find(".data-prevyears").show(),t.find(".data-prevyears>span").html(p)):t.find(".data-prevyears").hide(),i.registrationday[localState.lang].length?(p="<strong>"+AppData.languages[localState.lang]["profile-attending"]+"</strong><ul>",i.registrationday[localState.lang].forEach((function(t){AppData.select_fields.REGISTRATIONDAY[localState.lang][t]&&(p+="<li>"+AppData.select_fields.REGISTRATIONDAY[localState.lang][t]+"</li>")})),p+="</ul>",t.find(".data-days").show(),t.find(".data-days>span").html(p)):t.find(".data-days").hide(),i.solutions[localState.lang].length?(p="<strong>"+AppData.languages[localState.lang]["profile-interests"]+'</strong><ul class="sortul">',i.solutions[localState.lang].sort(),i.solutions[localState.lang].forEach((function(t){AppData.select_fields.SOLUTIONS[localState.lang][t]&&(p+="<li>"+AppData.select_fields.SOLUTIONS[localState.lang][t]+"</li>")})),p+="</ul>",t.find(".data-interests").show(),t.find(".data-interests>span").html(p),sortListUl(".sortul")):t.find(".data-interests").hide(),t.find(".data-companyname").hide(),i.companytype[localState.lang].length&&""!=i.companytype[localState.lang]&&"0"!=i.companytype[localState.lang]?(p="<strong>"+AppData.languages[localState.lang]["profile-companytype"]+"</strong>",p+="<p>"+AppData.select_fields.COMPANY_ACTIVITY[localState.lang][i.companytype[localState.lang]]+"</p>",t.find(".data-companytype").show(),t.find(".data-companytype>span").html(p)):t.find(".data-companytype").hide(),t.find(".data-companyaddress").hide(),i.usercount[localState.lang]?(p="<strong>"+AppData.languages[localState.lang]["profile-usercount"]+"</strong>",p+="<p>"+AppData.select_fields.USER_COUNT[localState.lang][i.usercount[localState.lang].toString()]+"</p>",t.find(".data-usercount").show(),t.find(".data-usercount>span").html(p)):t.find(".data-usercount").hide(),t.find(".data-usercount").hide(),i.hostcount[localState.lang]?(p="<strong>"+AppData.languages[localState.lang]["profile-hostcount"]+"</strong>",p+="<p>"+AppData.select_fields.SERVER_COUNT[localState.lang][i.hostcount[localState.lang].toString()]+"</p>",t.find(".data-hostcount").show(),t.find(".data-hostcount>span").html(p)):t.find(".data-hostcount").hide(),t.find(".data-hostcount").hide(),t.find(".listing").toggleClass("hidden",!r&&!c),t.find(".social").toggleClass("hidden",!(u||f||h||m)),t.find(".favorite.save").toggleClass("hidden",l),t.find(".favorite.saved").toggleClass("hidden",!l),t.find(".favorite.cancel").toggleClass("hidden",!s),r=c=null;var g=AppData.navigation.find((function(t){return"chat"==t.module&&t.visible&&AppData.profile.id!=i.id}));g?$(".start_chat").parent().show():$(".start_chat").parent().hide(),a(i),d(),o()}}function r(){var t=$("#attendees-details");t.find(".favorite.save").addClass("hidden"),t.find(".favorite.saved").removeClass("hidden"),t.find(".favorite.cancel").removeClass("hidden"),$.post("api/",{do:"saveFavoriteAttendee",data:{id:localState.attendees.itemIndex||!1,lang:localState.lang}},(function(t){AppData.favorites=t,BookedAgenda.renderList(),Modal.resultconfirmation({canClose:!0,title:AppData.languages[localState.lang].businesscardrequest_title,text:AppData.languages[localState.lang].businesscardrequest_text}),t=null})),t=null}function c(){var t=$("#attendees-details"),e=AppData.favorites.find((function(t){return"attendee"===t.type&&t.data===localState.attendees.itemIndex}));t.find(".favorite.save").removeClass("hidden"),t.find(".favorite.saved").addClass("hidden"),t.find(".favorite.cancel").addClass("hidden"),$.post("api/",{do:"removeFavorite",data:e.id},(function(t){AppData.favorites=t,BookedAgenda.renderList(),t=null})),t=null}function p(){AppData.attendees.sort((function(t,e){return String(t.name[localState.lang]).localeCompare(String(e.name[localState.lang]))})),l(),i()}function g(t){var e=$("#attendees .search-wrapper .btn-clear"),a=$("#attendees .no-result"),n=$("#attendees .search-wrapper input").val(),l=n.split(" ").join("");new RegExp(strCanonical(l),"i"),new RegExp(strCanonical(l),"i");localState.attendees.search=n,requestAnimationFrame((function(){l.length>1?$.ajax({method:"post",url:"api/",data:{do:"searchAttendees",search:n.split(" "),lang:localState.lang},success:function(t){AppData.attendees=t,p(),e.toggle(Boolean(n.length)),a.toggle(!Boolean(t.length)),$("#attendees #attendeesList .load-more").hide(),e=a=n=l=null},error:function(t){console.log("error",t)}}):0===l.length&&e.trigger("click")}))}function u(){localState.attendees.itemIndex=String($(this).data("index"))||0,i(),writeDbLog("show attendee profile",localState.attendees.itemIndex,"user_logs","users"),Layout.show("attendees-details")}function f(){Chat.showChat("new_room",localState.attendees.itemIndex)}function h(t){t.preventDefault(),$("#attendees .search-wrapper input").val(""),localState.attendees.search="",$("#attendees .search-wrapper .btn-clear").hide(),$.post("api/",{do:"loadMoreAttendees",multipage:"true",lang:localState.lang,page:localState.attendees.page},(function(t){AppData.attendees=t.attendees,p(),0===t.count||t.count<=localState.attendees.page*e?$("#attendees #attendeesList .load-more").hide():$("#attendees #attendeesList .load-more").show(),$("#attendees .no-result").toggle(0===t.count)}))}function m(t){(t.wich||13===t.keyCode)&&this.blur()}function S(t){$.post("api/",{do:"saveBusinessCard",data:{id:t.target.dataset.id,lang:localState.lang}},(function(t){Modal.resultconfirmation({canClose:!0,title:AppData.languages[localState.lang].businesscardrequest_title,text:AppData.languages[localState.lang].businesscardrequest_text})}))}return localState.attendees=localState.attendees||{},localState.attendees.itemIndex=localState.attendees.itemIndex||0,localState.attendees.page=0,{Init:function(){t=$("template#tplAttendeesItem").remove().contents(),$(document).on("input","#attendees .search-wrapper input",g),$(document).on("keyup","#attendees .search-wrapper input",m),$(document).on("click","#attendees .search-wrapper .btn-clear",h),$(document).on("click","#attendees #attendeesList .item",u),$(document).on("click","#attendees #attendeesList .load-more",s),$(document).on("click","#attendees-details .attendees-card-request",S),$(document).on("click","#attendees-details .start_chat",f),$(document).on("click","#attendees-details .favorite.save",r),$(document).on("click","#attendees-details .favorite.cancel",c),$(document).on("click","#attendees-details .external-link",n),s()},evtClickDetails:u,renderList:l,showDetails:function(t){t&&(null!=localState.attendees?t===localState.attendees.itemIndex&&0!==localState.attendees.itemIndex||(localState.attendees.itemIndex=String(t),i()):localState.attendees={itemIndex:String(t)},Layout.show("attendees-details"))},BuildFromSource:function(){AppData.attendees=[],localState.attendees.page=0,s()},updateAvatar:function(t){$("#attendees [data-index='"+t.id+"'] .data-img").attr("src",t.img+"?r="+Math.random());let e=AppData.attendees.findIndex((function(e){return e.id==t.id}));if(e>-1){let a=t.img.split("/");AppData.attendees[e].img=a[a.length-1]}},updateUser:function(t){let e=AppData.attendees.findIndex((function(e){return e.id==t.id}));e>-1&&t.udata.length>0&&(AppData.attendees[e]=t.udata[0],p())},UpdateModule:p,toggleRequestBusinessCard:d,updateRequestBusinessCard:function(){$.post("api/",{do:"getFavorites"},(function(t){AppData.favorites=t,i(),t=null}))},toggleSocial:o}}();
var BookedAgenda=function(){"use strict";var t,a,e,n,o;function i(){Docs.showDetails(AppData.modulsettings.giftbagdocument)}function d(){$.post("api/",{do:"exportPdf"},(function(t){Modal.alert(Language.getItem("favorite-email-title"))}))}function l(){(AppData.agenda||[]).sort((function(t,a){return t.date==a.date?t.timeStart<a.timeStart?-1:t.timeStart>a.timeStart?1:0:t.date<a.date?-1:1})),r()}function r(){if(!1 in AppData||!(AppData.agenda||[]).length)return!1;var i=$("#booked-agenda #booked-agendaList"),d=$("#booked-agenda #booked-attendeeList"),l=$("#booked-agenda #booked-speakerList"),r=$("#booked-agenda #booked-sponsorList"),s=$("#booked-agenda #booked-docList"),c=(localState.agenda,$(document.createDocumentFragment())),m=AppData.agenda.filter((function(t){var a=AppData.profile.agenda_bookings.find((function(a){return a.agenda==t.id}));return!(!AppData.profile.favorite_agenda.find((function(a){return a.agenda==t.id}))&&!a)}));$.each(m,(function(a,e){var n=t.clone();!function(t,a){var e=AppData.translations.filter((function(t){return t.translation_id===localState.lang}))[0];t.toggleClass("now","now"===a.status),t.toggleClass("ended","ended"===a.status),t.toggleClass("breaking",!a.rooms&&!a.details),t.toggleClass("link",!!a.rooms||!!a.details),t.attr("data-id",a.id),t.find(".data-timeStart").text(makeTimeFormat(a.timeStart,e.time_format)),t.find(".data-timeEnd").text(makeTimeFormat(a.timeEnd,e.time_format));var n=AppData.days.find((function(t){return t.id==a.day}));n&&t.find(".data-day").html(n.name[localState.lang]);var o,i=AppData.channels.find((function(t){return t.channel===a.rooms}))||!1;t.find(".data-rooms").attr("data-room-id",a.rooms).text(i?i.name:"").parent().toggleClass("hidden",!i),o="string"==typeof a.title?a.title:a.title[localState.lang];t.find(".data-title").text(o),t.find("[data-lang=now]").text(Language.getItem("now")),t.find("[data-lang=expired]").text(Language.getItem("expired"))}(n,e),n.appendTo(c),n=null})),i.html(c),i=c=null,AppData.favorites.filter((function(t){return"attendee"==t.type})).length>0&&$.ajax({method:"post",url:"api/",data:{do:"getFavUsers"},success:function(t){var a=$(document.createDocumentFragment());$.each(t,(function(t,e){var n=e;if(void 0!==n){var i=o.clone();i.attr("data-id",n.id),i.find(".data-name").html(n.name[localState.lang]),i.find(".data-job").html(n.job[localState.lang]),i.find(".data-company").html(n.company[localState.lang]),n.img&&i.find(".data-img").attr(d.is(":visible")?"src":"data-src","upload/users/"+n.img),i.appendTo(a),i=null}})),d.html(a),d=a=null}});var p=$(document.createDocumentFragment());$.each(AppData.favorites,(function(t,e){var n=AppData.speakers.find((function(t){return t.id===e.data}));if(void 0!==n){var o=a.clone();o.attr("data-id",n.id),o.find(".data-name").html(n.name[localState.lang]),o.find(".data-job").html(n.job[localState.lang]),o.find(".data-company").html(n.company[localState.lang]),n.img&&o.find(".data-img").attr(l.is(":visible")?"src":"data-src","upload/users/"+n.img),o.appendTo(p),o=null}})),l.html(p),l=p=null;var g=$(document.createDocumentFragment());$.each(AppData.favorites,(function(t,a){var n=AppData.sponsors.find((function(t){return t.id===a.data}));if(void 0!==n){var o=e.clone();o.attr("data-id",n.id),o.find(".data-name").html(n.name[localState.lang]),n.file&&o.find(".data-img").attr(r.is(":visible")?"src":"data-src","upload/links/"+n.file.filename),o.appendTo(g),o=null}})),r.html(g),r=g=null;var f=$(document.createDocumentFragment());$.each(AppData.favorites,(function(t,a){var e=AppData.docs.find((function(t){return t.id===a.data}));if(void 0!==e){var o=n.clone();o.attr("data-id",e.id),o.find(".data-name").html(e.title[localState.lang]),o.appendTo(f),o=null}})),s.html(f),s=f=null}function s(){Attendees.showDetails(String($(this).data("id")))}function c(){Speakers.showDetails(String($(this).data("id")))}function m(){Sponsors.showDetails(String($(this).data("id")))}function p(){Docs.showDetails(String($(this).data("id")))}function g(){Agenda.showDetails(String($(this).data("id")))}return{Init:function(){t=$("template#tplBookedAgendaItem").remove().contents(),o=$("template#tplAttendeeFavorite").remove().contents(),a=$("template#tplSpeakerFavorite").remove().contents(),e=$("template#tplSponsorFavorite").remove().contents(),n=$("template#tplDocFavorite").remove().contents(),$(document).on("click","#booked-agenda #booked-attendeeList .item",s).on("click","#booked-agenda #booked-agendaList .item",g).on("click","#booked-agenda #booked-speakerList .item",c).on("click","#booked-agenda #booked-sponsorList .item",m).on("click","#booked-agenda #booked-docList .item",p).on("click","#booked-agenda .showgiftbag",i).on("click","#booked-agenda .export",d),l(),delete Agenda.Init},Build:l,BuildFromSource:function(){$.post("api/",{do:"getProfile"},(function(t){AppData.profile=t,r()}))},evtClickDetails:g,renderList:r}}();
var Bookings=function(){var o,t;let e;function n(){$("#bookings-details article").find("[type=submit]").removeClass("disabled")}function i(){var o="state-checked animated pulse",t=$(this).closest("label");"radio"===this.type&&$("#bookings .bookingsList .item .flex").removeClass(o),t.toggleClass(o,this.checked)}function a(o){o.preventDefault(),writeDbLog("booked",$(this).closest("form").find("[type=checkbox]:checked").val(),"user_logs","booking");var t=$(this).closest("form").serialize();t+="&do=saveBookingUser";$.ajax({url:"api/",data:t,method:"post",success:function(o){if(null!=o.error){var t=Language.getItem("bookings-full-error"),e=AppData.bookings.filter((function(t){return o.error.indexOf(t.id)>-1}));for(var n in e)t+='<div class="full_booking">'+e[n].name[localState.lang]+"</div>";Modal.alert(t)}else Modal.alert(Language.getItem("bookings-saved"));null!=o.bookings&&(AppData.bookings=o.bookings,AppData.userbookings=o.userbookings,Bookings.renderClient(localState.bookings.last_groupfilter)),Socket.Send("Bookings.BuildFromSourceClient",null,{client:"client"}),Socket.Send("Bookings.Modify",null,{client:"booking"})},error:function(o){console.log("Hiba: "+o)}})}function s(){return(new FormData).append("do","getUserBooking"),$.ajax({url:"api/",data:{do:"getUserBooking"},method:"post",async:!1,success:function(o){},error:function(o){console.log("Hiba: "+o)}})}function l(o,t){null==t&&(t=$(this).attr("data-tcroom")),Layout.hideAll(),openTrueConfCall(t,"workshop")}function r(){let o=$(this).attr("data-broadcast");Layout.hideAll(),Broadcast.showDetails(o)}function l(o,t){null==t&&(t=$(this).attr("data-tcroom")),-1!=t.indexOf("rentit.hu")?(Layout.hideAll(),openTrueConfCall(t,"workshop")):window.open(t)}function d(t){var e=$("#bookings-details .bookingsList"),n=$(document.createDocumentFragment()),i=s();AppData.bookings.sort((function(o,t){return void 0!==o.sort_id&&void 0!==t.sort_id?parseInt(o.sort_id)>parseInt(t.sort_id)?1:-1:0})),void 0===t&&void 0!==localState.bookings.last_groupfilter&&(t=localState.bookings.last_groupfilter),localState.bookings.last_groupfilter=t;var a=AppData.bookings.filter((function(o){return void 0!==localState.bookings.itemIndex&&""!==localState.bookings.itemIndex?o.id===localState.bookings.itemIndex:!0===o.active}));if(null!=t)if(1==t.length){var l=AppData.bookinggroups.find((function(o){return o.id==t[0]}));$("#bookings-details .header-secondary .data-label").html(l.title[localState.lang])}else $("#bookings-details .header-secondary .data-label").html("");var r=void 0===i.responseText?[]:JSON.parse(i.responseText);$.each(a,(function(e,i){var a=o.clone();if(a.attr("data-group",i.group),a.find(".data-title").html(i.name[localState.lang]),a.find("[type=submit] span").html(Language.getItem("save")),i.limit>0){let o=i.limit-i.participant;o<0&&(o=0),a.find(".data-title").append("<br>"+Language.getItem("free-bookings")+": "+o)}a.find(".buttons").attr("data-bid",i.id),a.find(".buttons .join-tcroom").html(Language.getItem("join-room")).addClass("hidden"),a.find(".buttons .watch-stream").html(Language.getItem("watch-stream")).addClass("hidden"),a.find("input").val(i.id),a.appendTo(n);var s=r.find((function(o){return o.booking_id==i.id}));(i.broadcast&&a.find(".buttons .watch-stream").attr("data-broadcast",i.broadcast).removeClass("hidden"),AppData.modulsettings.save_button_rows&&a.find(".save-bookings").removeClass("hidden"),null!=s)?(a.find("input").closest("label").toggleClass("state-checked animated pulse",this.checked),a.find("input").prop("checked",!0),i.link&&a.find(".buttons .join-tcroom").attr("data-tcroom",i.link).removeClass("hidden")):a.find(".buttons .join-tcroom").remove();null==t||t.indexOf(i.group)>-1?a.removeClass("hidden"):a.addClass("hidden")})),e.html(n),$("#bookings").find(".no-result").toggle(Boolean(!AppData.bookings.length)),$("#bookings article").find(".bookingsList").show()}function g(o){if(o)if(""===o)localState.bookings.itemIndex="",d(),Layout.show("bookings-details");else if("all_groups"===o)c(),Layout.show("bookings");else{if(null!=AppData.bookings.find((function(t){return o==t.id})))null!=localState.bookings?(o!==localState.bookings.itemIndex||0===localState.bookings.itemIndex?(localState.bookings.itemIndex=String(o),d(localState.bookings.last_groupfilter)):d(),Layout.show("bookings-details")):(localState.bookings={itemIndex:String(o)},Layout.show("bookings-details"));else{var t=AppData.bookinggroups.find((function(t){return o==t.id}));null!=t&&(localState.bookings.itemIndex="",localState.bookings.last_groupfilter=[t.id],d([t.id]))}Layout.show("bookings-details")}}function c(){let o=$("#bookings .bookingsGroupList"),e=$(document.createDocumentFragment());$.each(AppData.bookinggroups,(function(o,n){var i=t.clone();i.attr("data-id",n.id),i.find(".data-name").html(n.title[localState.lang]),i.appendTo(e)})),o.html(e)}function u(){$.post("api/",{do:"getBookings"},(function(o){AppData.bookings=o.bookings,AppData.bookinggroups=o.bookinggroups,c(),Bookings.renderClient(e),o=null,k()}))}function k(){$.post("api/",{do:"getBookingsForUser"},(function(o){AppData.userbookings=o,o=null,Agenda.BuildFromSource()}))}return{Init:function(){o=$("template#tplBookingsItem").contents().remove(),t=$("template#tplBookingsGroupItem").contents().remove(),null==localState.bookings&&(localState.bookings={itemIndex:0,last_groupfilter:void 0}),c(),d(localState.bookings.last_groupfilter),$(document).on("click","#bookings-details .item .save-bookings",a).on("change","#bookings-details form input",n).on("show","#bookings-details",u).on("click","#bookings-details .join-tcroom",l).on("click","#bookings-details .watch-stream",r).on("change","#bookings-details input[type=checkbox]",i).on("click","#bookings .bookingsGroupList .item",(function(){g($(this).attr("data-id"))}))},renderClient:d,showDetails:g,BuildFromSourceClient:u,getAjaxUserBooking:s,getUserBookings:k,joinTcRoom:l}}();
var Broadcast=function(){var t,a,e={settings:{}},n=new wowzawebrtc;let o;function s(){t=$("template#tplBroadcastItem").contents(),b(),void 0===localState.currentBroadcast&&(localState.currentBroadcast=""),r(),videojs("my-video",{html5:{dash:{liveDelay:2}}}).ready((function(){let t=this;t.on("fullscreenchange",(function(){t.isFullscreen()&&AppData.modulsettings.attentionchecker&&t.exitFullscreen()})),t.on("pause",(function(){$("#playerElement").find(".vjs-big-play-button").removeClass("vjs-hidden").show()})),t.on("play",(function(){$("#playerElement").find(".vjs-big-play-button").hide()})),t.on("canplay",(function(){j()}))})),a=!1,"speaker"!==AppData.profile.group&&"director"!==AppData.profile.group&&1!==$("#landing").find("#playerElement:visible").length&&AppData.modulsettings.showonstart&&(Broadcast.showDetails(AppData.modulsettings.showonstreamurl),0!==localState.layout.length&&i())}function i(){T(),E(),$("#landing .landing_elements .broadcast_showmsgboard_btn").hide(),$("#landing .landing_elements .videostream .reactions").hide(),$(".videostream").appendTo($("body")),$(".videostream").addClass("min")}function r(){if(void 0!==AppData.modulsettings.runawayBackground&&""!==AppData.modulsettings.runawayBackground){var t=AppData.medias.filter((function(t){return t.id===AppData.modulsettings.runawayBackground}))[0];$(".videostream #runawaycover").css("background-image",'url("'+t.files[localState.lang].file+'")')}else $(".videostream #runawaycover").css("background-image","none")}function l(){writeDbLog("stop","","user_logs","broadcast"),d(),m(),Soundchannels.stopWebRTC(),A(),$("#default_nav.floating").removeClass("higher"),$(".videostream").appendTo($(".videostream").parent()),localState.currentBroadcast="",localState.currentBroadcastType="",$("#broadcastList").find(".item").removeClass("color-primary")}function d(){videojs("my-video").reset(),1===$("#playerElement:visible").length&&($("#playerElement").hide(),$(".videostream").hide(),$(".stream_reactions").addClass("hidden"),Layout.setMainSizes(),AppData.modulsettings.showredalert&&($("#landing").find(".open-main.broadcast").removeClass("color-primary").addClass("blinkingicon"),$("#landing").find(".open-main.broadcast").css("color",AppData.settings.colorPrimary)))}function c(t=""){l();var a=AppData.broadcast.filter((function(a){return a.id==t}))[0];writeDbLog("start WebRTC",t,"user_logs","broadcast"),a&&(e={settings:{playSdpURL:a.realtimeserversignalingurl,playApplicationName:a.realtimestreamurl,playStreamName:a.realtimeserverstreamid}},u(v,h,f),Navigation.hideMenu(),localState.currentBroadcast=t,localState.currentBroadcastVideoType="realtime",b())}const u=(t,a,o)=>{p(e.settings),n.on({onError:t,onStateChanged:t=>{console.log("state.connectionState",t.connectionState),"connected"===t.connectionState?(console.log("connected in"),a()):(o(),console.log("stopped in"))}}),n.set({videoElementPlay:document.getElementById("my-video23")})},p=t=>{g(t).then((()=>{n.play(),$(".videostream").show(),$("#playerElement").hide(),$("#playerElement2").show(),$("#my-video23").show()}))},m=()=>{null!=n.wowzaPeerConnectionPlay&&n.stop(),$(".videostream").hide(),$(".stream_reactions").addClass("hidden"),$("#playerElement2").hide()},g=t=>{e.settings=t;let a={};for(let e in t){let n=e.substring(4);n=n[0].toLowerCase()+n.slice(1),a[n]=t[e]}return n.set(a)},h=()=>{e.playing=!0},f=()=>{e.playing=!1},v=t=>{let a;a=t.message?t.message:t,alert(a)};function b(){var a,e=$(document.createDocumentFragment()),n=t.clone();n.attr("data-id","turnoffvideo"),n.find(".data-name").text(Language.getItem("broadcast-turnoff")).attr("data-id","turnoffvideo"),n.appendTo(e),AppData.broadcast.sort((function(t,a){return void 0!==t.sort_id&&void 0!==a.sort_id?parseInt(t.sort_id)>parseInt(a.sort_id)?1:-1:0})),$.each(AppData.broadcast,(function(o,s){a=!0===AppData.modulsettings.showchoosingplaylisttousers&&null!=s.realtimestreamurl&&""!=s.realtimestreamurl,null!=s.visible&&s.visible&&((n=t.clone()).attr("data-id",s.id).attr("data-streamurl",s.streamurl).attr("data-playertype","hls"),n.find(".data-name").html(s.name[localState.lang]+(a?" (HLS)":"")).attr("data-playertype","hls").attr("data-id",s.id).attr("data-streamurl",s.streamurl),localState.currentBroadcast===s.id&&"hls"===localState.currentBroadcastVideoType&&n.addClass("color-primary"),n.appendTo(e),a&&((n=t.clone()).attr("data-playertype","realtime").attr("data-id",s.id).attr("data-streamurl",s.streamurl),n.find(".data-name").text(s.name[localState.lang]+" (Realtime)").attr("data-playertype","realtime").attr("data-id",s.id).attr("data-streamurl",s.streamurl),localState.currentBroadcast===s.id&&"realtime"===localState.currentBroadcastVideoType&&n.addClass("color-primary"),n.appendTo(e)))})),$("#broadcast #broadcastList").html(e)}function y(t){localState.currentBroadcast=t,b(),"realtime"===AppData.modulsettings.videoplayertype?c(t):_(t)}function w(t){l();var a="";if(void 0!==t){if(localState.currentBroadcast="I"==t.target.tagName?t.target.nextSibling.nextSibling.dataset.id:"DIV"==t.target.tagName?t.target.children[1].dataset.id:t.target.dataset.id,localState.currentBroadcastVideoType="hls","turnoffvideo"==localState.currentBroadcast)return $("#default_nav").find("[data-target='broadcast']").css("border",""),void l();a=t.target.dataset.streamurl,b()}else{var e=AppData.broadcast.filter((function(t){return!0===t.visible}));if(1===e.length)localState.currentBroadcast=a=e[0].streamurl;else{var n=AppData.broadcast.filter((function(t){return t.id===AppData.modulsettings.showonstreamurl}));0!==n.length&&n[0].visible&&(localState.currentBroadcast=a=n[0].streamurl)}}""!=a&&(_(a),Navigation.hideMenu())}function _(t){let a=AppData.broadcast.find((function(a){return a.streamurl==t}));writeDbLog("start",void 0!==a?a.id:t,"user_logs","broadcast");let e="";a&&(Channels.setChannel(a.channel),null==localState.broadcast&&(localState.broadcast={itemIndex:0}),localState.broadcast.itemIndex=a.id,a.secure&&(e=a.secure_url));var n=videojs("my-video");if(a.loop?n.loop(!0):n.loop(!1),n.reset(),AppData.modulsettings.showBroadcastThumbnail&&void 0!==AppData.modulsettings.broadcastThumbnail&&""!==AppData.modulsettings.broadcastThumbnail){var o=AppData.medias.filter((function(t){return t.id===AppData.modulsettings.broadcastThumbnail}))[0];n.poster(o.files[localState.lang].file)}else n.poster("");let s=t+"?siteid="+AppData.settings.site_id+"&uid="+AppData.profile.id+e;if(a.use_load_balancer){var i=new XMLHttpRequest;i.open("GET",t,!0),i.onload=function(){s=i.responseURL+"?siteid="+AppData.settings.site_id+"&uid="+AppData.profile.id+e,n.reset(),n.src(s),n.load(),n.play()},i.send()}else n.reset(),n.src(s),n.load(),n.play(),$(".stream").show(),$("#playerElement").show(),$(".videostream").show();$(".stream").show(),$("#playerElement").show(),$(".videostream").show(),AppData.modulsettings.show_emoji_reactions?$(".stream_reactions").removeClass("hidden"):$(".stream_reactions").addClass("hidden"),logVideoWatch("start_watching",t+"?siteid="+AppData.settings.site_id+"&uid="+AppData.profile.id),$("#default_nav.floating").addClass("higher"),AppData.modulsettings.attentionchecker?($("#playerElement .vjs-fullscreen-control").hide(),$("#playerElement2 .vjs-fullscreen-control").hide(),D()):($("#playerElement .vjs-fullscreen-control").show(),$("#playerElement2 .vjs-fullscreen-control").show()),S(),C(),B(),j()}function D(){let t=parseInt(AppData.modulsettings.attentionchecker_min),a=parseInt(AppData.modulsettings.attentionchecker_max);isNaN(t)&&(t=10),isNaN(a)&&(a=30),t*=1e3,a*=1e3,AppData.modulsettings.attentionchecker_test||(t*=60,a*=60);let e=Math.floor(Math.random()*(a-t+1))+t;o=setTimeout((function(){console.log("shown"),$(".attention_btn").remove();let t=$("<button/>").addClass("btn attention_btn").html('<i class="fas fa-eye"></i>&nbsp;'+Language.getItem("attention-btn"));t.appendTo($("body"));let a=t.outerWidth(),e=t.outerHeight(),n=Math.floor(Math.random()*($(window).width()-a-0+1))+0,o=Math.floor(Math.random()*($(window).height()-e-0+1))+0;t.css({top:o,left:n}),t.on("click",(function(){$.ajax({url:"api/",method:"post",data:{do:"saveAttentionData",action_type:"CLICKED",broadcast_id:localState.currentBroadcast},complete:function(a){t.remove()}})})),$.ajax({url:"api/",method:"post",data:{do:"saveAttentionData",action_type:"SHOWN",broadcast_id:localState.currentBroadcast},complete:function(a){AppData.modulsettings.attentionchecker&&D();let e=parseInt(AppData.modulsettings.attentionchecker_hide);isNaN(e)&&(e=0),e>0&&setTimeout((function(){t.remove()}),1e3*e)}})}),e)}function A(){$("#playerElement .vjs-fullscreen-control").show(),$("#playerElement2 .vjs-fullscreen-control").show(),$(".attention_btn").remove(),clearTimeout(o)}function S(){AppData.modulsettings.allowreactions?$("#landing .landing_elements .videostream .reactions").show():$("#landing .landing_elements .videostream .reactions").hide()}function B(){AppData.modulsettings.showchatbutton?$("#landing .landing_elements .broadcast_showmsgboard_btn").show():$("#landing .landing_elements .broadcast_showmsgboard_btn").hide()}function C(){AppData.modulsettings.showtransbutton?$("#landing .landing_elements .videostream .translator_btn").show():$("#landing .landing_elements .videostream .translator_btn").hide()}function T(){$("#landing .landing_elements .videostream .translator_btn").hide()}function E(){$("#landing .landing_elements .closebroadcast_btn").hide()}function k(){$("#landing .landing_elements .closebroadcast_btn").show()}function j(){if(AppData.modulsettings.available_captions&&""!=AppData.modulsettings.available_captions){let t=AppData.modulsettings.available_captions.split(",");$("#playerElement .vjs-subs-caps-button").show();let a=videojs("my-video").remoteTextTracks(),e=$("#playerElement .vjs-subs-caps-button .vjs-subtitles-menu-item");e.hide();for(let n=0;n<a.length;n++){let o=a[n].id;for(let s=0;s<e.length;s++){let i=$(e[s]).find(".vjs-menu-item-text");if(t.indexOf(a[n].language)>-1&&i.html()==o){i.parent().show();break}}}}else $("#playerElement .vjs-subs-caps-button").hide()}return $(document).on("click","#broadcastList .item",(function(t){"realtime"===(!0===AppData.modulsettings.showchoosingplaylisttousers?$(this).attr("data-playertype"):AppData.modulsettings.videoplayertype)?c($(this).attr("data-id")):w(t),Layout.hide("broadcast")})),$(document).on("click","#landing .landing_elements .reactions .reaction",(function(t){let a=$(this).attr("data-icon"),e=$(this).attr("data-color"),n=$(this);$(this).addClass("clicked"),setTimeout((function(){n.removeClass("clicked")}),150),Socket.Send("sendReaction",{uid:AppData.profile.id,type:a,color:e},{client:"audience"})})),$(document).on("click","#landing .landing_elements .closebroadcast_btn",(function(t){$("#default_nav").find("[data-target='broadcast']").css("border",""),l(),a=!1})),$(document).on("click","#landing .countdown_bc .bc_button .open-broadcast",(function(){AppData.modulsettings.bc_landingbutton_target&&$("#default_nav [data-target='broadcast'][data-id='"+AppData.modulsettings.bc_landingbutton_target+"']").trigger("mouseup")})),{Init:s,BuildFromSource:function(){$.post("api/",{do:"getBroadcast"},(function(t){AppData.broadcast=t,s()}))},playVideoStream:function(t){let a=AppData.broadcast.find((function(a){return a.id==t.streamId}));t.pushed&&trueconf_opened||_(a.streamurl)},stopVideoStream:l,BuildBroadcast:b,playStreamByClick:w,playStreamByURL:y,playHLS:function(t){let a=AppData.broadcast.find((function(a){return a.id==t.streamId}));l(),localState.currentBroadcast=t.streamId,_(a.streamurl),Navigation.hideMenu()},stopVideoStreamHLS:d,playWebRTCStream:c,showDetails:function(t){if(t){var e=AppData.broadcast.filter((function(a){return a.id==t}));null!=localState.broadcast?e===localState.broadcast.itemIndex&&0!==localState.broadcast.itemIndex||(localState.broadcast.itemIndex=String(e)):localState.broadcast={itemIndex:String(e)},a?(l(),a=!1):("realtime"===AppData.modulsettings.videoplayertype?c(t):y(e[0].streamurl),a=!0)}},setRunawayDatas:r,showRunaway:function(){var t=$("#my-video_html5_api").get(0);null!=t&&(t.paused||1===$(".videostream #runawaycover:visible").length?t.paused&&1===$(".videostream #runawaycover:visible").length&&($(".videostream #runawaycover").on("animationend animationcancel",(function(t){(t.target||t.originalEvent.target)===this&&$("#runawaycover").off("animationend animationcancel").removeClass("animated faster fadeOutRight").hide()})).removeClass("animated faster fadeInRight").addClass("animated faster fadeOutRight"),t.paused&&t.play()):($(".videostream #runawaycover").removeClass("animated faster fadeOutRight").addClass("animated faster fadeInRight").show(),t.paused||t.pause()))},setBroadcastPoster:function(){var t=videojs("my-video");if(AppData.modulsettings.showBroadcastThumbnail&&void 0!==AppData.modulsettings.broadcastThumbnail&&""!==AppData.modulsettings.broadcastThumbnail){var a=AppData.medias.filter((function(t){return t.id===AppData.modulsettings.broadcastThumbnail}))[0];t.poster(a.files[localState.lang].file)}else t.poster("")},disableAttentionGuard:A,enableAttentionGuard:function(){$("#playerElement .vjs-fullscreen-control").hide(),$("#playerElement2 .vjs-fullscreen-control").hide(),clearTimeout(o);var t=videojs("my-video");t.isFullscreen()&&t.exitFullscreen(),1!==$("#playerElement:visible").length&&1!==$("#playerElement2:visible").length||D()},showReactions:S,showTranslator:C,showChatButton:B,hideTranslator:T,hideClose:E,showClose:k,showTexttracks:j,minifyPlayer:i,restorePlayer:function(){$(".videostream").removeClass("min"),C(),B(),k(),S()}}}();
var Camerastream=function(){var e=new wowzawebrtcpublish;let t;var i,a=!1,n=!1;function s(){}const o=(i,n,s,o)=>{e.on({gotDevices:()=>{a||(a=!0,d())},onStateChanged:e=>{console.log("WowzaWebRTCPublish.onStateChanged"),console.log(e),"connected"===e.connectionState?i():"failed"===e.connectionState?n():s()},onCameraChanged:e=>{if(e!==t.selectedCam){t.selectedCam=e;let i="CameraMobile_"+e;"screen"===e&&(i="screen_screen")}},onMicrophoneChanged:e=>{e!==t.selectedMic&&(t.selectedMic=e)},onError:o}),e.set({videoElementPublish:$("#camerastream #cameraStreamVideo"),useSoundMeter:!1,videoEnabled:!0,constraints:{video:{width:320,height:240}}})},r=i=>(t.settings=i,e.set(i)),d=()=>{(()=>{if(""===t.settings.sdpURL)throw"No stream configured.";if(""===t.settings.applicationName)throw"Missing application name.";if(""===t.settings.streamName)throw"Missing stream name.";return!0})()&&(e.start(),n=!0,$('.open-main[data-target="camerastream"]').addClass("red"),Modal.alert("Camera started."))},l=t=>{e.stop(),n=!1,$('.open-main[data-target="camerastream"]').removeClass("red"),t||Modal.alert("Camera stopped.")},c=t=>{let i;"OverconstrainedError"==t.name?(i="Your browser or camera does not support this frame size",(t=>{let i=JSON.parse(JSON.stringify(e.getState().constraints));"default"===t?(i.video.width={min:"640",ideal:"1280",max:"1920"},i.video.height={min:"360",ideal:"720",max:"1080"}):(i.video.width={exact:t[0]},i.video.height={exact:t[1]}),e.set({constraints:i})})("default")):i=t.message?t.message:t,console.log(i),Modal.alert(i),l(!0)},m=e=>{e?(t.pendingPublish=!0,t.pendingPublishTimeout=setTimeout((()=>{l(),c({message:"Publish failed. Unable to connect."}),m(!1)}),1e4)):(t.pendingPublish=!1,null!=t.pendingPublishTimeout&&(clearTimeout(t.pendingPublishTimeout),t.pendingPublishTimeout=void 0))},u=()=>{t.publishing=!0,m(!1)},g=()=>{m(!1),u(),c({message:"Peer connection failed."})},p=()=>{t.pendingPublish||(t.publishing=!1)};return{Init:s,BuildFromSource:function(){$.post("api/",{do:"getTranslator"},(function(e){AppData.translator=e}))},showDetails:function(e){},startStream:function(){n||(i=AppData.profile.id,t={publishing:!1,pendingPublish:!1,pendingPublishTimeout:void 0,muted:!1,video:!0,selectedCam:"",selectedMic:"",settings:{sdpURL:"wss://streaming2.rentit.hu/webrtc-session.json",applicationName:"webrtc",streamName:"rca_client_"+i+"_"+AppData.settings.site_id,audioBitrate:"64",audioCodec:"opus",videoBitrate:"800",videoCodec:"42e01f",videoFrameRate:"8",frameSize:"default"}},a?(r(t.settings),d()):(o(u,g,p,c),r(t.settings)))},stopStream:function(){n&&l()}}}();
var CatchIt=function(){this.showboxes,this.speed=800,this.tl,this.game_over=!1,this.score=0,this.intval,this.prev_wrong=0,this.itemSpeed=6,this.items,this.saving=!1,this.container,this.timer,this.game_started=!1,this.wrong_count=0,this.catcher,this.puff;var t=this;this.init=function(){t.game_started=!1,t.container=$("#catchit_game_area"),t.catcher=$("#catcher"),t.items=[],t.puff=$("#puff_anim").contents(),$("#puff_anim").remove();let e,n,i=AppData.medias.filter((function(t){return 1==t.in_catchit}));for(let e in i)null!=i[e].files[localState.lang]&&(t.items.push({pic:i[e].files[localState.lang].file,points:i[e].catchit_point,class:i[e].catchit_point>0?"right":"wrong"}),i[e].catchit_point<0&&t.wrong_count++);for(var a in t.items.sort((function(t,e){return parseInt(t.points)-parseInt(e.points)})),t.items){(new Image).src=t.items[a].pic}$(".start_content",t.container).show(),t.timer=new timer,$(".start_btn",t.container).on("mouseup touchend",(function(e){if(e.preventDefault(),!t.game_started){t.game_started=!0,t.score=0,t.prev_wrong=0;let e=AppData.modulsettings.catchit_time||60;t.timer.init($(".timer span",t.container),e,"catch_it.times_up"),t.timer.stop(),t.timer.start(),t.game_over=!1,$(".collect .points",t.container).html(t.score),$(".rules").fadeOut(400),$(".start_content",t.container).fadeOut(400,(function(){$(".catchit_cont",t.container).fadeIn(400)})),t.start()}}));let r=!1;$(document).on("keydown",(function(e){if(!r&&t.game_started){let i="+=50",a="right";switch(r=!0,e.which){case 37:i="-=50",a="left";break;case 39:i="+=50",a="right";break;default:return}e.preventDefault(),clearInterval(n),n=setInterval((function(){t.moveTruck(i,a)}),100)}})),$(document).on("keyup",(function(){clearInterval(n),r=!1})),$(document).on("mousedown touchstart",".control_arrow",(function(n){n.preventDefault();let i=$(this).attr("data-dir"),a="right"==i?"+=50":"-=50";clearInterval(e),e=setInterval((function(){t.moveTruck(a,i)}),100)})),$(document).on("mouseup touchend",".control_arrow",(function(t){t.preventDefault(),clearInterval(e)})),$(window).on("blur",(function(){gsap.killTweensOf(t.catcher),clearInterval(e)})),$(document).on("focus",(function(){gsap.killTweensOf(t.catcher),clearInterval(e)})),$(document).on("blur",(function(){gsap.killTweensOf(t.catcher),clearInterval(e)})),$(document).on("catch_it.times_up",t.timesUp)},this.moveTruck=function(e,n){$("#catcher .truck").css({transform:"rotateY("+("right"==n?180:0)+"deg)"}),gsap.killTweensOf(t.catcher),gsap.to(t.catcher,{duration:.1,x:e,ease:"none",rotateY:"right"==n?180:0,modifiers:{x:function(e){return gsap.utils.clamp(0,$(window).width()-t.catcher.width(),parseInt(e))+"px"}}})},this.spawnObject=function(){t.timer.act_time<50&&(t.itemSpeed=5),t.timer.act_time<30&&(t.itemSpeed=4),t.timer.act_time<20&&(t.itemSpeed=3);var e=randInt(0,t.items.length-1);t.items[e].points<0&&t.prev_wrong++,t.prev_wrong%4==0&&(e=randInt(t.wrong_count,t.items.length-1));var n=$("<img/>").attr("src",t.items[e].pic).css({top:-200,left:randInt(0,$(window).width()-300)}).addClass("clickable falling").attr("data-points",t.items[e].points).addClass(t.items[e].class);$(".fall_container",t.container).append(n),gsap.to(n,{duration:t.itemSpeed,y:$(window).height()+200,ease:Linear.easeNone,onComplete:function(){$(this.targets()[0]).remove()},onUpdate:function(){if(Draggable.hitTest($(this.targets()[0]),"#catcher",20)){t.increaseScore($(this.targets()[0]).attr("data-points"));let e=t.puff.clone();e.css({top:$("#catcher").position().top-10,left:$(this.targets()[0]).position().left+$(this.targets()[0]).width()/2}),$(this.targets()[0]).attr("data-points")<0&&$("div",e).css({background:"#555555"}),e.appendTo($(".fall_container",t.container)),setTimeout((function(){e.remove()}),1e3),$(this.targets()[0]).remove()}}}),t.intval=setTimeout((function(){t.spawnObject()}),t.speed)},this.increaseScore=function(e){t.score=parseInt(t.score)+parseInt(e),$(".collect .points",t.container).html(t.score)},this.start=function(){t.intval=setTimeout((function(){t.spawnObject()}),t.speed)},this.timesUp=function(){clearInterval(t.intval),$(".fall_container",t.container).empty(),$("#catchit .final_score").html(t.score),$("#catchit .final_content").fadeIn(),t.saving||(t.saving=!0,$.ajax({url:"api/",method:"post",data:{do:"saveCatchit",score:t.score},success:function(e){t.saving=!1,setTimeout((function(){t.hideGame()}),5e3)}}))},this.hideGame=function(){$(".fall_container",t.container).empty(),$("#catchit .final_content").hide(),$(".start_content",t.container).show(),t.game_started=!1,t.itemSpeed=6,clearInterval(t.intval),t.timer.timerobj&&t.timer.stop()}};let catchit_game;function startCatchit(){catchit_game=new CatchIt,catchit_game.init()}function shuffle(t){var e,n,i;for(i=t.length;i;i--)e=Math.floor(Math.random()*i),n=t[i-1],t[i-1]=t[e],t[e]=n}function randInt(t,e){return Math.floor(Math.random()*(e-t+1))+t}
var Channels=function(){"use strict";var n;function e(){AppData.channels.sort((function(n,e){return parseInt(n.sort_id)-parseInt(e.sort_id)}));var e=$(document.createDocumentFragment());$.each(AppData.channels,(function(a,t){if(t.active&&t.name){var l=n.clone();l.find(".data-id").text(t.channel),l.find(".data-name").text(t.name[localState.lang]),l.attr("data-channel",t.channel),localState.currentChannel===t.channel&&l.addClass("color-primary"),l.appendTo(e)}})),$("#channels #channelList").html(e)}return $(document).on("click","#channelList .item",(function(n){var e=$(this);localState.currentChannel=e.data("channel"),localState.currentChannel in(AppData.presentations||[])?(Presentation.source(AppData.presentations[localState.currentChannel]),SpeakerPresentation.source(AppData.presentations[localState.currentChannel]),AppData.modulsettings.presentation_showtospeaker&&SpeakerPresentation.show()):(Presentation.source(""),SpeakerPresentation.source("")),n.originalEvent&&(localStorage.setItem("rca4_current_channel",e.data("channel")),Socket.Send("Channels.advertise",localState.currentChannel)),e.addClass("color-primary").siblings().removeClass("color-primary"),$("#channels").find(".close-main").removeClass("disabled")})),{Init:function(){n=$("template#tplChannelItem").remove().contents(),e(),"currentChannel"in localState&&null!=localState.currentChannel&&"undefined"!=localState.currentChannel&&localStorage.setItem("rca4_current_channel",localState.currentChannel),localState.currentChannel=localStorage.getItem("rca4_current_channel")||["ch0"],$("#channelList [data-channel="+localState.currentChannel+"]").trigger("click"),delete Channels.Init},update:function(){$.post("api/",{do:"getChannels"},(function(n){AppData.channels=n,e(),n=null}))},setChannel:function(n){localState.currentChannel=n,localStorage.setItem("rca4_current_channel",n),Socket.Send("Channels.advertise",n),e()}}}();
var Chat=function(){"use strict";var a,t,e,s;let o=[];function d(){AppData.chatrooms.sort((function(a,t){return void 0===a.last_message&&(a.last_message=0),void 0===t.last_message&&(t.last_message=0),t.last_message-a.last_message}))}function i(){var a=$("#chat-details [name='room_id']").val();Modal.confirm(Language.getItem("delete-chat"),(function(){$.ajax({method:"post",url:"api/",data:{do:"deleteChat",chat_id:a},success:function(t){Layout.hide("chat-details"),Layout.show("chat"),D();for(let e=0;e<t.users.length;e++)AppData.profile.id!=t.users[e]&&Socket.Send("Chat.roomDeleted",a,{uid:t.users[e]})}})}))}function n(){writeDbLog("video chat started","","user_logs","chat");var a=$("#chat-details [name='room_id']").val();$.ajax({method:"post",url:"api/",data:{do:"createTrueConfChatRoom",chat_id:a,server:"chat"},success:function(t){if(openTrueConfCall(t.room_id,"chat"),null!=t.rooms&&null!=t.msg){AppData.chatrooms=t.rooms;var e=AppData.chatrooms.find((function(t){return t.id==a}));if(e)for(var s in v(t.msg),t.msg.scroll=!0,e.users)Socket.Send("Chat.BuildFromSource",null,{uid:e.users[s]}),Socket.Send("Chat.appendMessage",t.msg,{uid:e.users[s]})}}})}function r(){"floating"==AppData.settings.homeScreen?$(".add_user_to_room .add_user_to_room_inner").addClass("floating"):$(".add_user_to_room .add_user_to_room_inner").removeClass("floating"),$(".add_user_to_room").fadeIn(400)}function l(){$(".add_user_to_room").fadeOut(400,(function(){$(".add_user_to_room .searchadd-wrapper .btn-clear").trigger("click")}))}function c(t){var e=$("#chat #chatList"),s=$(document.createDocumentFragment()),o=[];$("#chat #chatList .item.badge").each((function(){o.push($(this).attr("data-roomid"))}));var d=0;$.each(AppData.chatrooms,(function(e,i){var n=a.clone();n.attr("data-roomid",i.id),n.addClass("started");var r=[];for(var l in i.users)if(i.users[l]!=AppData.profile.id){var c=AppData.chatusers.find((function(a){return a.id==i.users[l]}));c&&r.push(c.name[localState.lang])}n.find(".data-name").append(r.join(", ")),""!=i.last_message_text&&n.find(".data-info").html(i.last_message_text),n.appendTo(s),(o.indexOf(i.id)>-1||t&&(o.indexOf(i.id)>-1||localState.chat.lastMsgRead[i.id]/1e3<i.last_message||$.isEmptyObject(localState.chat.lastMsgRead)&&i.last_message>0||null==localState.chat.lastMsgRead[i.id]&&i.last_message>0)&&i.last_message!=i.sent_message)&&(n.addClass("badge"),$('#landing [data-target="chat"]').addClass("badge")),0==i.last_message&&0==i.sent_message||d++})),e.html(s),$("#chat .no-result").toggle(0==d),AppData.modulsettings.chat_allowed_only&&0==AppData.profile.chat_allowed?($("#chat .search-wrapper").addClass("hidden"),$("#chat .more-cont").addClass("hidden")):($("#chat .search-wrapper").removeClass("hidden"),$("#chat .more-cont").removeClass("hidden"))}function h(){var t=$("#chat #chatUsersList"),e=$(document.createDocumentFragment());$.each(o,(function(s,o){let d=AppData.chatrooms.find((function(a){return a.users.indexOf(o.id)>-1}));if(o.id!=AppData.profile.id&&null==d){var i=a.clone(),n=[];o.job[localState.lang]&&n.push(o.job[localState.lang]),o.company[localState.lang]&&n.push(o.company[localState.lang]),i.attr("data-index",o.id),i.find(".data-name").html(o.name[localState.lang]),i.find(".data-info").html(Language.getItem("start-conversation")),o.img?i.find(".data-img").attr(t.is(":visible")?"src":"data-src","upload/users/"+o.img):i.find(".data-img").attr("src","img/profile-picture-placeholder.png"),i.appendTo(e)}}));let s=$("<div/>").addClass("more-cont");$("<button/>").addClass("btn load-more").html(Language.getItem("load-more")).appendTo(s),s.appendTo(e),t.html(e)}function m(){$("#chat #chatUsersList .load-more").addClass("disabled").prop("disabled",!0),$.ajax({method:"post",url:"api/",data:{do:"loadMoreChatUsers",page:localState.chat.page,lang:localState.lang,started:0},success:function(a){$("#chat #chatUsersList .load-more").removeClass("disabled").prop("disabled",!1),localState.chat.page++,o=o.concat(a.chatusers),h()},error:function(){$("#chat #chatUsersList .load-more").removeClass("disabled").prop("disabled",!1)}})}function p(){$.ajax({method:"post",url:"api/",data:{do:"loadMoreChatUsers",page:0,lang:localState.lang,started:1},success:function(a){AppData.chatusers=a.chatusers,d(),c(!0),""!=localState.chat.active&&null!=localState.chat.active&&u(localState.chat.active)},error:function(){}})}function u(a,t){AppData.modulsettings.showvideochat?$("#chat-details .video-chat").show():$("#chat-details .video-chat").hide(),AppData.modulsettings.transparent_chat?($("#chat-details .container").addClass("transparent"),$("#chat-details .sendmessage_inner").addClass("transparent")):($("#chat-details .container").removeClass("transparent"),$("#chat-details .sendmessage_inner").removeClass("transparent")),$("#chat-details .messages").empty().attr("data-roomid",a),$("#chat .search-wrapper input").val(""),$("#chat .search-wrapper .btn-clear").toggle(!1),$("#chat .no-result").toggle(!1),e=void 0,$.ajax({method:"post",url:"api/",data:{do:"getMessages",room_id:a},success:function(a){for(var t in a){var e={self:!0,scroll:!1};e.message=a[t].message,e.type=a[t].type,e.added_users=a[t].added_users,e.sent_at=a[t].sent_at,e.room_id=a[t].room_id,a[t].sender!=AppData.profile.id&&(e.sender=a[t].sender),v(e)}_(0)}}),0===$("#chat .item.badge").length&&$('#landing [data-target="chat"]').removeClass("badge"),$('#chat-details [name="room_id"]').val(a);var s=AppData.chatrooms.find((function(t){return t.id==a})),o=[];if(s)for(var d in s.users)if(s.users[d]!=AppData.profile.id){var i=AppData.chatusers.find((function(a){return a.id==s.users[d]}));o.push(i.name[localState.lang])}$("#chat-details header .data-label").html(o.join(", ")),g()}function g(){var a;a=$(".videostream #playerElement").is(":visible")&&$(window).width()<1200?$(".videostream #playerElement").height()+70:63,$("#chat-details .sendmessage").css({flex:"0 0 "+a+"px"})}function f(a){if(a.preventDefault(),""!=$('input[name="message"]',$("#chat-details")).val()){var t=new FormData($(this).get(0));$(this).serialize();$('input[name="message"]',$("#chat-details")).val(""),$.ajax({method:"post",url:"api/",data:{do:"saveMessage",room_id:t.get("room_id"),message:t.get("message")},success:function(a){let e={message:t.get("message"),room_id:t.get("room_id"),sent_at:parseInt((new Date).getTime()/1e3),self:!0,scroll:!0};for(var s in v(e),a.users)Socket.Send("Chat.appendMessage",{message:t.get("message"),room_id:t.get("room_id"),sent_at:parseInt((new Date).getTime()/1e3),sender:AppData.profile.id,self:!1,scroll:!0},{uid:a.users[s]});for(var o=0;o<AppData.chatrooms.length;o++)if(AppData.chatrooms[o].id==t.get("room_id")){AppData.chatrooms[o].last_message=(new Date).getTime()/1e3;break}d(),c(!1),$('#chat #chatList [data-roomid="'+e.room_id+'"] .data-info').html(e.message)}})}}function v(a){var o=t.clone(),i=new Date(1e3*a.sent_at),n=i.getFullYear()+"-"+(i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1)+"-"+(i.getDate()<10?"0"+i.getDate():i.getDate()),r=(i.getHours()<10?"0"+i.getHours():i.getHours())+":"+(i.getMinutes()<10?"0"+i.getMinutes():i.getMinutes());if(null!=e&&e==n||$('#chat-details .messages[data-roomid="'+a.room_id+'"]').append('<div class="msg_date"><span class="bg-primary color-accent">'+n+"</span></div>"),"user_added"==a.type){var l="";(u=AppData.chatusers.find((function(t){return t.id==a.sender})))&&(l=u.name[localState.lang]),null==a.sender&&(l=AppData.profile.name[localState.lang]);var h=[];for(var m in a.added_users){var p=AppData.chatusers.find((function(t){return t.id==a.added_users[m]}));h.push(p.name[localState.lang])}return g=(g=(g=Language.getItem("chat-user-added")).replace("{adder}",l)).replace("{added}",h.join(", ")),a.message=g,o.addClass("user_added"),o.find(".msg").html('<div class="small_add">'+r+"</div>"+a.message),$('#chat-details .messages[data-roomid="'+a.room_id+'"]').append(o),a.scroll&&_(400),void(e=n)}if("video_chat_started"==a.type){var u,g;l="";return(u=AppData.chatusers.find((function(t){return t.id==a.sender})))&&(l=u.name[localState.lang]),null==a.sender&&(l=AppData.profile.name[localState.lang]),g=(g=Language.getItem("chat-videochat-started")).replace("{adder}",l),a.message=g,o.addClass("user_added video_chat_info"),o.find(".msg").html('<div class="small_add">'+r+"</div>"+a.message),$('#chat-details .messages[data-roomid="'+a.room_id+'"]').append(o),a.scroll&&_(400),void(e=n)}if(o.find(".msg").html(a.message+'<div class="small">'+r+"</div>"),a.sender){var f=AppData.chatusers.find((function(t){return t.id==a.sender}));if(!a.self){for(var v=0;v<AppData.chatrooms.length;v++)if(AppData.chatrooms[v].id==a.room_id){AppData.chatrooms[v].last_message=(new Date).getTime()/1e3;break}if(d(),c(!0),$('#landing [data-target="chat"]').addClass("badge"),$('#chat-details .messages[data-roomid="'+a.room_id+'"]').is(":visible"))$('#chat [data-roomid="'+a.room_id+'"]').removeClass("badge"),$('#attendees [data-index="'+a.sender+'"]').removeClass("badge");else{if($('#chat [data-roomid="'+a.room_id+'"]').addClass("badge"),$('#attendees [data-index="'+a.sender+'"]').addClass("badge"),$(".floatbadge.general-unread").remove(),0==$('.floatbadge[data-room="'+a.room_id+'"][data-uid="'+a.sender+'"]').length){let t=$("<div/>").addClass("floatbadge border-primary").attr("data-room",a.room_id).attr("data-uid",a.sender);t.html(Language.getItem("new-message")+": "+f.name[localState.lang]),t.on("click",(function(){w($(this).attr("data-room"),$(this).attr("data-uid")),t.remove()})),t.appendTo($("body"))}}0==$("#chat #chatList .item.badge").length&&$('#landing [data-target="chat"]').removeClass("badge")}o.addClass("sender");var D=AppData.chatrooms.find((function(t){return t.id==a.room_id}));f&&s!=f.name[localState.lang]&&D.users.length>2&&o.prepend('<div class="sender_username">'+f.name[localState.lang]+"</div>"),$('#chat-details .messages[data-roomid="'+a.room_id+'"]').append(o),s=f.name[localState.lang]}else{if($("#chat-details .messages").append(o),o.find(".msg").addClass("bg-primary color-accent"),s="self",!a.self)for(v=0;v<AppData.chatrooms.length;v++)if(AppData.chatrooms[v].id==a.room_id){AppData.chatrooms[v].last_message=(new Date).getTime()/1e3;break}$('#chat-details .messages[data-roomid="'+a.room_id+'"]').is(":visible")&&(localState.chat.lastMsgRead[a.room_id]=(new Date).getTime()),d(),c(!1)}$('#chat #chatList [data-roomid="'+a.room_id+'"] .data-info').html(a.message),a.scroll&&_(400),e=n}function _(a){"floating"==AppData.settings.homeScreen?$("#chat-details .containerbgvideo .messages").animate({scrollTop:$("#chat-details .containerbgvideo .messages").prop("scrollHeight")},a):$("#chat-details article .messages").animate({scrollTop:$("#chat-details article .messages").prop("scrollHeight")},a)}function D(){$.post("api/",{do:"getChatUsers",lang:localState.lang},(function(a){if(AppData.chatusers=a.chatusers,AppData.chatrooms=a.chatrooms,d(),c(!0),""!=localState.chat.active){var t=[],e=AppData.chatrooms.find((function(a){return a.id==localState.chat.active}));if(e){for(var s in e.users)if(e.users[s]!=AppData.profile.id){var o=AppData.chatusers.find((function(a){return a.id==e.users[s]}));t.push(o.name[localState.lang])}$("#chat-details header .data-label").html(t.join(", "))}}}))}function S(t){$("#chat .search-wrapper .btn-clear"),$("#chat .no-result");var e=$("#chat .search-wrapper input").val().split(" ").join("");new RegExp(strCanonical(e),"i"),new RegExp(strCanonical(e),"i");$("#chat #chatList div[data-roomid]").toggle(""==e),e.length>2?$.ajax({method:"post",url:"api/",data:{do:"searchChatusers",lang:localState.lang,searchtext:e},success:function(t){$("#chat #chatList").html(""),$("#chat #chatUsersList").html("");for(let e in t){let s=t[e];if(s.id!=AppData.profile.id){let t=a.clone(),e=[];s.job[localState.lang]&&e.push(s.job[localState.lang]),s.company[localState.lang]&&e.push(s.company[localState.lang]),t.attr("data-index",s.id),t.find(".data-name").html(s.name[localState.lang]),t.find(".data-info").html(e.join(" | ")).toggleClass("hidden",!e.length),s.img?t.find(".data-img").attr("src","upload/users/"+s.img):t.find(".data-img").attr("src","img/profile-picture-placeholder.png"),t.appendTo($("#chat #chatList"))}}}}):(c(!1),o=[],$("#chat #chatUsersList").html(""),localState.chat.page=0,m())}function C(t){$("#chat-details .searchadd-wrapper .btn-clear"),$("#chat-details .no-result");var e=$("#chat-details .searchadd-wrapper input").val().split(" ").join(""),s=(new RegExp(strCanonical(e),"i"),new RegExp(strCanonical(e),"i"),$("#chat-details .add_user").attr("data-roomid")),o=AppData.chatrooms.find((function(a){return a.id==s}));e.length>2?$.ajax({method:"post",url:"api/",data:{do:"searchChatusers",lang:localState.lang,searchtext:e},success:function(t){$("#chat-details #chatAddList").html("");for(let e in t){let d=t[e];if(d.id!=AppData.profile.id&&-1==o.users.indexOf(d.id)){let t=a.clone(),e=[];d.job[localState.lang]&&e.push(d.job[localState.lang]),d.company[localState.lang]&&e.push(d.company[localState.lang]),t.attr("data-index",d.id),t.attr("data-roomid",s),t.find(".data-name").html(d.name[localState.lang]),t.find(".data-info").html(e.join(" | ")).toggleClass("hidden",!e.length),d.img?t.find(".data-img").attr("src","upload/users/"+d.img):t.find(".data-img").attr("src","img/profile-picture-placeholder.png"),t.appendTo($("#chat-details #chatAddList"))}}}}):$("#chat-details #chatAddList").html("")}function b(){w($(this).attr("data-roomid")||"new_room",$(this).attr("data-index"))}function A(a){a.preventDefault();var t=$(this).attr("data-roomid"),e=$(this).attr("data-index");$.ajax({method:"post",url:"api/",data:{do:"addUserToRoom",id:t,users:[e],lang:localState.lang},success:function(a){w(t,e),AppData.chatrooms=a.rooms,AppData.chatusers=a.chatusers;var s=AppData.chatrooms.find((function(a){return a.id==t}));if(s){v(a.msg),a.msg.scroll=!0;var o=[];for(var d in s.users)if(Socket.Send("Chat.BuildFromSource",null,{uid:s.users[d]}),Socket.Send("Chat.appendMessage",a.msg,{uid:s.users[d]}),s.users[d]!=AppData.profile.id){var i=AppData.chatusers.find((function(a){return a.id==s.users[d]}));o.push(i.name[localState.lang])}$("#chat-details .header-secondary .data-label").html(o.join(", "))}$(".add_user_to_room").fadeOut(400)}})}function w(a,t){"floating"==AppData.settings.homeScreen?($("#chat-details .sendmessage").addClass("floating"),$("#chat-details .container").removeClass("classic")):($("#chat-details .sendmessage").removeClass("floating"),$("#chat-details .container").addClass("classic")),"new_room"==a?$.ajax({url:"api/",method:"post",data:{do:"createChatRoom",users:[AppData.profile.id,t],lang:localState.lang},success:function(a){AppData.chatrooms=a.chatrooms,AppData.chatusers=a.chatusers,$("#chat-details .sendmessage .add_user").attr("data-roomid",a.room.id),Socket.Send("Chat.BuildFromSource",null,{uid:t}),$("#chat .search-wrapper input").val("").trigger("input"),localState.chat.lastMsgRead[a.room.id]=(new Date).getTime(),localState.chat.active=a.room.id,writeDbLog("open chat",String(a.room.id),"user_logs","chat"),u(a.room.id),L(a.room_id,t),Layout.show("chat-details")}}):($("#chat-details .sendmessage .add_user").attr("data-roomid",a),$('.floatbadge[data-room="'+a+'"]').remove(),localState.chat.lastMsgRead[a]=(new Date).getTime(),localState.chat.active=a,u(a),L(a,t),Layout.show("chat-details"))}function L(a,t){$('#chat #chatList .item[data-roomid="'+a+'"]').removeClass("badge"),$('#attendees [data-index="'+t+'"]').removeClass("badge"),0===$("#chat .item.badge").length&&$('#landing [data-target="chat"]').removeClass("badge")}function y(a){a.preventDefault(),$("#chat .search-wrapper input").val("").trigger("input"),c(!1)}function x(a){(a.wich||13===a.keyCode)&&this.blur()}function k(a){a.preventDefault(),$("#chat-details .searchadd-wrapper input").val("").trigger("input")}function j(){$("#chat-details header").show(),$("#chat-details article .closebutton").show(),$("#chat-details .add_user").show(),$("#chat-details .sendmessage").removeClass("floating_chat"),$("#chat-details article .closebutton_chat").remove(),$("#chat-details article .name_chat").remove(),$("#chat-details").appendTo("body"),Layout.hide("chat-details",!0),$(".floating_chat_wrapper").remove()}return{Init:function(){a=$("template#tplChatItem").remove().contents(),t=$("template#tplChatMessageItem").remove().contents(),localState.chat=localState.chat||{lastMsgRead:{},active:""},localState.chat.page=0,$(document).on("input","#chat .search-wrapper input",S),$(document).on("keyup","#chat .search-wrapper input",x),$(document).on("click","#chat .search-wrapper .btn-clear",y),$(document).on("click","#chat #chatList .item",b),$(document).on("click","#chat #chatUsersList .item",b),$(document).on("submit","#chat-details form",f),$(document).on("click","#chat-details .add_user",r),$(document).on("click","#chat-details .close-add-user",l),$(document).on("click","#chat-details .video-chat",n),$(document).on("click","#chat-details .delete-chat",i),$(document).on("click","#chat-details #chatAddList .item",A),$(document).on("input","#chat-details .searchadd-wrapper input",C),$(document).on("keyup","#chat-details .searchadd-wrapper input",x),$(document).on("click","#chat-details .searchadd-wrapper .btn-clear",k),$(document).on("click","#chat #chatUsersList .load-more",m),clientEventListeners.push({type:"open",event_name:"chat_opened"}),clientEventListeners.push({type:"swap",event_name:"chat_opened"}),$(document).on("chat_opened",(function(){$(".floatbadge.general-unread").remove()})),$(window).on("resize",g),$("#chat-details article").replaceWith($("#chat-details article").clone()),o=[],m(),p(),$.each(AppData.chatrooms,(function(a,t){let e=localState.chat.lastMsgRead[t.id]||0;if(t.last_message>e/1e3){if($('#landing [data-target="chat"]').addClass("badge"),$("#chat .chatList [data-roomid='"+t.id+"']").addClass("badge"),0==$(".floatbadge.general-unread").length){let a=$("<div/>").addClass("floatbadge border-primary general-unread");a.html(Language.getItem("unread-messages")),a.on("click",(function(){Layout.show("chat"),a.remove()})),a.appendTo($("body"))}}}))},evtClickDetails:b,refresh:function(){localState.chat=localState.chat||{lastMsgRead:{},active:""},localState.chat.page=0,o=[],m(),p()},showChat:w,appendMessage:v,BuildFromSource:D,updateAvatar:function(a){$.get(a,(function(){D()}))},showFloatingChat:function(a){$.ajax({url:"api/",method:"post",data:{do:"createChatRoom",users:[AppData.profile.id,a],lang:localState.lang},success:function(t){AppData.chatrooms=t.chatrooms,AppData.chatusers=t.chatusers,$("#chat-details .sendmessage .add_user").attr("data-roomid",t.room.id),Socket.Send("Chat.BuildFromSource",null,{uid:a}),u(t.room.id);let e=$("<div/>").addClass("floating_chat_wrapper");$("#chat-details").appendTo(e),e.appendTo("body"),$("#chat-details header").hide(),$("#chat-details article .closebutton").hide(),$("#chat-details .add_user").hide(),$("#chat-details .sendmessage").addClass("floating_chat");let s=$("<div/>").addClass("closebutton_chat color-primary btn");s.html(Language.getItem("chat-close")),s.on("click",j),$("#chat-details article .container").prepend(s);var o=AppData.chatusers.find((function(t){return t.id==a}));let d=$("<div/>").addClass("name_chat");d.html(o.name[localState.lang]),$("#chat-details article .container").prepend(d),$("#chat-details").show()}})},hideFloatingChat:j,roomDeleted:function(a){$('[data-roomid="'+a+'"]').length>0&&(Modal.alert(Language.getItem("chat-deleted")),Layout.hide("chat-details"),Layout.show("chat"),D())},UpdateModule:function(a){let t=!1;$.each(o,(function(e,s){s[a.id_field]==a.id_value&&(o[e]=a.updated_content,t=!0)})),$.each(AppData.chatusers,(function(e,s){s[a.id_field]==a.id_value&&(AppData.chatusers[e]=a.updated_content,t=!0)})),t&&(h(),c())},removeUser:function(a){let t=!1,e=o.length,s=AppData.chatusers.length;for(;e--;)o[e][a.id_field]==a.id_value&&(o.splice(e,1),t=!0);for(;s--;)AppData.chatusers[s][a.id_field]==a.id_value&&(AppData.chatusers.splice(s,1),t=!0);t&&(h(),c())}}}();
var Docs=function(){"use strict";var t,a,e="";let o;function n(){a.sort((function(t,a){return void 0!==t.sort_id&&void 0!==a.sort_id?parseInt(t.sort_id)>parseInt(a.sort_id)?1:-1:0}))}function i(e){$("#docs").find(".search-wrapper").toggle(!0===AppData.modulsettings.showsearchbar),n();var i=$("#docs #docsList"),s=$(document.createDocumentFragment()),l=[];0===AppData.docsgroups.length&&(l=AppData.docs),AppData.docsgroups.sort((function(t,a){return void 0!==t.sort_id&&void 0!==a.sort_id?parseInt(t.sort_id)>parseInt(a.sort_id)?1:-1:0}));var d=AppData.docsgroups;(null!=e&&(d=AppData.docsgroups.filter((function(t){return t.id===e.id}))),o=e,void 0!==localState.docsgroups&&void 0!==localState.docsgroups.itemIndex&&(d=AppData.docsgroups.filter((function(t){return t.id==localState.docsgroups.itemIndex}))),$.each(d,(function(o,n){var i=0,d=$("<h3/>").addClass("grouptitle").css({color:n.titlecolor||"#555555"}).html(n.title[localState.lang]);(void 0!==e||void 0!==localState.docsgroups&&void 0!==localState.docsgroups.itemIndex)&&$("#docs .data-label").html(n.title[localState.lang]),d.appendTo(s),$.each(a,(function(a,e){var o=l.find((function(t){return t.id==e.id}));if(""!=e.group&&null!=e.group||null!=o||l.push(e),e.group==n.id&&e.active){i++;var d=t.clone();if(d.attr("data-index",e.id),d.find(".data-title").text(e.title[localState.lang]),null!=e.tags&&null!=e.tags[AppData.settings.lang]&&""!=e.tags[AppData.settings.lang]&&AppData.modulsettings.showtags){var c=e.tags[AppData.settings.lang].split(","),r=[];$.each(c,(function(t){var a=$.trim(this);r.push("<span class='data-tags-item item-"+e.id+"-"+t+"' data-tag='"+a+"'>#"+a.toLowerCase()+"</span>")})),d.find(".data-tags").html(r.join(" ")).css("display","block")}d.appendTo(s)}})),0==i&&d.remove()})),l.length>0&&d.length===AppData.docsgroups.length)&&($("<h3/>").addClass("grouptitle").html("&nbsp;").appendTo(s),$.each(l,(function(a,e){if(e.active){var o=t.clone();if(o.attr("data-index",e.id),o.find(".data-title").text(e.title[localState.lang]),null!=e.tags&&null!=e.tags[AppData.settings.lang]&&""!=e.tags[AppData.settings.lang]&&AppData.modulsettings.showtags){var n=e.tags[AppData.settings.lang].split(","),i=[];$.each(n,(function(t){var a=$.trim(this);i.push("<span class='data-tags-item item-"+e.id+"-"+t+"' data-tag='"+a+"'>#"+a.toLowerCase()+"</span>")})),o.find(".data-tags").html(i.join(" ")).css("display","block")}o.appendTo(s)}})));i.html(s),$.each(a,(function(t,a){if(null!=a.tags&&AppData.modulsettings.showtags)for(var e=a.tags[AppData.settings.lang].split(",").length,o=0;o<e;o++)$(".data-tags").find(".item-"+a.id+"-"+o).on("click",(function(t){t.stopPropagation();var a=$("#docs .search-wrapper .btn-clear"),e=$("#docs .search-wrapper input").val("#"+this.dataset.tag.toLowerCase()),o=this.dataset.tag.split(" ").join("").toLowerCase(),n=new RegExp("#"+strCanonical(o)+"#","mi");requestAnimationFrame((function(){$("#docs #docsList .item").each((function(t,a){$(a).toggle(n.test(strCanonical($(a).find(".data-tags").text().split(" ").join("")+"#")))})),a.toggle(Boolean(e.length))}))}))}))}function s(){if("docs"in localState&&a.length>0){var t=$("#docs-details"),e=AppData.favorites.find((function(t){return"doc"===t.type&&t.data===localState.docs.itemIndex})),o=Boolean(e),n=Boolean(e)&&!e.sent,i=$("#docs-details .data-label"),s=a.find((function(t){return t.id==localState.docs.itemIndex}));s&&(writeDbLog("show document",s.id,"user_logs","docs"),i.text(s.title[localState.lang]),s.files[localState.lang]&&$("#docs-details embed").attr("src","./pdfjs/web/viewer.html?file=../../upload/docs/"+s.files[localState.lang].filename),t.find(".showfavoritebutton").toggle(s.showfavoritebutton||void 0!==e)),t.find(".favorite.save").toggleClass("hidden",o),t.find(".favorite.saved").toggleClass("hidden",!o),t.find(".favorite.cancel").toggleClass("hidden",!n)}}function l(){var t=a.find((function(t){return t.id==localState.docs.itemIndex}))||a[0];t&&$("main#docs-details").find(".showfavoritebutton").toggle(t.showfavoritebutton)}function d(t){var a=!1,e=$("#docs .search-wrapper .btn-clear"),o=$("#docs .noresults"),n=$("#docs .search-wrapper input").val(),i=n.split(" ").join(""),s=new RegExp(strCanonical(i),"i"),l=new RegExp(strCanonical(i),"i");requestAnimationFrame((function(){$("#docs #docsList .item").each((function(t,e){var o=$(e).find(".data-title").text().split(" ").join(""),n=$(e).find(".data-tags").text().split(" ").join(""),i=s.test(strCanonical(o))||l.test(strCanonical(n));$(e).toggle(i),a=!!i||a,o=i=null})),e.toggle(Boolean(n.length)),o.toggle(!a),a=e=o=n=i=s=null}))}function c(){localState.docs={itemIndex:String($(this).data("index"))||0},s(),Layout.show("docs-details")}function r(t){t.preventDefault(),$("#docs .search-wrapper input").val("").trigger("input")}function p(t){(t.wich||13===t.keyCode)&&this.blur()}function u(){var t=$("main#docs-details");t.find(".favorite.save").addClass("hidden"),t.find(".favorite.saved").removeClass("hidden"),t.find(".favorite.cancel").removeClass("hidden"),$.post("api/",{do:"saveFavoriteDoc",data:{id:localState.docs.itemIndex||!1,lang:localState.lang}},(function(t){AppData.favorites=t,BookedAgenda.renderList(),Modal.resultconfirmation({canClose:!0,title:AppData.languages[localState.lang].savedocument_title,text:AppData.languages[localState.lang].savedocument_text}),t=null})),t=null}function g(){var t=$("main#docs-details"),a=AppData.favorites.find((function(t){return"doc"===t.type&&t.data===localState.docs.itemIndex}));t.find(".favorite.save").removeClass("hidden"),t.find(".favorite.saved").addClass("hidden"),t.find(".favorite.cancel").addClass("hidden"),$.post("api/",{do:"removeFavorite",data:a.id},(function(t){AppData.favorites=t,BookedAgenda.renderList(),t=null})),t=null}function f(t){""==t?(e="",null!=localState.docsgroups&&delete localState.docsgroups.itemIndex,a=AppData.docs.filter((function(t){return t.active})),i()):"docs"!=t&&"useful"!=t||(e=t,a=AppData.docs.filter((function(a){return a.type==t&&a.active})),i())}return{Init:function(){t=$("template#tplDocsItem").remove().contents(),a=AppData.docs.filter((function(t){return t.active})),$(document).on("input","#docs .search-wrapper input",d).on("keyup","#docs .search-wrapper input",p).on("click","#docs .search-wrapper .btn-clear",r).on("click","#docs #docsList .item",c).on("click","#docs-details .favorite.save",u).on("click","#docs-details .favorite.cancel",g),localState.docs=localState.docs||{},localState.docs.itemIndex=localState.docs.itemIndex||0,i(),s(),$("#docs .search-wrapper input").val(""),delete Docs.Init},BuildFromSource:function(){$.post("api/",{do:"getDocs"},(function(t){AppData.docs=t,n(),a=AppData.docs.filter((function(t){return t.active})),void 0!==o||void 0!==localState.docsgroups&&void 0!==localState.docsgroups.itemIndex?i(o):f(e),l(),Agenda.renderList(),t=null}))},showDetails:function(t,e){if(t)if("agendadoc"===t)a=AppData.docs.filter((function(a){return a.type===t&&a.active})),localState.docs.itemIndex=a[0].id,s(),Layout.show("docs-details");else if("all_docs"===t)a=AppData.docs.filter((function(a){return a.type===t&&a.active})),i(),Layout.show("docs");else{let a=AppData.docs.filter((function(a){return a.id===t}));if(a.length>0&&void 0!==a[0].group)null!=localState.docs?t===localState.docs.itemIndex&&0!==localState.docs.itemIndex||(localState.docs.itemIndex=String(t)):localState.docs={itemIndex:String(t)},s(),null!=e&&1!=e||Layout.show("docs-details");else{var o=AppData.docsgroups.find((function(a){return t==a.id}));void 0!==localState.docsgroups?t===localState.docsgroups.itemIndex&&0!==localState.docsgroups.itemIndex||(localState.docsgroups.itemIndex=String(t)):localState.docsgroups={itemIndex:String(t)},null!=o&&(i(o),Layout.show("docs"))}}},showList:f,evtClickDetails:c,showfavoritebutton:l,renderList:i}}();
function EnigmaGame(t,e,a,n){this.act_letter=0,this.act_time=0,this.container,this.enigma_input,this.enigma_letters,this.enigma_start,this.initial=!1,this.countdown,this.letters="abcdefghijklmn opqrstuvwxyz",this.nums=[],this.use_poisson=!1,this.prev_positions,this.anim_running=!1,this.dummy,this.clicked_item,this.stats={finished:!1,time:"00:00",seconds:0,name:""},this.name,this.resetbtn,this.end_screen,this.rotation=0,this.words=e.slice(),this.act_word=0,this.saving=!1,this.score=0;var i=this;this.init=function(){i.act_word=0,i.act_time=0,i.act_letter=0,i.score=0,i.nums=[],""!=AppData.modulsettings.enigma_words?i.words=AppData.modulsettings.enigma_words.split(","):i.words=e.slice(),i.container=$("<div/>").attr("id",a+"_container").addClass("player_container").appendTo(n),n.css({"background-image":'url("'+url_rewrite+AppData.settings.bgImage+'")'}),i.timerObj=new timer,i.timer_cont=$("<div/>").attr("id",a+"_timer").addClass("game_timer bg-primary").html("<span>03:00</span>").appendTo(i.container),i.enigma_input=$("<div/>").attr("id",a+"_enigma_input").addClass("enigma_input").html('<span class="input_inner">'+i.words[i.act_word]+"</span>").appendTo(i.container),i.enigma_letters=$("<div/>").attr("id",a+"_enigma_letters").addClass("enigma_letters").appendTo(i.container),i.dummy=$("<div/>").attr("id",a+"_dummy").addClass("dummy").appendTo(n),i.resetbtn=$("<div/>").attr("id",a+"_resetbtn").addClass("enigma_resetbtn").appendTo(i.container),i.enigma_start=$("<div/>").attr("id",a+"_start").addClass("enigma_start color-primary").html("START").appendTo(i.container),i.end_screen=$("<div/>").attr("id",a+"_end").addClass("enigma_end").html('<div class="final_content"><div class="toplist"><div class="toplist_inner"></div></div><div class="final_text color-primary">'+Language.getItem("grat-text")+"<br>"+Language.getItem("game-score")+': <span class="final_score"></span><br></div></div>').appendTo(i.container),i.resetbtn.on("click",(function(t){t.preventDefault(),"touchend"==t.type&&i.resetbtn.off("mouseup"),i.reset_game()})),$(".save_game",i.container).on("click",(function(t){i.saving||(i.saving=!0,$.ajax({url:"save_game",method:"post",dataType:"json",data:{name:$(".player_name",i.container).val(),gametime:i.act_time},success:function(t){if(i.saving=!1,"ok"==t.status){$(".final_text",i.container).hide(),$(".keyboard",i.container).hide(),$(".toplist",i.container).show();let e,a=[],n=$(".toplist_inner",i.container);n.empty();for(let i in t.top10){e=$("<div/>").addClass("toplist_item").html('<div class="place">'+t.top10[i].place+'.</div><div class="name">'+t.top10[i].name+'</div><div class="game_time">'+formatTime(t.top10[i].gametime)+"</div>");for(let n in t.actual_positions)t.actual_positions[n].login_code==t.top10[i].login_code&&t.actual_positions[n].created_at==t.top10[i].created_at&&(e.addClass("actual"),a.push(t.actual_positions[n].id));e.appendTo(n)}t.actual_positions.length!=a.length&&(e=$("<div/>").addClass("toplist_item").html("..."),e.appendTo(n));for(let i in t.actual_positions)-1==a.indexOf(t.actual_positions[i].login_code)&&(e=$("<div/>").addClass("toplist_item later").html('<div class="place">'+t.actual_positions[i].place+'.</div><div class="name">'+t.actual_positions[i].name+'</div><div class="game_time">'+formatTime(t.actual_positions[i].gametime)+"</div>"),e.appendTo(n));if(t.top10.length<10)for(let a=t.top10.length+1;a<=10;a++)e=$("<div/>").addClass("toplist_item").html('<div class="place">'+a+'.</div><div class="name">-</div><div class="game_time"></div>'),e.appendTo(n);$(".player_name",i.container).val(""),setTimeout((function(){i.reset_game()}),1e4)}else if(null!=t.fields)for(let e in t.fields)1==t.fields[e]&&$("#"+e,i.container).addClass("error")}}))})),i.enigma_start.on("click",(function(t){t.preventDefault(),"touchend"==t.type&&i.enigma_start.off("mouseup"),i.enigma_start.fadeOut(200),i.enigma_input.fadeIn(200),i.enigma_letters.fadeIn(200),i.timer_cont.fadeIn(200),i.timer_cont.addClass("game_started");let a=AppData.modulsettings.enigma_time||180;i.timerObj.init(i.timer_cont,a,"enigmaGame.times_up"),i.timerObj.stop(),i.timerObj.start(),""!=AppData.modulsettings.enigma_words?i.words=AppData.modulsettings.enigma_words.split(","):i.words=e.slice(),i.start()}));for(var s=1;s<=i.letters.length;s++)i.nums.push(s);i.name=t,i.generateLetters()},this.rotate=function(t){i.rotation=t,360==i.rotation&&(i.rotation=0),i.container.css({transform:"rotate("+i.rotation+"deg)"})},this.setOnePlayer=function(){i.container.css({float:"none"})},this.start=function(){i.shuffleLetters()},this.generateLetters=function(){var t=i.letters.split("");if(i.shuffle(t),i.enigma_letters.empty(),i.use_poisson)var e=new PoissonDiskSampler(max_width,max_height,40,30).sampleUntilSolution();for(var a=0;a<t.length;a++){var n=$("<div/>").attr("data-letter",t[a]).addClass("color-primary border-primary letter letter-"+(a+1)).html(t[a]).appendTo(i.enigma_letters);i.initial&&n.hide(),n.animation=i.letterAnimation(n,a,e),n.on("mouseup touchend",i.handleLetterClick)}$(".letter").on("webkitAnimationEnd oanimationend msAnimationEnd animationend",(function(){$(".shakeit",i.container).removeClass("shakeit"),$(".letter",i.container).removeClass("delay_move")})),i.dummy.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",(function(){$(this).removeClass("dummy_move"),i.anim_running=!1})),i.initial=!1,i.prev_positions=e},this.handleLetterClick=function(t){if(!i.anim_running){i.anim_running=!0,i.dummy.addClass("dummy_move");var e=$(t.target);i.clicked_item=e,"touchend"==t.type&&e.off("mouseup");var a=e.attr("data-letter");if(i.words[i.act_word][i.act_letter].toLowerCase()==a.toLowerCase()){i.act_letter++;for(var n="",s=0;s<i.words[i.act_word].length;s++)s<i.act_letter?n+='<span class="green_letter">'+i.words[i.act_word][s]+"</span>":n+=i.words[i.act_word][s];if(i.enigma_input.html('<span class="input_inner">'+n+"</span>"),$(".input_inner",i.enigma_input).css({display:"inline-block"}),i.act_letter==i.words[i.act_word].length)return i.score+=10,i.act_word++,void(i.act_word<i.words.length?setTimeout((function(){4==i.act_word&&$(".letter",i.container).addClass("rotateletter"),i.enigma_input.html('<span class="input_inner">'+i.words[i.act_word]+"</span>"),$(".input_inner",i.enigma_input).css({display:"inline-block"}),i.act_letter=0,i.shuffleLetters()}),1e3):i.endgame())}else e.addClass("shakeit");i.use_poisson?i.generateLetters():i.shuffleLetters()}},this.letterAnimation=function(t,e,a){i.initial?(i.use_poisson&&$(t).css({left:a[e].x,top:50+a[e].y}),$(t).delay(randInt(100,800)).fadeIn(400)):i.use_poisson&&($(t).css({left:prev_positions[e].x,top:50+prev_positions[e].y}),$(t).animate({left:a[e].x,top:50+a[e].y},500))},this.shuffleLetters=function(){this.shuffle(i.nums);var t=0;$(".letter, .letter_space",i.container).hasClass("shakeit")&&(t=600),setTimeout((function(){$(".letter",i.container).removeClass((function(t,e){return(e.match(/(^|\s)letter-\S+/g)||[]).join(" ")})).each((function(t){$(this).addClass("letter-"+i.nums[t])}))}),t)},this.reset_game=function(){clearInterval(i.countdown),i.act_word=0,i.act_time=0,i.act_letter=0,i.score=0,i.timer_cont.html("<span>00:00</span>"),$(".letter",i.container).removeClass("rotateletter"),""!=AppData.modulsettings.enigma_words?i.words=AppData.modulsettings.enigma_words.split(","):i.words=e.slice(),i.enigma_input.html('<span class="input_inner">'+i.words[i.act_word]+"</span>"),i.enigma_start.fadeIn(200),i.end_screen.fadeOut(200,(function(){$(".final_text",i.container).show(),$(".keyboard",i.container).show(),$(".toplist",i.container).hide()})),i.enigma_input.fadeOut(200),i.enigma_letters.fadeOut(200),i.timer_cont.fadeOut(200),i.timer_cont.removeClass("game_started")},this.shuffle=function(t){var e,a,n;for(n=t.length;n;n--)e=Math.floor(Math.random()*n),a=t[n-1],t[n-1]=t[e],t[e]=a},this.timesUp=function(){i.endgame()},this.endgame=function(){clearInterval(i.countdown),setTimeout((function(){i.enigma_input.fadeOut(200),i.enigma_letters.fadeOut(200),i.timer_cont.fadeOut(200),i.timer_cont.removeClass("game_started"),$("#enigma .final_score").html(i.score),i.end_screen.fadeIn(200,(function(){$(".letter",i.container).removeClass("rotateletter"),$.ajax({method:"post",url:"api/",data:{do:"saveEnigma",score:i.score}}),setTimeout((function(){i.reset_game()}),5e3)}))}),1e3)}}var enigmaGame;function startEnigma(){(enigmaGame=new EnigmaGame("a",["Veet","Piac","Bolt","Durex","Vrus","Siker","Dettol","Reklm","Patika","Nurofen","Kampny","Premium","Hatsos","Bizalom","Piacrsz","Strepfen","Kapszula","Vsrls","Eredmny","Strepsils","Innovci","Portfolio","Csomagols","Clcsoport","rtkests","Kommunikci","Ferttlent","Termkbevezets","Felntt fejfjs","Stronger together"],"p1",$("#game_area"))).init(),$(document).on("enigmaGame.times_up",enigmaGame.timesUp)}
var FavoriteAgenda=function(){"use strict";var t;function a(){(AppData.agenda||[]).sort((function(t,a){return t.date==a.date?t.timeStart<a.timeStart?-1:t.timeStart>a.timeStart?1:0:t.date<a.date?-1:1})),e()}function e(){if(!1 in AppData||!(AppData.agenda||[]).length)return!1;var a=$("#favorite-agenda #favorite-agendaList"),e=(localState.agenda,$(document.createDocumentFragment())),n=AppData.agenda.filter((function(t){return!!AppData.profile.favorite_agenda.find((function(a){return a.agenda==t.id}))}));$.each(n,(function(a,n){var i=t.clone();!function(t,a){var e=AppData.translations.filter((function(t){return t.translation_id===localState.lang}))[0];t.toggleClass("now","now"===a.status),t.toggleClass("ended","ended"===a.status),t.toggleClass("breaking",!a.rooms&&!a.details),t.toggleClass("link",!!a.rooms||!!a.details),t.attr("data-id",a.id),t.find(".data-timeStart").text(makeTimeFormat(a.timeStart,e.time_format)),t.find(".data-timeEnd").text(makeTimeFormat(a.timeEnd,e.time_format));var n=AppData.days.find((function(t){return t.id==a.day}));n&&t.find(".data-day").html(n.name[localState.lang]);var i,o=AppData.channels.find((function(t){return t.channel===a.rooms}))||!1;t.find(".data-rooms").attr("data-room-id",a.rooms).text(o?o.name[localState.lang]:"").parent().toggleClass("hidden",!o),i="string"==typeof a.title?a.title:a.title[localState.lang];t.find(".data-title").text(i),t.find("[data-lang=now]").text(Language.getItem("now")),t.find("[data-lang=expired]").text(Language.getItem("expired")),t.find(".data-title").toggleClass("title-short",i.length<35),t.find(".data-title").toggleClass("title-long",i.length>=70),t.find(".data-title").toggleClass("title-extra",i.length>=120)}(i,n),i.appendTo(e),i=null})),a.html(e),a=e=null}function n(){Agenda.showDetails(String($(this).data("id")))}function i(t){t.stopPropagation();var a=$(this),e=a.closest($(".item")).attr("data-id");Modal.confirm(Language.getItem("favorite-agenda-delete"),(function(){$.ajax({method:"post",url:"api/",data:{do:"saveFavoriteAgenda",id:e},success:function(t){a.closest($(".item")).remove(),AppData.profile=t.profile}})}))}return{Init:function(){t=$("template#tplFavoriteAgendaItem").remove().contents(),$(document).on("click","#favorite-agenda #favorite-agendaList .item",n).on("click","#favorite-agenda #favorite-agendaList .item .favorite_agenda",i),a(),delete Agenda.Init},Build:a,BuildFromSource:function(){$.post("api/",{do:"getProfile"},(function(t){AppData.profile=t.profile}))},evtClickDetails:n,showFavorite:function(){AppData.modulsettings.showfavorite?$("#agenda-details .favorite_agenda").show():$("#agenda-details .favorite_agenda").hide()},renderList:e}}();
var Gallery=function(){"use strict";var e,t;function a(){var t=$("#gallery #galleryList"),a=$(document.createDocumentFragment()),l=AppData.gallery.filter((function(e){return!0===e.visible}));!function(e){e.sort((function(e,t){return void 0!==e.sort_id&&void 0!==t.sort_id?parseInt(e.sort_id)>parseInt(t.sort_id)?1:-1:0}))}(l),$.each(l,(function(t,l){var n=e.clone();n.attr("data-index",l.id),n.find(".data-title").html(l.title[localState.lang]),n.appendTo(a)})),t.html(a)}function l(){var e=$("#gallery-details article"),a=$("#gallery-details .data-label"),l=$(document.createDocumentFragment()),n=AppData.gallery.find((function(e){return e.id===localState.gallery.itemIndex}))||AppData.gallery[0];if(!n)return!1;a.text(AppData.languages[AppData.settings.lang]["nav-gallery"]),e.find(".gallery_title h3").html(n.title[localState.lang]),n.description&&e.find(".gallery_description").html(n.description[localState.lang]).show();var i=0;$.each(n.images,(function(e,a){if(AppData.modulsettings.gallery_moderate&&a.moderated||!AppData.modulsettings.gallery_moderate){var n=t.clone();if(n.attr("data-index",a.id),n.attr("data-photo_path","upload/user_photos/"+a.filename),n.find(".gallery_image").attr("data-lazyloadbg","upload/user_photos/"+a.filename),AppData.modulsettings.gallery_userscanlike){if(n.find(".bottom").removeClass("hidden"),n.find(".gallery_image").removeClass("no_bottom"),n.find(".vote_btn").html(Language.getItem("gallery-vote")),null!=a.votes){var o=$.inArray(AppData.profile.id,a.votes)>-1;o&&i++,o&&!AppData.modulsettings.gallery_userscanrevoke&&n.find(".vote_btn").addClass("disabled"),AppData.modulsettings.gallery_userscanrevoke&&o&&n.find(".vote_btn").addClass("revoke").html(Language.getItem("gallery-revoke")),n.find(".vote-count").html(a.votes.length)}}else n.find(".bottom").addClass("hidden"),n.find(".gallery_image").addClass("no_bottom");n.appendTo(l)}})),e.find(".items").html(l);var o=parseInt(AppData.modulsettings.gallery_maxlikeperuser);i>=o&&o>0&&$("#gallery-details .vote_btn").not(".revoke").addClass("disabled"),lazyImagesBg()}function n(){localState.gallery.itemIndex=String($(this).data("index"))||0,l(),Layout.show("gallery-details")}return localState.gallery=localState.gallery||{},localState.gallery.itemIndex=localState.gallery.itemIndex||0,$(document).on("click","#gallery-details .items .gallery_image",(function(){var e=$(this).closest($(".item")),t=$("<div/>").addClass("imageviewer"),a=$("<img/>").attr("src",e.attr("data-photo_path"));t.on("mouseup touchend",(function(e){e.preventDefault(),t.fadeOut(400,(function(){t.remove()}))})),t.append(a),t.appendTo($("body")),t.fadeIn(400)})).on("click","#gallery #galleryList .item",n).on("click","#gallery-details .vote_btn",(function(){var e=$(this).closest(".item").attr("data-index");$(this).addClass("disabled"),$.ajax({method:"post",url:"api/",data:{do:"votePhoto",id:e},success:function(e){AppData.gallery=e,a(),l(),Socket.Send("Gallery.BuildFromSource",null),e=null}})})),{Init:function(){e=$("template#tplGalleryItem").remove().contents(),t=$("template#tplGalleryImageItem").remove().contents(),a(),l(),delete Gallery.Init},BuildFromSource:function(){$.post("api/",{do:"getGallery"},(function(e){AppData.gallery=e,a(),l(),e=null}))},showDetails:function(e){e&&(e===localState.gallery.itemIndex&&0!==localState.gallery.itemIndex||(localState.gallery.itemIndex=String(e),l()),Layout.show("gallery-details"))},renderDetails:l,evtClickDetails:n}}();
var Gdpr=function(){function a(){$("#gdpr").find(".data-text").html(nl2brStrict(AppData.gdpr.gdpr[localState.lang]));var a=AppData.gdpr.checkbox_text[localState.lang];null!=AppData.gdpr.checkbox_text[localState.lang]&&(a=AppData.gdpr.linked_doc?(a=a.replace("[link]",'<a href="javascript:void(0);" class="color-primary doc-link" data-target="'+AppData.gdpr.linked_doc+'">')).replace("[/link]","</a>"):(a=a.replace("[link]","")).replace("[/link]",""));var d=AppData.gdpr.add_checkbox_text[localState.lang];$("#gdpr").find(".chk-label").html(a),$("#gdpr").find(".chk-label-add").html(d),$("#gdpr").find(".chk-label-add").hide(),$.inArray(AppData.profile.group,AppData.gdpr.group)>-1&&$("#gdpr").find(".chk-label-add").show(),$("#gdpr").find(".accept-gdpr").html(AppData.gdpr.button_text[localState.lang]),$("#gdpr").find("header .close-main").hide(),$("#gdpr").find("header .hamburger").hide(),$("#gdpr").find("header .data-icon").hide(),$("#gdpr").find("header").css({"pointer-events":"none"}),$("#gdpr").find("header .data-label").html(Language.getItem("gdpr-title"))}function d(a){var d=$(this).attr("data-target"),t=AppData.docs.find((function(a){return a.id==d}));$("#gdpr-docs").find("header .hamburger").hide(),$("#gdpr-docs").find("header .header-primary").css({"pointer-events":"none"}),$("#gdpr-docs .data-label").text(t.title[localState.lang]),$("#gdpr-docs embed").attr("src","./pdfjs/web/viewer.html?file=../../upload/docs/"+t.files[localState.lang].filename),Layout.show("gdpr-docs");var e=localState.layout.indexOf("gdpr-docs");e>-1&&localState.layout.splice(e,1)}function t(){return $("#gdpr .accept-gdpr-chk").prop("checked")?AppData.gdpr.add_chk_mandatory&&!$("#gdpr .accept-gdpr-chk-add").prop("checked")&&$.inArray(AppData.profile.group,AppData.gdpr.group)>-1?($("#modal").css({"z-index":1e7}),void Modal.alert(AppData.gdpr.add_alert_text[localState.lang],(function(){$("#modal").css({"z-index":""})}))):void $.post("api/",{do:"acceptGdpr",addChk:$("#gdpr .accept-gdpr-chk-add").prop("checked")},(function(a){AppData.profile=a,Layout.hide("gdpr"),Navigation.setAllowCloseMenu()})):($("#modal").css({"z-index":1e7}),void Modal.alert(AppData.gdpr.alert_text[localState.lang],(function(){$("#modal").css({"z-index":""})})))}return{Init:function(){a(),$(document).on("click","#gdpr .accept-gdpr",t),$(document).on("click","#gdpr .doc-link",d),!AppData.modulsettings.showgdpr||null!=AppData.profile.gdpr&&AppData.profile.gdpr||Layout.show("gdpr",!0)},render:a,update:function(){$.post("api/",{do:"getGdpr"},(function(a){AppData.gdpr=a,Gdpr.render(),a=null}))}}}();
var Issues=function(){"use strict";var e,t;function a(){var a=$("#issues .issuesList"),s=$(document.createDocumentFragment()),n=AppData.issues.filter((function(e){return e.user===AppData.profile.id}));if($.each(n,(function(t,a){var n=e.clone();n.attr("data-index",a.id),n.find(".data-question").html(a.question);var i=Language.getItem("moderation-status-waiting");(a.approved||a.client_approved)&&(i=Language.getItem("moderation-status-approved")),a.answer&&(i+=" - <b>"+Language.getItem("moderation-status-answered")+"</b>"),n.find(".data-status").html(i),n.appendTo(s)})),a.html(s),$("#issues").find(".no-result").toggle(Boolean(!AppData.issues.length)),Moderate.renderList(),Stage.renderList(),AppData.modulsettings.qandausercanvote){var i=$("#issues-vote .issuesVoteList"),o=$(document.createDocumentFragment());$("#issues .vote-issues").show();var l=AppData.issues.filter((function(e){return e.user!==AppData.profile.id}));l.sort((function(e,t){let a=0,s=0;e.upvotes&&(a=e.upvotes.length),e.downvotes&&(s=e.downvotes.length);let n=0,i=0;return t.upvotes&&(n=t.upvotes.length),t.downvotes&&(i=t.downvotes.length),n-i-(a-s)})),$.each(l,(function(e,a){var s=t.clone();s.attr("data-index",a.id),s.find(".data-question").text(a.question);let n=!1,i=0,l=0;a.upvotes&&(n=a.upvotes.indexOf(AppData.profile.id)>-1,i=a.upvotes.length),a.downvotes&&(n||(n=a.downvotes.indexOf(AppData.profile.id)>-1),l=a.downvotes.length),s.find(".vote-num").html(i-l),n&&(s.find(".vote-up-btn").remove(),s.find(".vote-down-btn").remove(),s.find(".voted").html(Language.getItem("already-voted"))),s.appendTo(o)})),i.html(o)}else Layout.hide("issues-vote"),$("#issues .vote-issues").hide()}function s(e){void 0===e&&(e=!1),"issues"in localState||(localState.issues={itemIndex:0});var t=$("#issues-details"),a=$("#issues-details .data-label"),s=$("#issues-details article"),i=AppData.issues.find((function(e){return e.id===localState.issues.itemIndex}))||[];a.text(i.title||Language.getItem("issues-new")),s.find("input, textarea, select").val("").prop("disabled",e),s.find(".save").toggleClass("hidden",e),s.find(".selectSpeaker").closest("fieldset").toggleClass("hidden",!0),s.find(".cmc").toggle(0===i.length),$.each(i,(function(e,t){s.find("[name="+e+"]").val(t||"")})),i.answer?(s.find(".issues-answer").text(i.answer),s.find("#issues-answer").show()):s.find("#issues-answer").hide(),AppData.modulsettings.qandashowanonym?s.find(".is_anonym").parent().show():s.find(".is_anonym").parent().hide(),"input"in localState.issues&&$.each(localState.issues.input,(function(e,t){s.find('[name="'+e+'"]').val(t),s.find(".save").removeClass("hidden")})),null!=localState.issues.source&&(i.agenda=localState.issues.itemIndex||""),function(e,t){var a=$(document.createDocumentFragment());AppData.modulsettings.qandashowgeneral?$('<option value="general" selected data-lang="issues-general"></option>').appendTo(a):$('<option value="" selected>--</option>').appendTo(a);let s;$.each(AppData.days,(function(e,t){if(t.active){var s=AppData.agenda.filter((function(e){return t.id==e.day&&e.show_new_question_button}));if(s.length>0){var n=$("<optgroup/>");n.attr("label",t.name[localState.lang]),$.each(s,(function(e,t){var a;a="string"==typeof t.title?t.title:t.title[localState.lang],AppData.modulsettings.qandashowtime&&(a=(t.timeStart?t.timeStart+" - ":"")+a),$("<option/>").val(t.id).text(a).appendTo(n)})),n.appendTo(a)}}})),e.find(".selectAgenda").html(a),s=AppData.modulsettings.qandashowgeneral?t.agenda||"general":t.agenda;e.find(".selectAgenda").val(s);var n=Language.getItem("issues-general"),i=$('[data-lang="issues-general"]');i.is("input[type=text],input[type=search]")?i.attr("placeholder",n):i.text(n);a=null}(t,i),i.speaker&&n(t,i)}function n(e,t){var a=$(document.createDocumentFragment());$('<option value="" selected data-lang="issues-no-speaker"></option>').appendTo(a);var s=AppData.agenda.find((function(t){return t.id===e.find(".selectAgenda").val()})),n=!0,i="";s&&(i="string"==typeof s.speakers?(s.speakers||"").split(","):s.speakers||"",$.each(i,(function(e,t){var s=AppData.speakers.find((function(e){return e.id===t}));s&&(n=!1,$("<option/>").val(s.id).text(s.name[localState.lang]).appendTo(a))}))),e.find(".selectSpeaker").closest("fieldset").toggleClass("hidden",n),e.find(".selectSpeaker").html(a),1===i.length&&e.find(".selectSpeaker").val(i[0]),t&&e.find(".selectSpeaker").val(t.speaker);var o=Language.getItem("issues-no-speaker"),l=$('[data-lang="issues-no-speaker"]');l.is("input[type=text],input[type=search]")?l.attr("placeholder",o):l.text(o),a=null}function i(){AppData.modulsettings.issues_faq_link?$("#issues .faq-link").removeClass("hidden").unbind("click").on("click",(function(){Texts.showDetails(AppData.modulsettings.issues_faq_link)})):$("#issues .faq-link").addClass("hidden"),a(),s()}function o(e){var t;localState.issues={itemIndex:String($(this).data("index"))||0},s(e.data.mod),e.data.id&&(t=e.data.id),writeDbLog("view",localState.issues.itemIndex,"user_logs","issues"),t&&$("#issues-details").find(".selectAgenda").val(t||"general").trigger("change"),d(),Layout.show("issues-details")}function l(e){let t=e.data.direction,n=$(this).closest(".item").attr("data-index");$.ajax({method:"post",url:"api/",data:{do:"voteIssues",id:n,direction:t},success:function(e){AppData.issues=e,a(),s(),Socket.Send("refreshModule",{module:["Moderate"],appdata:"issues",data:e,callback:["renderList"]},{client:"client"})}})}function d(){let e=AppData.modulsettings.charactercountlimit,t=$("#issues-details");if(""!==e&&"0"!==e){t.find("textarea[name=question]").attr("maxlength",e),t.find(".cmcmessage").html(Language.getItem("issues-characters-can-be-entered"));let a=e-t.find("textarea[name=question]").val().length;t.find(".uptocmc").html(a>0?a:"0"),t.find(".cmc").show()}else t.find("textarea[name=question]").removeAttr("maxlength"),t.find(".cmc").hide()}return $(document).on("click","#issues .item",{mod:!0},o).on("click","#issues .new",{mod:!1},o).on("change","#issues-details .selectAgenda",(function(e){n($("#issues-details"))})).on("input","#issues-details input, #issues-details textarea",(function(){var e=$(this);e.get(0).hasAttribute("name")&&(localState.issues.input=localState.issues.input||{},localState.issues.input[e.attr("name")]=e.val())})).on("keyup","#issues-details textarea[name=question]",d).on("submit","#issues-details form",(function(e){e.preventDefault();var t=$(this),s=t.serializeObject();if(s.active=!0,t.addClass("disabled"),writeDbLog("submit","","user_logs","issues"),""==s.agenda)return Modal.alert(Language.getItem("issues-select-agenda")),void t.removeClass("disabled");if("general"!==s.agenda&&""!==s.agenda){var n=AppData.agenda.find((function(e){return e.id===s.agenda}));s.room_id=n.rooms||""}else"off"!=AppData.modulsettings.automoderate&&(s.room_id=AppData.modulsettings.automoderate);$.post("api/",{do:"saveIssues",data:s},(function(e){AppData.issues=e,a(),"floating"===AppData.settings.homeScreen&&($("#"+localState.layout[localState.layout.length-2]).show(),$("#"+localState.layout[localState.layout.length-2]).attr("style","background-color: transparent")),Layout.hide("issues-details"),t.removeClass("disabled"),localState.issues.input={},$("#issues-details article").find("textarea").val(""),d(),Socket.Send("Issues.BuildFromSource",!0,{group:["admin"]}),Socket.Send("refreshModule",{module:["Moderate"],appdata:"issues",data:e,callback:["renderList"]},{client:"client"})}))})).on("click","#issues-vote .vote-up-btn",{direction:"up"},l).on("click","#issues-vote .vote-down-btn",{direction:"down"},l).on("click","#issues .vote-issues",(function(){Layout.show("issues-vote")})),{Init:function(){e=$("template#tplIssuesItem").remove().contents(),t=$("template#tplOtherIssuesItem").remove().contents(),i(),d()},BuildFromSource:function(){$.post("api/",{do:"getIssues"},(function(e){AppData.issues=e,a(),s()}))},Build:i,SetHappening:function(e){AppData.agenda=e,a(),s()},renderDetails:s,renderList:a,showDetails:function(e){e&&(localState.issues.source="agenda",null!=localState.issues?e===localState.issues.itemIndex&&0!==localState.issues.itemIndex||(localState.issues.itemIndex=String(e),s()):localState.issues={itemIndex:String(e)},Layout.show("issues-details"))},evtClickItem:o,maxCharacterCount:d}}();
var Messageboard=function(){"use strict";var e,a;let s=[];var t;function o(o){e=$("#messageboard"),a=$(".messages",e),t=$("#tplMsgItem",e).contents(),$.ajax({method:"post",url:"api/",data:{do:"getMessageboards"},success:function(e){if(null==o||""==o){let a,s=e.find((function(e){return e.automatic}));localState.broadcast&&(a=AppData.broadcast.find((function(e){return e.id==localState.broadcast.itemIndex}))),a&&(s=e.find((function(e){return e.broadcast==a.id}))),null!=s&&(o=s.id)}$.ajax({method:"post",url:"api/",data:{do:"getMessageboardDisplay",id:o||0},success:function(e){AppData.messageboard=e,a.empty(),function(){var e=$("#messageboard .data-label"),o=$("#messageboard .message_container"),r=$("#messageboard .no-result"),d=$("#messageboard .data-title"),i=($("#messageboard article"),AppData.messageboard);if(i.length>0){$('#messageboard [name="messageboard"]').val(i[0].id),e.text(i[0].name[localState.lang]),d.text(i[0].name[localState.lang]),i[0].text_allowed?($(".texfield").show(),$(".submit_text").show()):($(".texfield").hide(),$(".submit_text").hide()),i[0].pic_allowed?$(".send_image").show():$(".send_image").hide();let s=$('#messageboard [name="messageboard"]').val(),o=i.find((function(e){return e.id==s}));if(o)for(var l in o.messages.sort((function(e,a){return Date.parse(e.created_at)-Date.parse(a.created_at)})),o.messages){var m=o.messages[l],g=t.clone();g.find(".data-sender").html(m.username[localState.lang]),m.filename?g.find(".data-message").html('<div class="image_msg"><img src="'+m.filename+'"></div>'):g.find(".data-message").html(m.message),g.appendTo(a)}}else console.log("empty"),a.empty(),s=[];n(),o.toggle(i.length>0),r.toggle(0==i.length),$("#messageboard .messages_container").animate({scrollTop:$("#messageboard .messages_container").prop("scrollHeight")},400)}()}})}})}function n(){AppData.modulsettings.msgboard_showonclient?a.show():a.hide(),AppData.modulsettings.transparent_messageboard?$("#messageboard .container").addClass("transparent"):$("#messageboard .container").removeClass("transparent")}function r(e){var s=t.clone();s.find(".data-sender").html(e.username[localState.lang]),e.filename?s.find(".data-message").html('<div class="image_msg"><img src="'+e.filename+'"></div>'):s.find(".data-message").html(e.message),s.appendTo(a),$("#messageboard .messages_container").animate({scrollTop:$("#messageboard .messages_container").prop("scrollHeight")},400)}function d(){var e=$(".messageboard_modal");e.fadeOut(300,(function(){$(".buttons",e).show(),$(".gallery",e).hide()}))}function i(e){$.ajax({method:"post",url:"api/",data:{do:"uploadPhoto",image:e,returnid:!0},success:function(e){Photos.buildFromSource(),l(e)}})}function l(e){$.ajax({method:"post",url:"api/",data:{do:"saveMessageboardMessage",data:{messageboard:$('[name="messageboard"]').val(),message:"",imageid:e}},success:function(e){Socket.Send("Messageboard.AppendMessage",e,{client:"messageboard"}),Modal.resultconfirmation({title:Language.getItem("upload-success"),text:"",canClose:!0},(function(){d()}))}})}return $(document).on("submit","#messageboard form",(function(e){e.preventDefault();var a=$(this).serializeObject();$.post("api/",{do:"saveMessageboardMessage",data:a},(function(e){$("#messageboard article").find("textarea").val(""),Socket.Send("Messageboard.AppendMessage",e,{client:["messageboard","client"]}),r(e)}))})).on("click","#messageboard .send_image",(function(){0===AppData.photos.length?$(".from_gallery").hide():$(".from_gallery").show(),$(".messageboard_modal").fadeIn(300)})).on("click","#messageboard .galimage",(function(){l($(this).attr("data-id"))})).on("click","#messageboard .messageboard_modal .close",d).on("click","#messageboard .messageboard_modal .from_gallery",(function(){var e=$(".gallery");e.empty(),AppData.photos.forEach((function(a){e.append('<div class="galimage" data-id="'+a.id+'"><img src="upload/user_photos/'+a.filename+'"></div>')}));var a=$(".messageboard_modal");$(".buttons",a).hide(),$(".gallery",a).show()})).on("click","#messageboard .messageboard_modal .new_photo",(function(){Kiosk.camera(i)})),{Init:o,showDetails:function(e){e&&(Layout.show("messageboard"),o(e),$("#messageboard .messages_container").animate({scrollTop:$("#messageboard .messages_container").prop("scrollHeight")},400))},AppendMessage:r,currentMessages:s,showMsgBoard:n,shown:function(){o(),$("#messageboard .messages_container").animate({scrollTop:$("#messageboard .messages_container").prop("scrollHeight")},400)}}}();
var Moderate=function(){"use strict";var e,t,n,a={},i={};function d(){var a=$("#moderate .moderateList, #landing .landing_elements .moderate_cont .moderateList"),i=$(document.createDocumentFragment()),d=AppData.issues.filter((function(e){if(e.active=void 0!==e.active&&e.active,e.room_id&&e.active)switch(t){case"all":return n&&($.inArray(e.room_id,n)>-1||e.room_id==n||"all"===e.room_id);case"approved":return n&&($.inArray(e.room_id,n)>-1||e.room_id==n||"all"===e.room_id)&&e.approved;case"denied":return n&&($.inArray(e.room_id,n)>-1||e.room_id==n||"all"===e.room_id)&&!1===e.approved;case"waiting":return n&&($.inArray(e.room_id,n)>-1||e.room_id==n||"all"===e.room_id)&&void 0===e.approved}return!1}));AppData.modulsettings.qandausercanvote&&d.sort((function(e,t){let n=0,a=0;e.upvotes&&(n=e.upvotes.length),e.downvotes&&(a=e.downvotes.length);let i=0,d=0;return t.upvotes&&(i=t.upvotes.length),t.downvotes&&(d=t.downvotes.length),i-d-(n-a)})),$.each(d,(function(t,n){var a=e.clone();a.attr("data-index",n.id);var d=AppData.speakers.find((function(e){return e.id==n.speaker})),o=n.username[localState.lang],s=AppData.agenda.find((function(e){return e.id===n.agenda})),r="";AppData.modulsettings.qandashowprogram&&(r+=s?"Agenda: "+s.title[localState.lang]+"<br>":""),r+=d?"To: "+d.name[localState.lang]+"<br>":"",r+=o?"From: "+(n.is_anonym?"Anonymous":o)+"<br>":"",r+=n.email?(n.is_anonym?"Anonymous":n.email)+"<br>":"",a.find(".data-sender").html(r),a.find(".data-question").html(n.question.replace(/(\r\n|\n)/gi,"<br>")),a.find(".data-note").html(n.note?n.note.replace(/(\r\n|\n)/gi,"<br>"):""),a.find(".data-answer").html(n.answer?n.answer.replace(/(\r\n|\n)/gi,"<br>"):""),n.answer?a.find(".answer_cont").removeClass("hidden"):a.find(".answer_cont").addClass("hidden"),n.note?a.find(".note_cont").removeClass("hidden"):a.find(".note_cont").addClass("hidden"),AppData.modulsettings.answer_enabled_for_moderator?$(".edit_question").find(".answer_cont_edit").removeClass("hidden"):$(".edit_question").find(".answer_cont_edit").addClass("hidden"),AppData.modulsettings.note_enabled_for_moderator?$(".edit_question").find(".note_cont_edit").removeClass("hidden"):$(".edit_question").find(".note_cont_edit").addClass("hidden"),a.appendTo(i),n.approved&&(a.find(".approve-btn").addClass("hidden"),a.addClass("approved"),a.children("i").first().removeClass("fa-question").addClass("fa-check")),!1===n.approved&&(a.find(".deny-btn").addClass("hidden"),a.addClass("denied"),a.children("i").first().removeClass("fa-question").addClass("fa-times"));let l=0,u=0;n.upvotes&&(l=n.upvotes.length),n.downvotes&&(u=n.downvotes.length),AppData.modulsettings.qandausercanvote&&a.find(".vote-num").html(l-u),n.approved,a.find(".return-btn").addClass("hidden")})),a.html(i);var o=Language.getItem("moderate-approve");$(".moderate-approve").text(o);var s=Language.getItem("moderate-deny");$(".moderate-deny").text(s);var r=Language.getItem("moderate-return");$(".moderate-return").text(r),$("#moderate, #landing .landing_elements .moderate_cont").find(".no-result").toggle(Boolean(!AppData.issues.length))}function o(){var e=$(this).closest(".item").attr("data-index");$.post("api/",{do:"approveIssues",data:{id:e,approved:!0,client_approved:!0}},(function(t){AppData.issues=t,a[e]="",i[e]="",d(),Socket.Send("refreshModule",{module:["Issues","Stage","Moderate"],appdata:"issues",data:t,callback:["Build","renderList","renderList"]},{client:["client","issues"]}),Stage.Build()}))}function s(e){$("button[class*='filter']").removeClass("bg-primary"),$(this).addClass("bg-primary"),t=e.data.filter,d()}return $(document).on("click","#moderate .item .edit_btn, #landing .landing_elements .moderate_cont .item .edit_btn",(function(){var e=$(this).closest(".item").attr("data-index");$.ajax({url:"api/",method:"post",data:{do:"getIssue",id:e},success:function(e){e.id&&($(".edit_question .item").attr("data-index",e.id),$(".edit_question [name=moderated_issue_id]").val(e.id),$(".edit_question .issue_msg").val(e.question?e.question.replace(/<br>/gi,"\n"):""),$(".edit_question .issue_answer_msg").val(e.answer?e.answer.replace(/<br>/gi,"\n"):""),$(".edit_question .issue_note_msg").val(e.note?e.note.replace(/<br>/gi,"\n"):""),$(".edit_question").show())}})})).on("click",".edit_question .item .save_issue_mod_btn",(function(){var e=$(this).closest(".item").attr("data-index");$.ajax({method:"post",url:"api/",data:{do:"saveModeratedIssue",id:e,moderated_text:$(".edit_question .issue_msg").val(),answer_text:$(".edit_question .issue_answer_msg").val(),note_text:$(".edit_question .issue_note_msg").val()},success:function(e){$(".edit_question").hide(),AppData.issues=e,d(),Socket.Send("refreshModule",{module:["Issues","Stage","Moderate"],appdata:"issues",data:e,callback:["Build","renderList","renderList"]},{client:["client","issues"]})},error:function(){}})})).on("click",".edit_question .item .cancel_issue_mod_btn",(function(){$(".edit_question").hide()})).on("click",".edit_question .item .approve_mod_btn",o).on("click","#moderate .item .approve-btn, #landing .landing_elements .moderate_cont .item .approve-btn",o).on("click","#moderate .item .deny-btn, #landing .landing_elements .moderate_cont .item .deny-btn",(function(){var e=$(this).closest(".item").attr("data-index");$.post("api/",{do:"approveIssues",data:{id:e,approved:!1}},(function(t){AppData.issues=t,a[e]="",i[e]="",d(),Socket.Send("refreshModule",{module:["Issues","Stage","Moderate"],appdata:"issues",data:t,callback:["Build","renderList","renderList"]},{client:["client","issues"]}),Stage.Build()}))})).on("click","#moderate .item .return-btn, #landing .landing_elements .moderate_cont .item .return-btn",(function(){var e=$(this).closest(".item").attr("data-index");$.post("api/",{do:"returnIssues",data:{id:e}},(function(e){AppData.issues=e,d(),Socket.Send("Issues.BuildFromSource",!0,{group:"admin"}),Socket.Send("refreshModule",{module:["Moderate"],appdata:"issues",data:e,callback:["renderList"]},{client:["client"]})}))})).on("click","#moderate .filter-all, #landing .landing_elements .moderate_cont .filter-all",{filter:"all"},s).on("click","#moderate .filter-approved, #landing .landing_elements .moderate_cont .filter-approved",{filter:"approved"},s).on("click","#moderate .filter-waiting, #landing .landing_elements .moderate_cont .filter-waiting",{filter:"waiting"},s).on("click","#moderate .filter-denied, #landing .landing_elements .moderate_cont .filter-denied",{filter:"denied"},s),{Init:function(){e=$("template#tplModerateItem").remove().contents(),t="all",n=AppData.profile.rooms||"",$(".filter-all").addClass("bg-primary"),d(),delete Moderate.Init},BuildFromSource:function(){$.post("api/",{do:"getIssues"},(function(e){AppData.issues=e,d()}))},renderList:d,UpdateModule:function(e){AppData.issues=e,d()},notify:function(e){n.indexOf(e.room_id)>-1&&Notify.show(e)}}}();
var Namecards=function(){function a(){if($("#namecards").find("header").remove(),"ncImage"in AppData.settings){let a=AppData.medias.find((function(a){return a.id==AppData.settings.ncImage}));a&&null!=a.files[localState.lang].file&&$("#namecards").find(".namecardscontainer").attr("style","background-image: url('"+a.files[localState.lang].file+"')")}$("#namecards").find(".namecardscontainer .namecardstitle").html(AppData.profile.name?AppData.profile.name[AppData.settings.lang]:""),$("#namecards").find(".namecardscontainer .namecardsubstitle").html(AppData.profile.slogan?AppData.profile.slogan[AppData.settings.lang]:"")}return{Init:a,showDetails:function(){a()}}}();
var Notes=function(){"use strict";var t;function e(){var e=$("#notes .notesList"),a=$(document.createDocumentFragment());$.each(AppData.notes,(function(e,n){var o=t.clone();o.attr("data-index",n.id),o.find(".data-title").text(n.title),o.appendTo(a)})),e.html(a),$("#notes").find(".no-result").toggle(Boolean(!AppData.notes.length))}function a(){if("notes"in localState){var t=$("#notes-details .data-label"),e=$("#notes-details article"),a=AppData.notes.find((function(t){return t.id===localState.notes.itemIndex}))||[];t.text(a.title||Language.getItem("notes-new")),e.find("input, textarea").val(""),e.find(".delete").toggleClass("hidden",!a.id),$.each(a,(function(t,a){e.find("[name="+t+"]").val(a||"")})),"input"in localState.notes&&$.each(localState.notes.input,(function(t,a){e.find('[name="'+t+'"]').val(a)}))}}function n(t){localState.notes={itemIndex:String($(this).data("index"))||0},a(),t.data&&t.data.title&&$('#notes-details [name="title"]').val(t.data.title),Layout.show("notes-details")}return $(document).on("click","#notes .item",n).on("click","#notes .new",n).on("click","#notes .notes-export",(function(t){t.stopPropagation(),window.open("api/?do=notesExport"),Modal.alert(Language.getItem("notes-alert"))})).on("click","#notes-details form .delete",(function(t){t.preventDefault();var a=$(this),n=$(this).closest("form").find("[name=id]").val();Modal.confirm(Language.getItem("notes-confirm"),(function(){$.post("api/",{do:"removeNote",data:n},(function(t){AppData.notes=t,e(),Layout.hide("notes-details"),a.removeClass("disabled")}))}))})).on("input","#notes-details input, #notes-details textarea",(function(){var t=$(this);t.get(0).hasAttribute("name")&&(localState.notes.input=localState.notes.input||{},localState.notes.input[t.attr("name")]=t.val())})).on("submit","#notes-details form",(function(t){t.preventDefault();var a=$(this),n=a.serializeObject();a.addClass("disabled"),writeDbLog("note saved","","user_logs","note"),$.post("api/",{do:"saveNote",data:n},(function(t){AppData.notes=t,e(),"floating"===AppData.settings.homeScreen&&($("#"+localState.layout[localState.layout.length-2]).show(),$("#"+localState.layout[localState.layout.length-2]).attr("style","background-color: transparent")),Layout.hide("notes-details"),a.removeClass("disabled")}))})),{Init:function(){t=$("template#tplNotesItem").remove().contents(),e(),a(),delete Notes.Init},showDetails:function(t){t&&(null!=localState.notes?t===localState.notes.itemIndex&&0!==localState.notes.itemIndex||(localState.notes.itemIndex=String(t),a()):localState.notes={itemIndex:String(t)},Layout.show("notes-details"))},evtClickItem:n}}();
var Notifications=function(){"use strict";var t;function i(){var i,n=$("#notifications .notificationsList"),o=$(document.createDocumentFragment());$.each(AppData.pushednotifications,(function(n,a){if(void 0!==(i=AppData.notifications.filter((function(t){return t.id===a.notification_id}))[0])){var e=t.clone();e.attr("data-index",i.id),e.find(".data-title").text(i.title[localState.lang]),e.find(".data-pusheddate").text(a.pushed_date),e.appendTo(o)}})),n.html(o),$("#notifications").find(".no-result").toggle(!AppData.notifications.length)}function n(){var t=this.dataset.index,i=AppData.notifications.filter((function(i){return i.id===t}));i[0].canClose=!0,Modal.notification(i[0])}return $(document).on("click","#notifications .item",n),{Init:function(){t=$("template#tplNotificationsItem").remove().contents(),i(),delete Notifications.Init},showDetails:function(t){t&&(null!=localState.notifications?t===localState.notifications.itemIndex&&0!==localState.notifications.itemIndex||(localState.notifications.itemIndex=String(t),n()):localState.notifications={itemIndex:String(t)},Layout.show("notifications-details"))},renderList:i,BuildFromSource:function(){$.post("api/",{do:"getPushedNotifications"},(function(t){AppData.pushednotifications=t,i()}))}}}();
var Ondemandvideos=function(){var d,e,t;function o(){d=$("template#tplOndemandvideosItem").contents(),e=$("template#tplOndemandvideosDetailItem").contents(),t=videojs("ondemandvideo",{controls:!0}),null==localState.ondemandvideos&&(localState.ondemandvideos={group:void 0,itemIndex:void 0}),a(),i(localState.ondemandvideos.group||"")}function n(){AppData.ondemandvideos.sort((function(d,e){return void 0!==d.sort_id&&void 0!==e.sort_id?parseInt(d.sort_id)>parseInt(e.sort_id)?1:-1:0})),AppData.videogroups.sort((function(d,e){return parseInt(d.sortorder)-parseInt(e.sortorder)}))}function a(){var e=$(document.createDocumentFragment()),t=d.clone();n(),$.each(AppData.videogroups,(function(o,n){"1"==n.visible&&(t=d.clone(),n.is_premium&&(AppData.profile.is_premium?t.removeClass("premium_content"):t.addClass("premium_content")),t.attr("data-id",n.id),t.find(".data-name").text(n.title[localState.lang]),t.appendTo(e))})),$("#ondemandvideos #ondemandvideosList").html(e)}function i(d){var t=$(document.createDocumentFragment()),o=e.clone();n();var a=AppData.videogroups.find((function(e){return e.id==d}));null!=a&&$("#ondemandvideos-details .header-secondary .data-label").text(a.title[localState.lang]),$.each(AppData.ondemandvideos,(function(n,i){i.group!=d&&null!=a||((o=e.clone()).attr("data-id",i.id),i.only_premium&&(AppData.profile.is_premium?o.removeClass("premium_content"):o.addClass("premium_content")),""!=i.download_url&&null!=i.download_url?(o.find(".download_link").attr("href",i.download_url),o.find(".download_link").attr("download",i.download_url),o.find(".download_link").removeClass("hidden")):(o.find(".download_link").attr("href",""),o.find(".download_link").attr("download",""),o.find(".download_link").addClass("hidden")),o.find(".data-name").html(i.title[localState.lang]),o.appendTo(t))})),$("#ondemandvideos-details #ondemandvideosdetailsList").html(t)}function l(d){if(""==d)s("");else if("all_groups"==d)a(),Layout.show("ondemandvideos");else{var e=AppData.ondemandvideos.find((function(e){return e.id==d}));if(null!=e)t.reset(),t.src(e.url+"?siteid="+AppData.settings.site_id+"&uid="+AppData.profile.id),t.play(),writeDbLog("play video",String(e.id),"user_logs","ondemandvideos"),$(".ondemandvideo_viewer").attr("data-stream",e.url).css("display","flex").hide().fadeIn(400),localState.ondemandvideos.itemIndex=d,logVideoWatch("start_watching",e.url+"?siteid="+AppData.settings.site_id+"&uid="+AppData.profile.id);else{AppData.videogroups.find((function(e){return e.id==d}))&&s(d)}}}function s(d){i(d||""),localState.ondemandvideos.itemIndex=d,localState.ondemandvideos.group=d,Layout.show("ondemandvideos-details")}return $(document).on("click","#ondemandvideos-details #ondemandvideosdetailsList .item .download_link",(function(d){d.stopPropagation()})),$(document).on("click","#ondemandvideosList .item",(function(d){$(this).attr("data-id")&&s($(this).attr("data-id"))})),$(document).on("click","#ondemandvideosdetailsList .item",(function(d){$(this).attr("data-id")&&l($(this).attr("data-id"))})),$(document).on("click",".ondemandvideo_viewer .close_video",(function(d){t.pause(),localState.ondemandvideos.itemIndex=localState.ondemandvideos.group;$(".ondemandvideo_viewer").attr("data-stream");$(".ondemandvideo_viewer").attr("data-stream","").hide()})),{Init:o,BuildFromSource:function(){$.post("api/",{do:"getOndemandvideos"},(function(d){AppData.ondemandvideos=d.videos,AppData.videogroups=d.video_groups,o()}))},BuildBroadcast:a,showDetails:l,getPlayer:function(){return t}}}();
var ChangePass=($(document).on("submit","#changepass-details #formChangePass",(function(e){e.preventDefault(),$.post("api/",{do:"changePassword",data:$(this).serializeObject()},(function(e){"ok"===e.status?Modal.alert(Language.getItem(e.message),(function(){Layout.hide("changepass-details")})):Modal.alert(Language.getItem(e.message))}))})),$(document).on("click","#changepass-details .showpass",(function(e){e.target.previousElementSibling.type="text",setTimeout((function(){e.target.previousElementSibling.type="password"}),2e3)})),{Init:function(){$("#changepass-details .data-label").text(Language.getItem("profile-change-pass"))}});
var Photos=function(){"use strict";var t,o;function a(){var o=$("#photos .photosList"),a=$(document.createDocumentFragment());$.each(AppData.photos,(function(o,e){var s=t.clone();s.attr("data-index",e.id),s.attr("data-photo_path","upload/user_photos/"+e.filename),s.find(".user_photo").css({"background-image":"url('upload/user_photos/"+e.filename+"')"}),AppData.modulsettings.gallery_marktogallery?s.find(".add_to_gallery").removeClass("hidden"):s.find(".add_to_gallery").addClass("hidden"),s.appendTo(a)})),o.html(a),$("#photos").find(".no-result").toggle(Boolean(!AppData.photos.length)),AppData.modulsettings.gallery_marktosend?$("#photos .send_bulk").show():$("#photos .send_bulk").hide()}function e(t){Kiosk.kiosk_supported()?Kiosk.camera():$("#photos #photo_upload").trigger("click")}function s(){$("#photos .upload_progress .progress-bar").css("width","0"),$("#photos .upload_progress .status").text("0%"),$("#photos .upload_progress").show();var t,o,e;t=$("#photo_upload")[0].files[0],o=function(t){var o=t.split(","),e=new FormData;e.append("image",o[1]),e.append("do","uploadPhoto"),$.ajax({method:"post",url:"api/",data:e,contentType:!1,dataType:"json",cache:!1,processData:!1,xhr:function(){var t=$.ajaxSettings.xhr();return t.upload&&t.upload.addEventListener("progress",(function(t){var o=0,a=t.loaded||t.position,e=t.total;t.lengthComputable&&(o=Math.ceil(a/e*100)),$("#photos .upload_progress .progress-bar").css("width",+o+"%"),$("#photos .upload_progress .status").text(o+"%")}),!0),t},mimeType:"multipart/form-data"}).done((function(t){console.log(t),AppData.photos=t,a(),$("#photos .upload_progress").hide()}))},(e=new FileReader).addEventListener("load",(function(t){o(t.target.result)})),e.readAsDataURL(t)}function l(t){$.ajax({method:"post",url:"api/",data:{do:"uploadPhoto",image:t},success:function(t){AppData.photos=t,a()}})}function i(t){$.ajax({method:"post",url:"api/",data:{do:"removePhoto",id:t},success:function(t){AppData.photos=t,a()}})}function n(){var t=$("#photos .gallery_list .items");t.html(""),$.each(AppData.gallery,(function(a,e){var s=o.clone();s.attr("data-index",e.id),s.find(".gallery_title").html(e.title[localState.lang]),t.append(s)}))}return $(document).on("click","#photos .photoitem .user_photo",(function(){var t=$(this).closest($(".photoitem")),o=$("<div/>").addClass("imageviewer"),a=$("<img/>").attr("src",t.attr("data-photo_path"));o.on("mouseup touchend",(function(t){t.preventDefault(),o.fadeOut(400,(function(){o.remove()}))})),o.append(a),o.appendTo($("body")),o.fadeIn(400)})).on("click","#photos .select_image",(function(){$(this).closest($(".photoitem")).toggleClass("selected"),$(".selected",$("#photos")).length>0?$("#photos .actions").removeClass("disabled"):$("#photos .actions").addClass("disabled")})).on("click","#photos .delete_image",(function(){var t=$(this);Modal.confirm(Language.getItem("photos-confirm-delete"),(function(){i([t.closest($(".photoitem")).attr("data-index")])}))})).on("click","#photos .add_to_gallery",(function(){var t=$(this).closest(".photoitem").attr("data-index");$("#photos .gallery_list .gallery_item").each((function(o,a){$(this).removeClass("added");var e=$(this).attr("data-index"),s=AppData.gallery.find((function(t){return t.id==e}));s&&(s.images.find((function(o){return o.id==t}))&&$(this).addClass("added"))})),$("#photos .gallery_list").attr("data-photoid",t).css({display:"flex"})})).on("click","#photos .gallery_list .gallery_item",(function(){var t=$(this).closest(".gallery_list").attr("data-photoid"),o=$(this).attr("data-index"),a=$(this);$.ajax({method:"post",url:"api/",data:{do:"addImageToGallery",photo_id:t,gallery_id:o},success:function(t){AppData.gallery=t.gallery,"limit_exceeded"==t.status?Modal.alert(Language.getItem("photos-limit-exceeded").replace("#maxlimit#",AppData.modulsettings.gallery_maximgpergallery)):("added"==t.status&&a.addClass("added"),"removed"==t.status&&a.removeClass("added")),Socket.Send("Gallery.BuildFromSource",null)}})})).on("click","#photos .delete_bulk",(function(){Modal.confirm(Language.getItem("photos-confirm-delete"),(function(){var t=[];$("#photos .photosList .photoitem.selected").each((function(){t.push($(this).attr("data-index"))})),i(t)}))})).on("click","#photos .send_bulk",(function(){""===AppData.profile.email?Modal.alert("Krjk adja meg az email cmt a profiljban.",(function(){Layout.show("profile")})):Modal.confirm("Biztosan elkldi a fotkat?",(function(){var t=[];$("#photos .photosList .photoitem.selected").each((function(){t.push($(this).attr("data-index"))})),$.ajax({method:"post",url:"api/",data:{do:"markPhotosToSend",id:t},success:function(t){AppData.photos=t,a(),Modal.resultconfirmation({title:"Sikeres fotklds.",text:"",canClose:!0},(function(){$("#modal").hide()}))}})}))})).on("click","#photos .new",e).on("click","#photos .gallery_list .close",(function(){$("#photos .gallery_list").attr("data-photoid","").css({display:"none"})})),{Init:function(){t=$("template#tplPhotosItem").remove().contents(),o=$("template#gallery_list_item").remove().contents(),a(),n(),Kiosk.addCameraListener("camera",l),$("#photos #photo_upload").on("change",s),delete Photos.Init},evtClickItem:e,gallerySelect:n,buildFromSource:function(){$.ajax({method:"post",url:"api/",data:{do:"getPhotos"},success:function(t){AppData.photos=t,a()}})},renderList:a}}();
var Points=function(){"use strict";function t(){$.post("api/",{do:"getMyPoints"},(function(t){$("#points .data-points").text(t),$("#points .results").text(t)}))}function n(t){Number(t)>=0&&$.post("api/",{do:"sendExhibitionPoints",points:Number(t)},(function(t){$("#points .results").text(t)}))}function i(t){t&&$.post("api/",{do:"sendQuizPoints",points:Number(t)},(function(t){$("#points .results").text(t)}))}return $(document).on("show","#points",t).on("click","#points .get",t).on("click","#points .set-exhibition",(function(){n(200)})).on("click","#points .set-quiz",(function(){i(100)})),{Init:function(){},sendExhibitionPoints:n,sendQuizPoints:i}}();
var Presentation=function(){"use strict";var e,t;return $((function(){})),{Init:function(){},gotoTimestamp:function(t){undefined.gotoTimestamp(t.slideIndex,t.stepIndex,t.timeOffset,!0),localState.presentationState={slideIndex:e.timestamp().slideIndex(),stepIndex:e.timestamp().stepIndex(),timeOffset:e.timestamp().timeOffset()}},gotoSlide:function(e){$("#iSpringFrame_attendee").get(0).contentWindow.postMessage({action:"goToSlide",slide:e})},firstSlide:function(){$("#iSpringFrame_attendee").get(0).contentWindow.postMessage({action:"firstSlide"})},nextSlide:function(){$("#iSpringFrame_attendee").get(0).contentWindow.postMessage({action:"nextSlide"})},prevSlide:function(){$("#iSpringFrame_attendee").get(0).contentWindow.postMessage({action:"prevSlide"})},toggleBlank:function(){$("#iSpringFrame_attendee").contents().find("body").toggle()},source:function(e){var t=AppData.medias.find((function(t){return t.id==e})),n="";null!=t&&null!=t.files[localState.lang]&&(n=t.files[localState.lang].foldername+"/");var i=$("#iSpringFrame_attendee"),a=n+"index.html";e&&a!==i.attr("src")&&i.get(0).contentWindow.postMessage({action:"addSrc",url:a}),e||setTimeout((function(){i.get(0).contentWindow.postMessage({action:"removeSrc"})}),1e3)},syncVideo:function(e){!0,clearTimeout(t);var n=$("#iSpringFrame").contents().find("video").get(0),i=e,a=n.currentTime;i>0&&n.currentTime>0&&(a+.2<i&&(n.currentTime+=parseFloat((i-a+.3).toFixed(1))),a-.2>i&&(n.currentTime-=parseFloat((a-i-.3).toFixed(1))))},show:function(){if(!$(".speaker_presentation").is(":visible")&&!$(".presentation").is(":visible")){AppData.presentations[localState.currentChannel+"_state"]&&AppData.presentations[localState.currentChannel+"_state"];$(".presentation").fadeIn(400,(function(){}))}},hide:function(){$(".presentation").fadeOut(400)}}}();
var Profile=function(){$("#gdpr").attr("style","display: none !important");var e=!0;function a(){var a=$("#profile article"),n=$(document.createDocumentFragment());$.each(AppData.select_fields.USER_POST[localState.lang],(function(e,a){n.append('<option value="'+e+'" '+(AppData.profile.post[localState.lang]===e?"selected":"")+">"+a+"</option>")})),$("select.profile-post").html(n),n=$(document.createDocumentFragment()),$.each(AppData.select_fields.COMPANY_ACTIVITY[localState.lang],(function(e,a){n.append('<option value="'+e+'" '+(AppData.profile.companytype[localState.lang]===e?"selected":"")+">"+a+"</option>")})),$("select.profile-industry").html(n),n=$(document.createDocumentFragment()),$.each(AppData.select_fields.DEGREE[localState.lang],(function(e,a){n.append('<label><p><input name="degree[]" type="checkbox" value="'+e+'" '+(AppData.profile.degree[localState.lang].includes(e)?"checked":"")+">"+a+"</input></p></label>")})),$("span.profile-degree").html(n),n=$(document.createDocumentFragment()),$.each(AppData.select_fields.WHERE_HEAR[localState.lang],(function(e,a){n.append('<label><p><input name="wherehear[]" type="checkbox" value="'+e+'" '+(AppData.profile.wherehear[localState.lang].includes(e)?"checked":"")+">"+a+"</input></p></label>")})),$("span.profile-wherehear").html(n),n=$(document.createDocumentFragment()),$.each(AppData.select_fields.ATTENDED[localState.lang],(function(e,a){n.append('<label><p"><input name="attended[]" type="checkbox" value="'+e+'" '+(AppData.profile.attended[localState.lang].includes(e)?"checked":"")+">"+a+"</input></p></label>")})),$("span.profile-attended").html(n),n=$(document.createDocumentFragment()),$.each(AppData.select_fields.REGISTRATIONDAY[localState.lang],(function(e,a){n.append('<label><p><input name="registrationday[]" type="checkbox" value="'+e+'" '+(AppData.profile.registrationday[localState.lang].includes(e)?"checked":"")+">"+a+"</input></p></label>")})),$("span.profile-attending").html(n),n=$(document.createDocumentFragment()),$.each(AppData.select_fields.SOLUTIONS[localState.lang],(function(e,a){n.append('<label><p><input name="solutions[]" type="checkbox" value="'+e+'" '+(AppData.profile.solutions[localState.lang].includes(e)?"checked":"")+">"+a+"</input></p>")})),$("span.profile-solutions").html(n),$.each(AppData.profile,(function(e,t){var n=a.find('[name="'+e+'"]');"mobile"===e&&"+36-20/0000000"===t&&(t=AppData.profile.foreignmob),"object"==typeof t&&(t=t[localState.lang]),n.is("[type=checkbox]")?n.prop("checked",t):n.val(decodeEntities(t)),n=null})),AppData.nativesettings.appstore_user!=AppData.profile.id&&(a.find(".utype-title").html(AppData.profile.is_premium?"Premium user":"Standard user"),a.find(".utype-date").html(AppData.profile.is_premium?"("+AppData.profile.premium_date+")":"")),AppData.profile&&AppData.profile.img&&a.find(".data-img").attr("data-src","upload/users/"+AppData.profile.img+"?r="+Math.random()),e&&(t(),e=!1),AppData.modulsettings.showchangepass?$("#profile .change-pass-cont").show():$("#profile .change-pass-cont").hide(),AppData.modulsettings.showsociallinks?$("#profile .social").show():$("#profile .social").hide(),$("#hamburger").find(".data-user").html(AppData.profile.name[localState.lang]),a.find(".changeLang").val(localState.lang),a.toggleClass("disabled",$.isEmptyObject(AppData.profile)),a.find(".privacy").toggle(AppData.modulsettings.showprivacy),$("#profile .phone-input").inputmask("+36-(20)|(30)|(31)|(50)|(70)/9{1,7}",{definitions:{X:{validator:"[xX]",casing:"upper"}}}),a=null}function t(){var e,a=$(".changeLang"),t=$(document.createDocumentFragment());$.post("api/",{do:"getTranslations"},(function(n){AppData.translations=n,(e=AppData.translations.filter((function(e){return!0===e.active}))).sort((function(e,a){return parseInt(e.sort_id)>parseInt(a.sort_id)?1:-1})),$.each(e,(function(e,a){t.append('<option value="'+a.translation_id+'" '+(localState.lang===a.translation_id?"selected":"")+">"+a.translation_name+"</option>")})),a.html(t)}))}return $(document).on("click",".change-pass",(function(){$("#changepass-details input").val(""),Layout.show("changepass-details")})),$(document).on("change","#profile select.changeLang",(function(){Language.Init(this.value)})),$(document).on("change","#profile .uploadImage",(function(){!function(e){var a=$("#profile .avatar-wrapper"),t=a.find("img"),n=a.find(".upload, .remove"),i=a.find("figcaption");if(e.files&&e.files[0]){var o=new FormData;o.append("do","uploadAvatar"),o.append("image",e.files[0]),$.ajax({url:"api/",type:"POST",data:o,contentType:!1,processData:!1,success:function(e){writeDbLog("profile img uploaded","","user_logs","users"),Socket.Send("Attendees.updateAvatar",{img:e,id:AppData.profile.id},{client:"client"}),Socket.Send("Users.updateAvatar",{img:e,id:AppData.profile.id},{client:"admin"}),t.attr("src",e),n.removeClass("animated zoomOut fast").addClass("animated bounceIn fast"),t.show(),i.text(""),$("div.main").filter("#hamburger").find(".data-img").attr("src",e)},error:function(){n.removeClass("animated zoomOut fast").addClass("animated bounceIn fast"),t.show(),i.text("")},complete:function(){},xhr:function(){var e=$.ajaxSettings.xhr();return e.upload.onprogress=function(e){if(e.lengthComputable){var a=Math.round(100*e.loaded/e.total);i.text(a),100===a&&i.text(100)}},e}}),requestAnimationFrame((function(){n.removeClass("animated bounceIn fast").addClass("animated zoomOut fast"),t.hide()}))}}(this),this.value=""})),$(document).on("change","#profile .privacy input",(function(){var e=$(this),a=e.closest("fieldset").find("input");e.siblings("input[type=hidden]").val(e.prop("checked")),e.is(a.first())&&!e.prop("checked")&&a.not(e).prop("checked",!1),!e.is(a.first())&&e.prop("checked")&&a.first().prop("checked",!0),a.first().prop("checked")||Modal.alert(AppData.languages[localState.lang]["profile-notpublicalert"]),e=a=null})),$(document).on("click","#profile .remove",(function(){Modal.confirm(Language.getItem("profile-delete-image"),(function(){$.post("api/",{do:"removeAvatar"},(function(e){$("#profile .data-img").attr("src","img/profile-picture-placeholder.png"),$("#hamburger").find(".data-img").attr("src","img/profile-picture-placeholder.png"),Socket.Send("Attendees.updateAvatar",{id:AppData.profile.id,img:"img/profile-picture-placeholder.png"},{client:"client"}),Socket.Send("Users.BuildFromSource",!0,{client:"admin"})}))}))})),$(document).on("reset","#profile #formProfile",(function(e){e.preventDefault(),a()})),$(document).on("submit","#profile #formProfile",(function(e){e.preventDefault();var a=$(this).serializeArray();writeDbLog("save profile","","user_logs","users"),$.post("api/",{do:"saveProfile",data:a},(function(e){1!=e.error?(AppData.profile=e.profile,Settings.Init(),$("#hamburger").find(".data-user").html(AppData.profile.name[localState.lang]),Attendees.updateUser({udata:e.udata,id:AppData.profile.id}),Socket.Send("Attendees.updateUser",{udata:e.udata,id:AppData.profile.id},{client:"client"}),Socket.Send("Chat.BuildFromSource",!0,{client:"client"}),Socket.Send("Users.BuildFromSource",!0,{client:"admin"}),Modal.alert(Language.getItem("bookings-saved"))):Modal.alert(Language.getItem(e.message))}))})),$(document).on("focusin focusout","#profile input",(function(e){"focusout"===e.type&&this.blur(),$(this).closest("fieldset").toggleClass("focus","focusin"===e.type)})),{Init:a,BuildFromSource:function(e){$("#hamburger").find(".data-img").attr("src",e+"?r="+Math.random()),$("#profile article").find(".data-img").attr("src",e+"?r="+Math.random())},DeleteProfilePictures:function(){$("#hamburger").find(".data-img").attr("src","img/profile-picture-placeholder.png"),$("#profile .data-img").attr("src","img/profile-picture-placeholder.png")},buildLanguages:t,update:function(){$.post("api/",{do:"getProfile"},(function(e){AppData.profile=e.profile,Qrcode.render(),Roomlist.render(),AppData.user_fields=e.user_fields,Navigation.BuildFromSource(),a(),e=null}))}}}();
var Qrcode=function(){function e(){if(AppData.profile.qrcode){$("#qrcode .qrcode").empty();new QRCode($("#qrcode .qrcode").get(0),{text:AppData.profile.qrcode,width:256,height:256,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H})}}return{Init:function(){e()},render:e,update:function(){$.post("api/",{do:"getProfile"},(function(e){AppData.profile=e.profile,Qrcode.render(),e=null}))}}}();
var Quiz=function(){"use strict";var t,e,a,i,n,o=0,l=0,d=0,s=0,r=!1,u=null;let c=!1;function p(t){t?h((function(){m()})):m()}function m(){let t=AppData.quiz.find((function(t){return t.selected&&(t.pushChannel==localState.currentChannel||"all"==t.pushChannel)}));t?(g(t.id),t.start&&b()):v()}function f(o){if(l=d=s=0,r=!1,$("#quiz").find("header .close-main").parent().html('<h3 class="text-upper text-bold">'+Language.getItem("quiz-title")+"</h3>"),$("#quiz").find("header .close-main").remove(),$("#quiz").find("header .hamburger").remove(),$("#quiz").find(".closebutton").remove(),$("#quiz").find("header .logo").css("pointerEvents","none"),c=null!=o,"quiz"in localState){$("#quiz article");var u,p,m=$("#quiz header"),f=$("#quiz progress"),h=$(document.createDocumentFragment());let l,r,c=AppData.quiz.filter((function(t){return null==o?t.id==localState.quiz.itemIndex:t.group==o}));$("#quiz .data-title-group").html(""),null!=o&&(l=AppData.quizgroups.find((function(t){return t.id==o})),l&&$("#quiz .data-title-group").html(l.title[localState.lang])),$("#quiz").find(".forms").empty();for(let z in c){let b,q=AppData.quiz.find((function(t){return t.id===c[z].id}))||AppData.quiz[0];if(!q)return!1;r=e.clone(),r.attr("data-quizid",q.id),r.attr("data-submitted","not"),r.find("[name=id]").val(q.id),r.find("[name=quiz]").val(q.id),r.find("[type=submit] span").html(Language.getItem("save")),r.find(".not_voted_text").html(Language.getItem("not-voted-num")),r.find(".vote_not_allowed").html(Language.getItem("vote-not-allowed")),h=$(document.createDocumentFragment()),$("#quiz .not_voted").addClass("hidden"),b=null==o?parseInt(q.timer):parseInt(l.timer),b>0?r.find("[type=submit]").addClass("hidden"):"1"==AppData.profile.can_vote&&r.find("[type=submit]").removeClass("hidden"),"1"!=AppData.profile.can_vote?r.find(".vote_not_allowed").removeClass("hidden"):r.find(".vote_not_allowed").addClass("hidden"),i=q.min_answers,n=q.max_answers,d=s=parseFloat(b),s>0?(m.find(".data-label").text(d.toFixed(0)).show(),m.find(".data-icon").addClass("fas fa-stopwatch").show()):(m.find(".data-label").hide(),m.find(".data-icon").hide());if(AppData.profile.quiz_answers){AppData.profile.quiz_answers.sort((function(t,e){return t.created_at<e.created_at}));var g=AppData.profile.quiz_answers.find((function(t){return t.quiz===q.id}));g&&g.id}if(f.attr("value",d.toFixed(2)),f.attr("max",s),u=t.clone(),r.find(".data-title-quiz").html(q.question[localState.lang]),$.each(q.answer,(function(t,e){(p=a.clone()).toggleClass("correct",e.correct),b>0?p.find("input").attr("disabled","disabled"):p.find("input").removeAttr("disabled"),p.attr("data-points",e.points);var i="";null!=e[localState.lang]&&(""!==e[localState.lang].image&&(i+='<img src="'+e[localState.lang].image+'">'),""!==e[localState.lang].text&&(i+="<div>"+e[localState.lang].text+"</div>")),p.find(".data-label").html(i),p.find("input").val(e.id),p.appendTo(u)})),u.appendTo(h),r.find(".items").html(h),q.sponsormedia){var v=AppData.medias.filter((function(t){return t.id===q.sponsormedia}))[0];r.find(".vote_sponsormedia").find(".votemediaimg").attr("src","upload/media/"+v.filename),r.find(".vote_sponsormedia").show()}r.appendTo($("#quiz").find(".forms")),r.find(".survey-radio").addClass(q.layout),r.find("[type=submit]").addClass("disabled"),r.find("form").show(),u=null}}}function h(t){$.post("api/?v="+Math.random(),{do:"getQuiz"},(function(e){AppData.quiz=e,e=null,null!=t&&"function"==typeof t&&t()}))}function g(t){t&&(null==t.group&&(localState.quiz.itemIndex=String(t)),clearTimeout(u),f(t.group),Layout.show("quiz"))}function v(){clearTimeout(u),Layout.hide("quiz")}function z(){var t=$("#quiz progress"),e=$("#quiz header .data-label");t.attr("value",d.toFixed(2)),e.text(d.toFixed(0)),t=e=null}function b(){if(s>0){var t=$("#quiz article");clearTimeout(u),d=parseFloat(s),z(),"1"==AppData.profile.can_vote&&(t.find("[type=checkbox]").removeAttr("disabled"),t.find("[type=submit]").removeClass("hidden")),u=setTimeout(q,100)}}function q(){var t=$("#quiz article");if(d<=0||!t.is(":visible")){if(clearTimeout(u),c){t.find("form").each((function(){"submitted"!=$(this).attr("data-submitted")&&_($(this))}))}else r||_(t.find("form"));return!1}d=Math.round(10*(d-.1))/10,u=setTimeout(q,100),z(),t=null}function _(t){setTimeout((function(){t.trigger("submit"),$("#quiz article").find("[type=checkbox]").attr("disabled","disabled")}),Math.floor(1401*Math.random()+100))}return localState.quiz=localState.quiz||{},localState.quiz.itemIndex=localState.quiz.itemIndex||0,$(document).on("change","#quiz form input",(function(){o.length>=i&&$(this).closest("form").find("[type=submit]").removeClass("disabled")})).on("change","#quiz input[type=checkbox]",(function(){if("1"!=AppData.profile.can_vote)return;let t=$(this).closest("form");var e=$(this).closest("label"),a="state-checked animated pulse";o=$(".quiz_answer input[type=checkbox]:checked",t).length,1==n?($(".quiz_answer input[type=checkbox]",t).prop("checked",!1),$(".quiz_answer",t).toggleClass(a,!1),$(this).prop("checked",!0)):o>n&&$(this).prop("checked",!1),e.toggleClass(a,$(this).prop("checked")),(o=$(".quiz_answer input[type=checkbox]:checked",t).length)>=i?$(this).closest("form").find("[type=submit]").removeClass("disabled"):$(this).closest("form").find("[type=submit]").addClass("disabled"),l=0,t.find(".state-checked").each((function(){var t=parseInt($(this).attr("data-points"));l+=isNaN(t)?0:t}))})).on("submit","#quiz form",(function(t){if(t.preventDefault(),c||clearTimeout(u),"1"==AppData.profile.can_vote){var e=$(this),a=e.closest("form"),i=e.serializeObject()||{},n=new FormData($(this).get(0));a.attr("data-submitted","submitted"),writeDbLog("submit",i.id,"user_logs","quiz"),r=!0,n.append("points",l),l>0?n.append("time",(s-d).toFixed(2)||1):n.append("time",s.toFixed(2)),n.append("do","sendQuizPoints"),e.find("[type=checkbox]").attr("disabled","disabled"),e.find("[type=submit]").addClass("hidden"),$.ajax({method:"post",url:"api/",processData:!1,contentType:!1,data:n,success:function(t){t.error&&(Modal.alert(Language.getItem(t.error)),$(".quiz_answer input[type=checkbox]",a).prop("checked",!1),$(".quiz_answer",a).toggleClass("state-checked animated pulse",!1),"yes"==t.group_only_correct&&(e.find("[type=checkbox]").prop("disabled",!1),e.find("[type=submit]").removeClass("hidden"))),c&&t.voted==t.group_max&&clearTimeout(u)}})}})),{Init:function(){t=$("template#tplQuizRadio").contents(),$("template#tplQuizRadio").remove(),a=$("template#tplQuizRadioItem").contents(),$("template#tplQuizRadioItem").remove(),e=$("template#tplQuizForm").contents(),$("template#tplQuizForm").remove(),f(),p(!1),delete Quiz.Init},BuildFromSource:h,showQuestion:g,showResults:function(t){var e=$("#quiz article");e.find("[type=checkbox]").attr("disabled","disabled"),e.find("[type=submit]").addClass("hidden");for(let e in t){var a=t[e];if(!a)return!1;$.each(a,(function(t,a){let i=$("[data-quizid='"+e+"']");$(".items .item label",i).eq(t).attr("data-result",parseFloat(a.result).toFixed(1)+"%").addClass("show_result");let n=parseFloat(a.result).toFixed(1)+"%";switch(a.resultas){case"percentage":n=parseFloat(a.result).toFixed(1)+"%";break;case"count":n=a.count+" "+AppData.languages[localState.lang]["quiz-vote"];break;case"both":n=a.count+" "+AppData.languages[localState.lang]["quiz-vote"]+" ("+parseFloat(a.result).toFixed(1)+"%)"}AppData.modulsettings.show_not_voted_count&&($(".not_voted",i).removeClass("hidden"),$(".not_voted .not_voted_num",i).html(parseInt(a.can_vote)-parseInt(a.total)).show()),$(".items .item label",i).eq(t).find(".result_container").html('<div class="result_container_text">'+n+'</div><div class="result_container_progress"></div>'),$(".items .item label",i).eq(t).find(".result_container_progress").css("width",parseFloat(a.result).toFixed(1)+"%")}))}},showCorrect:function(){var t=$("#quiz article");t.find("[type=checkbox]").attr("disabled","disabled"),t.find("[type=submit]").addClass("hidden"),$("#quiz .items .item label.correct").addClass("marked")},hideQuestion:v,startTimer:b,testVote:function(t){var e=$("#quiz:visible");if(e.length){var a=e.find("label").length;e.find("label").eq(Math.floor(Math.random()*(a-1))).trigger("click"),!0===t&&setTimeout((function(){e.find("[type=submit]").trigger("click")}),1e3*(Math.floor(15*Math.random())+1))}},updateQuizGroups:function(){$.post("api/",{do:"getQuizGroups"},(function(t){AppData.quizgroups=t,t=null}))},showShownQuiz:p}}();
var Roomlist=function(){function t(){if(""!=AppData.profile.roomlist){let t=AppData.profile.roomlist,n=/#([A-Za-z0-9 ;:.,?!\/%_=\-]*)#/gi,a=n.exec(t);for(;null!=a;){let l=a[1].split(";");4==l.length&&(t="1"==l[0]?t.replace(a[0],'<button class="btn bcbtn" data-broadcast="'+l[2].trim()+'" data-channel="'+l[3]+'">'+l[1].trim()+"</button>"):"2"==l[0]?t.replace(a[0],'<button class="btn vstagebtn" data-room="'+l[2].trim()+'" data-channel="'+l[3]+'">'+l[1].trim()+"</button>"):t.replace(a[0],'<button class="btn external_link" data-url="'+l[2].trim()+'" data-channel="'+l[3]+'">'+l[1].trim()+"</button>")),a=n.exec(t)}$("#roomlist .item").html(t)}}return{Init:function(){$(document).on("click","#roomlist .vstagebtn",(function(){let t=$(this).attr("data-room"),n=$(this).attr("data-channel");null!=n&&"undefined"!=n&&""!=n&&Channels.setChannel(n),openTrueConfCall(t,"workshop"),$("#landing .navplusbutton i").hasClass("fa-minus")&&$("#landing .navplusbutton .open-main").trigger("mouseup")})),$(document).on("click","#roomlist .bcbtn",(function(){let t=$(this).attr("data-broadcast"),n=$(this).attr("data-channel");null!=n&&"undefined"!=n&&""!=n&&Channels.setChannel(n),Layout.hideAll(),Broadcast.playStreamByURL("https://"+t),$("#landing .navplusbutton i").hasClass("fa-minus")&&$("#landing .navplusbutton .open-main").trigger("mouseup")})),$(document).on("click","#roomlist .external_link",(function(){let t=$(this).attr("data-url"),n=$(this).attr("data-channel");null!=n&&"undefined"!=n&&""!=n&&Channels.setChannel(n),window.open(t)})),t()},render:t,update:function(){$.post("api/",{do:"getProfile"},(function(t){AppData.profile=t.profile,Roomlist.render(),t=null}))}}}();
var scwowzaplaying=!1,Soundchannels=function(){var n,a={settings:{}};var e,s,t,o,i=new wowzawebrtc,l=!1;function d(){var a=$(document.createDocumentFragment()),e=n.clone();AppData.translator.sort((function(n,a){return void 0!==n.sort_id&&void 0!==a.sort_id?parseInt(n.sort_id)>parseInt(a.sort_id)?1:-1:0})),$.each(AppData.translator,(function(s,t){null!=t.visible&&t.visible&&((e=n.clone()).attr("data-id",t.id),e.find(".data-name").text(t.name[localState.lang]).attr("data-id",t.id).attr("data-server_url",t.server_url),e.appendTo(a))})),$("#soundchannels #soundchannelsList").html(a)}function u(n=""){$(this);var i=AppData.translator.find((function(a){return a.id==n}));if(i&&""!=i.wowza_stream&&null!=i.wowza_stream&&i.use_hls.indexOf(AppData.profile.group)>-1)scwowzaplaying!=n?($("#soundchannelsList .item").removeClass("publishing"),$("#default_nav").find(".open-main.soundchannels").removeClass("greensoundchannelsbutton"),$("#minimal_nav").find(".open-main.soundchannels").removeClass("greensoundchannelsbutton"),videojs("my-video").muted(!0),scwowzaplaying=n,o.reset(),setTimeout((function(){o.src(i.wowza_stream),o.play(),o.muted(!1)}),100),writeDbLog("start soundchannel",String(i.id),"user_logs","translator"),$("#soundchannels div[data-id='"+n+"']").addClass("publishing"),$("#default_nav").find('.open-main.soundchannels[data-targetid="'+n+'"]').addClass("greensoundchannelsbutton"),$("#minimal_nav").find('.open-main.soundchannels[data-targetid="'+n+'"]').addClass("greensoundchannelsbutton"),Layout.hide("soundchannels")):(scwowzaplaying=!1,o.paused(),o.reset(),o.muted(!0),videojs("my-video").muted(!1),$("#soundchannelsList .item").removeClass("publishing"),$("#default_nav").find(".open-main.soundchannels").removeClass("greensoundchannelsbutton"),$("#minimal_nav").find(".open-main.soundchannels").removeClass("greensoundchannelsbutton"));else{if(s=n,n==t)return $("#soundchannelsList .item").removeClass("publishing"),m(),e=void 0,void(t=void 0);if("turnoffTranslation"!=n&&(t=n),null!=e&&l&&($("#soundchannelsList .item").removeClass("publishing"),m(),e=void 0),"turnoffSoundchannels"==n)return $("#soundchannelsList .item").removeClass("publishing"),void(null!=e&&l&&(m(),e=void 0));var d=AppData.translator.find((function(a){return a.id==n}));d&&(a={settings:{playSdpURL:d.signaling_url,playApplicationName:d.application_name,playStreamName:d.stream_name}},l?(c(a.settings),$("#soundchannelsList .item[data-id='"+n+"']").addClass("publishing"),$("#default_nav").find('.open-main.soundchannels[data-targetid="'+n+'"]').addClass("greensoundchannelsbutton"),$("#minimal_nav").find('.open-main.soundchannels[data-targetid="'+n+'"]').addClass("greensoundchannelsbutton")):(r(p,v,g),$("#soundchannelsList .item[data-id='"+n+"']").addClass("publishing"),$("#default_nav").find('.open-main.soundchannels[data-targetid="'+n+'"]').addClass("greensoundchannelsbutton"),$("#minimal_nav").find('.open-main.soundchannels[data-targetid="'+n+'"]').addClass("greensoundchannelsbutton")),e=d.stream_name,$("#remoteSoundchannel").get(0).muted=!1,$("#remoteSoundchannel").get(0).play())}}$(document).on("click","#soundchannelsList .item",(function(){u($(this).attr("data-id"))}));const r=(n,e,s)=>{i.on({onError:n,onStateChanged:n=>{console.log("state.connectionState",n.connectionState),"connected"===n.connectionState?(console.log("connected in"),e()):"close"===n.connectionState?console.log("closed"):(s(),console.log("stopped in"))}}),i.set({videoElementPlay:document.getElementById("remoteSoundchannel")}),console.log("init"),l=!0,c(a.settings)},c=n=>{console.log("start"),t=s,h(n).then((()=>{console.log("updated start"),i.play(),videojs("my-video").muted(!0),Layout.hide("soundchannels")}))},m=()=>{null!=i.wowzaPeerConnectionPlay&&(i.stop(),$("#soundchannelsList .item").removeClass("publishing"),$("#default_nav").find(".open-main.soundchannels").removeClass("greensoundchannelsbutton"),$("#minimal_nav").find(".open-main.soundchannels").removeClass("greensoundchannelsbutton"),console.log("play finished"),e=void 0,t=void 0,videojs("my-video").muted(!1))},h=n=>{a.settings=n;let e={};for(let a in n){let s=a.substring(4);s=s[0].toLowerCase()+s.slice(1),e[s]=n[a]}return i.set(e)},v=()=>{a.playing=!0},g=()=>{a.playing=!1},p=n=>{let s;(s=n.message?n.message:n,console.log(s),s.indexOf("Waiting for stream")>-1)?c(a.settings):($("#soundchannelsList .item").removeClass("publishing"),e=void 0,t=void 0,videojs("my-video").muted(!1),$("#default_nav").find(".open-main.soundchannels").removeClass("greensoundchannelsbutton"),$("#minimal_nav").find(".open-main.soundchannels").removeClass("greensoundchannelsbutton"),Modal.alert(Language.getItem("channel-not-available")))};return{Init:function(){n=$("template#tplSoundchannelsItem").remove().contents(),d(),o=videojs("wowzaSoundchannel")},BuildFromSource:function(){$.post("api/",{do:"getTranslator"},(function(n){AppData.translator=n,d()}))},showOnAir:function(n){n&&($('#soundchannelsList div[data-id="'+n+'"]').addClass("available"),$("#default_nav").find('.open-main.soundchannels[data-targetid="'+n+'"]').addClass("available"),$("#minimal_nav").find('.open-main.soundchannels[data-targetid="'+n+'"]').addClass("available"))},streamFinished:function(n){n&&($('#soundchannelsList div[data-id="'+n+'"]').removeClass("available"),$("#default_nav").find('.open-main.soundchannels[data-targetid="'+n+'"]').addClass("available"),$("#minimal_nav").find('.open-main.soundchannels[data-targetid="'+n+'"]').addClass("available"),n==s&&m())},showDetails:function(n){n&&(null!=localState.soundchannels?n===localState.soundchannels.itemIndex&&0!==localState.soundchannels.itemIndex||(localState.soundchannels.itemIndex=String(n)):localState.soundchannels={itemIndex:String(n)},u(n))},stopWebRTC:m}}();
var SpeakerPresentation=function(){"use strict";let e,n,t,i,r,a,o=!1,s=0,l=0,p=[],c=!1,d=[];function f(e){AppData.presentations=e.presentations,d=[],$.each(AppData.presentations,(function(e,n){n.speaker.indexOf(AppData.profile.id)>-1&&1==n.onair&&d.push(n.channel)}))}function u(){var e=parseInt(l,10),n=Math.floor(e/3600),t=Math.floor((e-3600*n)/60),i=e-3600*n-60*t;n<10&&(n="0"+n),t<10&&(t="0"+t),i<10&&(i="0"+i),$(".timer",$(".speaker_presentation")).html(n+":"+t+":"+i)}function m(){e.gotoFirstSlide(),w()}function S(){e.gotoNextStep(),v(),w(),console.log("next"),1==AppData.profile.presi_control&&(d.length>0&&Socket.Send("Presentation.nextSlide",null,{client:["display","client"],channel:d}),Socket.Send("SpeakerPresentation.nextSlideOwn",{client:"client"},{uid:p}))}function g(){e.gotoPreviousSlide(),v(),w(),1==AppData.profile.presi_control&&(d.length>0&&Socket.Send("Presentation.prevSlide",null,{client:["display","client"],channel:d}),Socket.Send("SpeakerPresentation.prevSlideOwn",{client:"client"},{uid:p}))}function k(){$("#iSpringFrame").contents().find("body").toggle()}function v(){$("#iSpringFrame").contents().find("video").each((function(){var e=this;e.ontimeupdate=function(){o||(o=!0,Socket.Send("Presentation.syncVideo",e.currentTime),a=setTimeout((function(){o=!1}),750))}}))}function w(){localState.presentationState={slideIndex:t.timestamp().slideIndex(),stepIndex:t.timestamp().stepIndex(),timeOffset:t.timestamp().timeOffset()}}return $((function(){localState.presentation})),{Init:function(){window.ispringPresentationConnector={},ispringPresentationConnector.register=function(i){e=i.view().playbackController(),e.gotoFirstSlide(!0),t=e.clock(),n=i.view().soundController(),n.mute(!0),e.slideChangeEvent().addHandler((function(e){}))},$(document).on("keydown",(function(e){if($(".speaker_presentation").is(":visible")){e.wdich||e.keyCode;var n=e.key;if(["F11","F12"].includes(n))return!0;e.preventDefault(),["PageDown"," ","ArrowDown","ArrowRight"].includes(n)&&S(),["PageUp","Backspace","ArrowUp","ArrowLeft"].includes(n)&&g(),["Escape","F5"].includes(n)&&m(),["."].includes(n)&&k()}})),f({presentations:AppData.presentations})},gotoTimestamp:function(n,t,i){e.gotoTimestamp(n,t,i),w()},gotoSlide:function(n){e.gotoSlide(n),w()},firstSlide:m,nextSlide:S,prevSlide:g,nextSlideOwn:function(){e.gotoNextStep(),v(),w()},prevSlideOwn:function(){e.gotoPreviousSlide(),v(),w()},toggleBlank:k,setTimer:function(e){clearInterval(i),c=!1,(""===e||isNaN(e))&&(e=0),l=parseInt(e),s=parseInt(e),$(".timer",$(".speaker_presentation")).removeClass("warning finalwarning"),u()},startTimer:function(){!c&&l>0&&($(".timer",$(".speaker_presentation")).removeClass("warning finalwarning"),i=setInterval((function(){l--,l<0&&(l=0),l<.2*s&&$(".timer",$(".speaker_presentation")).addClass("warning"),l<.1*s&&$(".timer",$(".speaker_presentation")).removeClass("warning").addClass("finalwarning"),u()}),1e3),c=!0)},pauseTimer:function(){clearInterval(i),c=!1},resetTimer:function(){clearInterval(i),c=!1,l=0,s=0,u(),$(".timer",$(".speaker_presentation")).removeClass("warning finalwarning")},onAir:f,show:function(){$(".presentation").is(":visible")&&($("#iSpringFrame_attendee").get(0).contentWindow.postMessage({action:"removeSrc"}),$(".presentation").hide(400)),$(".speaker_presentation").fadeIn(400)},hide:function(){$(".speaker_presentation").fadeOut(400)},source:function(e){var n=AppData.medias.find((function(n){return n.id==e})),t="";null!=n&&null!=n.files[localState.lang]&&(t=n.files[localState.lang].foldername+"/",r=e);var i=$("#iSpringFrame"),a=t+"index.html";e&&a!==i.attr("src")&&(i.attr("src",a),localState.presentation=e),e||setTimeout((function(){i.removeAttr("src"),delete localState.presentation,delete localState.presentationState}),1e3),1==AppData.profile.presi_control?($(".prev_frame, .next_frame, .timer",$(".speaker_presentation")).show(),$(".prev_frame",$(".speaker_presentation")).unbind("click").on("click",g),$(".next_frame",$(".speaker_presentation")).unbind("click").on("click",S)):$(".prev_frame, .next_frame, .timer",$(".speaker_presentation")).hide()},setSpeakers:function(e){p=e},playbackController:e}}();
var Speakers=function(){"use strict";var e,a;function t(e){AppData.user_fields.sort((function(e,a){return void 0!==e.sort_id&&void 0!==a.sort_id?parseInt(e.sort_id)>parseInt(a.sort_id)?1:-1:0}));var a,t,n,i=AppData.user_fields.filter((function(e){return!0===e.is_active}));$("#speakers-details .custom_fields").html(""),$.each(i,(function(i,s){(n=$("<section/>")).addClass("item "+("text"===s.field_type?"text-center":"text-justify")),a=$("<div/>"),n.append(a),t="",""!==s.field_icon&&(t="<i class='"+s.field_icon+"'></i> "),s.field_translated?e&&""!==e.values[s.field_name].title&&(a.html(t+e.values[s.field_name].title[localState.lang]),$("#speakers-details .custom_fields").append(n)):e&&""!==e.values[s.field_name].title&&(a.html(t+e.values[s.field_name].title),$("#speakers-details .custom_fields").append(n))}))}function n(){var e=$(this).attr("data-link");window.open(e)}function i(){AppData.speakers.sort((function(e,a){return AppData.modulsettings.speakersabc?e.name[localState.lang].localeCompare(a.name[localState.lang]):void 0!==e.sort_id&&void 0!==a.sort_id?parseInt(e.sort_id)-parseInt(a.sort_id):0}))}function s(){i();var a=$("#speakers #speakersList"),t=$(document.createDocumentFragment()),n=AppData.speakers;$.each(n,(function(n,i){var s=e.clone(),l=[];s.attr("data-index",i.id),!0===AppData.modulsettings.showspeakergotolink?s.toggleClass("link"):(s.removeClass("link"),s.find(".chevron").hide()),l.push("object"==typeof i.company?i.company[localState.lang]:i.company),l.push("object"==typeof i.position?i.position[localState.lang]:i.position),$.each(i.values,(function(e,a){"1"===a.showrow&&a.is_active?l.unshift("object"==typeof a.title?a.title[localState.lang]:a.title):"2"===a.showrow&&a.is_active&&l.push("object"==typeof a.title?a.title[localState.lang]:a.title)})),s.find(".data-name").text(i.name[localState.lang]),s.find(".data-info").html(l.join("<br>")).toggleClass("hidden",!l.length),i.img?s.find(".data-img").attr(a.is(":visible")?"src":"data-src","upload/users/"+i.img):s.find(".data-img").attr("src","img/profile-picture-placeholder.png"),s.appendTo(t)})),a.html(t)}function l(){if("speakers"in localState){var e,n=$("#speakers-details article"),i=$("#speakers-details .data-label"),s=AppData.speakers.find((function(e){return e.id===localState.speakers.itemIndex})),l=AppData.favorites.find((function(e){return"speaker"===e.type&&e.data===localState.speakers.itemIndex})),d=Boolean(l),p=Boolean(l)&&!l.sent;if(!s)return!1;if(e=AppData.agenda.filter((function(e){var a=e.speakers;return!!a&&a.filter((function(e){return e.speaker_id==s.id})).length>0})),i.text(s.name[localState.lang]||""),n.find(".data-img").attr({src:"img/profile-picture-placeholder.png","data-src":null}),s.img&&n.find(".data-img").attr("src","upload/users/"+s.img),""==s.linkedin_link&&""==s.facebook_link&&""==s.personal_link&&""==s.nationality?$("#speakers-details .userlinks").hide():$("#speakers-details .userlinks").show(),n.find(".facebook").hide(),""!=s.facebook_link&&n.find(".facebook").attr("data-link",s.facebook_link).show(),n.find(".linkedin").hide(),""!=s.linkedin_link&&n.find(".linkedin").attr("data-link",s.linkedin_link).show(),n.find(".personal_link").hide(),""!=s.personal_link&&n.find(".personal_link").attr("data-link",s.personal_link).show(),n.find(".nationality").hide(),""!=s.nationality&&(n.find(".nationality span").html(s.nationality),n.find(".nationality").show()),s.solutions[localState.lang].length){var c="<strong>"+AppData.languages[localState.lang]["profile-interests"]+'</strong><ul class="speakerinterests">';s.solutions[localState.lang].forEach((function(e){AppData.select_fields.SOLUTIONS[localState.lang][e]&&(c+="<li>"+AppData.select_fields.SOLUTIONS[localState.lang][e]+"</li>")})),c+="</ul>",n.find(".data-interests").parent().show(),n.find(".data-interests>span").html(c),sortListUl(".speakerinterests")}else n.find(".data-interests>span").html(""),n.find(".data-interests").parent().hide();n.find(".data-name").text(s.name[localState.lang]);var f=s.phone?atob(atob(s.phone).substring(1)):"",g=s.email?atob(atob(s.email).substring(1)):"";n.find(".data-phone").text(f).parent().toggleClass("hidden",!0),//!el.phone
n.find(".data-email").text(g).parent().toggleClass("hidden",!0),//!el.email
r();let m=s.facebook_url?s.facebook_url:"",h=s.twitter_url?s.twitter_url:"",v=s.instagram_url?s.instagram_url:"",S=s.linkedin_url?s.linkedin_url:"";if(n.find(".facebook").attr("data-link",m).toggleClass("hidden",!m),n.find(".twitter").attr("data-link",h).toggleClass("hidden",!h),n.find(".instagram").attr("data-link",v).toggleClass("hidden",!v),n.find(".linkedin").attr("data-link",S).toggleClass("hidden",!S),n.find(".social").toggleClass("hidden",!m&&!h&&!v&&!S||!AppData.modulsettings.showsociallinks),n.find(".data-phone").text(f).parent().toggleClass("hidden",!s.phone),n.find(".data-email").text(g).parent().toggleClass("hidden",!s.email),n.find(".data-job").text(s.job[localState.lang]).toggleClass("hidden",!s.job[localState.lang]),n.find(".data-company").text(s.company[localState.lang]).parent().toggleClass("hidden",!s.company[localState.lang]),n.find(".data-email").closest(".item").toggleClass("hidden",!s.email&&!s.phone&&!s.company[localState.lang]),""!=s.sponsor?n.find(".data-company").addClass("sponsor").attr("data-id",s.sponsor):n.find(".data-company").removeClass("sponsor").attr("data-id",""),n.find(".data-bio").html(s.bio[localState.lang]).parent().toggleClass("hidden",!s.bio[localState.lang]),n.find(".data-department").text(s.department[localState.lang]).parent().toggleClass("hidden",!s.department[localState.lang]),n.find(".data-slogan").text(s.slogan[localState.lang]).parent().toggleClass("hidden",!s.slogan[localState.lang]),n.find(".data-skill").text(s.skill[localState.lang]).parent().toggleClass("hidden",!s.skill[localState.lang]),n.find(".data-university").text(s.university[localState.lang]).parent().toggleClass("hidden",!s.university[localState.lang]),n.find(".favorite.save").toggleClass("hidden",d),n.find(".favorite.saved").toggleClass("hidden",!d),n.find(".favorite.cancel").toggleClass("hidden",!p),n.find(".agendaList").toggleClass("hidden",!e.length),n.find(".item.agenda").remove(),e){var u=$(document.createDocumentFragment()),k=AppData.translations.filter((function(e){return e.translation_id===localState.lang}))[0];$.each(e,(function(e,t){var n,i=a.clone();let l;if(i.attr("data-id",t.id),n="string"==typeof t.title?t.title:t.title[localState.lang],AppData.modulsettings.agendashowparentonspeaker&&""!=t.parent){let e=t.parent;l=AppData.agenda.find((function(a){return a.id==e})),l&&(n=l.title[localState.lang]+'<br><span class="underparent">'+n+"</span>")}let o=s.day;"string"==typeof s.day&&(o=[s.day]);var r=AppData.days.filter((function(e){return t.day==e.id}));i.find(".data-agendaName").html(r[0].name[localState.lang]),i.find(".data-title").html(n),i.find(".data-timeStart").text(makeTimeFormat(t.timeStart,k.time_format)),i.find(".data-timeEnd").text(makeTimeFormat(t.timeEnd,k.time_format));var d=AppData.channels.find((function(e){return e.channel===t.rooms}));i.find(".data-rooms").attr("data-room-id",t.rooms).text(d?d.name[localState.lang]:"").parent().toggleClass("hidden",!d),i.appendTo(u),i=null})),u.appendTo(n.find(".agendaList")),u=null}t(s);let _=AppData.speakerlinks.filter((function(e){return e.speaker_id==s.id&&e.active})),C=n.find(".speaker_links");if(C.hide(),_.length>0){C.empty(),C.show();for(let e in _){let a=_[e],t=$("<div/>").addClass("speaker_link external-link").attr("data-link",a.link[localState.lang]),n=$("<i/>");switch(a.type){case"document":n.addClass("fa-fw fas fa-file");break;case"video":n.addClass("fa-fw fas fa-video")}t.append(n);let i=$("<div/>").addClass("speaker_link_title");i.html(a.title[localState.lang]),t.append(i),t.appendTo(C)}}o(),r()}}function o(){AppData.modulsettings.showrequestbusinesscard?$("#speakers-details").find(".favorite").show():$("#speakers-details").find(".favorite").hide()}function r(){AppData.modulsettings.showsociallinks?$("#speakers-details").find(".social").removeClass("hidden"):$("#speakers-details").find(".social").addClass("hidden")}function d(){$("#speakers #speakersList .item").each((function(e,a){!0===AppData.modulsettings.showspeakergotolink?($(a).addClass("link"),$(a).find(".chevron").show()):($(a).removeClass("link"),$(a).find(".chevron").hide())}))}function p(){$.post("api/",{do:"getSpeakers"},(function(e){AppData.speakers=e.speakers,AppData.speakerlinks=e.speakerlinks,h(),lazyImages(),e=null}))}function c(e){var a=!1,t=$("#speakers .search-wrapper .btn-clear"),n=$("#speakers .no-result"),i=$("#speakers .search-wrapper input").val(),s=i.split(" ").join(""),l=new RegExp(strCanonical(s),"i"),o=new RegExp(strCanonical(s),"i"),r=new RegExp(strCanonical(s),"i");localState.speakers.search=i,requestAnimationFrame((function(){$("#speakers #speakersList .item").each((function(e,t){var n=$(t).find(".data-name").text().split(" ").join(""),i=$(t).find(".data-info").text().split(" ").join(""),s=l.test(strCanonical(n))||o.test(strCanonical(i))||r.test(strCanonical(str3));$(t).toggle(s),a=!!s||a,n=i=s=null})),t.toggle(Boolean(i.length)),n.toggle(!a),a=t=n=i=s=l=o=r=null}))}function f(){!0===AppData.modulsettings.showspeakergotolink&&(localState.speakers.itemIndex=String($(this).data("index"))||0,l(),Layout.hide("speakers-details",!0),Layout.show("speakers-details"),writeDbLog("open speaker profile",localState.speakers.itemIndex,"user_logs","speakers"))}function g(){var e=$("#speakers-details");console.log(e),e.find(".favorite.save").addClass("hidden"),e.find(".favorite.saved").removeClass("hidden"),e.find(".favorite.cancel").removeClass("hidden"),$.post("api/",{do:"saveFavorite",data:{id:localState.speakers.itemIndex||!1,lang:localState.lang}},(function(e){AppData.favorites=e,BookedAgenda.renderList(),Modal.resultconfirmation({canClose:!0,title:AppData.languages[localState.lang].businesscardrequest_title,text:AppData.languages[localState.lang].businesscardrequest_text}),e=null})),e=null}function u(){var e=$("#speakers-details"),a=AppData.favorites.find((function(e){return"speaker"===e.type&&e.data===localState.speakers.itemIndex}));e.find(".favorite.save").removeClass("hidden"),e.find(".favorite.saved").addClass("hidden"),e.find(".favorite.cancel").addClass("hidden"),$.post("api/",{do:"removeFavorite",data:a.id},(function(e){AppData.favorites=e,BookedAgenda.renderList(),e=null})),e=null}function k(e){e.preventDefault(),$("#speakers .search-wrapper input").val("").trigger("input")}function m(e){(e.wich||13===e.keyCode)&&this.blur()}function h(){i(),s(),l()}return localState.speakers=localState.speakers||{},localState.speakers.itemIndex=localState.speakers.itemIndex||0,{Init:function(){e=$("template#tplSpeakersItem").remove().contents(),a=$("template#tplSpeakersAgenda").remove().contents(),$(document).on("input","#speakers .search-wrapper input",c).on("keyup","#speakers .search-wrapper input",m).on("click","#speakers .search-wrapper .btn-clear",k).on("click","#speakers #speakersList .item",f).on("click","#speakers-details .favorite.save",g).on("click","#speakers-details .favorite.cancel",u).on("click","#speakers-details .item.agenda",Agenda.evtClickDetails).on("click","#speakers-details .sponsor",Sponsors.clickSponsors),$(document).on("click","#speakers-details .external-link",n),"search"in localState.speakers&&$("#speakers .search-wrapper input").val(localState.speakers.search).trigger("input"),o(),d(),h()},evtClickDetails:f,showDetails:function(e){e&&(null!=localState.speakers?e===localState.speakers.itemIndex&&0!==localState.speakers.itemIndex||(localState.speakers.itemIndex=String(e),l()):localState.speakers={itemIndex:String(e)},Layout.show("speakers-details"),writeDbLog("open speaker profile",e,"user_logs","speakers"))},renderList:s,renderDetails:l,BuildFromSource:p,updateAvatar:function(e){$.get(e,(function(){p()}))},toggleRequestBusinessCard:o,toggleRequestSpeakerGotoLink:d,updateRequestBusinessCard:function(){$.post("api/",{do:"getFavorites"},(function(e){AppData.favorites=e,l(),e=null}))},toggleSocial:r,UpdateModule:h}}();
var Sponsors=function(){var s,t;function o(s){var t,o,n;void 0!==$(this).attr("class")?(t=$(this).attr("class"),o=$(this).attr("data-id")):(t=s.feature,o=s.sponsor_id,n=s.speaker_id),$.post("api/",{do:"addSponsorFeature",sponsor_id:o,feature:t,speaker_id:n},(function(s){}))}function n(){AppData.sponsors.sort((function(s,t){return void 0!==s.sort_id&&void 0!==t.sort_id?parseInt(s.sort_id)>parseInt(t.sort_id)?1:-1:0})),AppData.sponsorgroups.sort((function(s,t){return void 0!==s.sort_id&&void 0!==t.sort_id?parseInt(s.sort_id)>parseInt(t.sort_id)?1:-1:0}));var t=$("#sponsors .sponsorsList"),o=$(document.createDocumentFragment()),n=[];if(0==AppData.sponsorgroups.length&&(n=AppData.sponsors),$.each(AppData.sponsorgroups,(function(t,a){var e=0,i=$("<h3/>").addClass("grouptitle").css({color:a.titlecolor||"#555555"}).html(a.title[localState.lang]);i.appendTo(o);var r=$(document.createDocumentFragment()),l=$("<div/>").addClass("sponsors_cont").appendTo(r);$.each(AppData.sponsors,(function(t,o){var i=n.find((function(s){return s.id==o.id}));if(""!=o.group&&null!=o.group||null!=i||n.push(o),o.group==a.id&&o.active){e++;var r=s.clone();r.find(".data-title").text(o.name[localState.lang]),r.attr("data-link",o.link),r.attr("data-id",o.id),r.attr("data-blank",o.open_in_blank),r.appendTo(l),o.file&&(r.find(".data-image").attr("src",o.file.path),"increased"===a.imgsize&&r.find(".data-image").addClass("increased")),r.find(".data-title").hide(),r.find(".data-image").show(),r.find(".fa-sticky-note").hide()}})),r.appendTo(o),0==e&&i.remove()})),n.length>0){var a=$(document.createDocumentFragment()),e=$("<div/>").addClass("sponsors_cont").appendTo(a);$("<h3/>").addClass("grouptitle").html("&nbsp;").appendTo(o),$.each(n,(function(t,o){if(o.active){var n=s.clone();n.find(".data-title").text(o.name[localState.lang]),n.attr("data-link",o.link),n.attr("data-id",o.id),n.attr("data-blank",o.open_in_blank),n.appendTo(e),o.file&&n.find(".data-image").attr("src",o.file.path),n.find(".data-title").hide(),n.find(".data-image").show(),n.find(".fa-sticky-note").hide()}})),a.appendTo(o)}t.html(o),$("#sponsors").find(".no-result").toggle(Boolean(!AppData.sponsors.length))}function a(){var s=$(this).attr("data-id");localState.sponsors.itemIndex=s,Layout.hide("sponsors-details",!0),r(s),Layout.show("sponsors-details")}function e(){var s=$(this).attr("data-index"),t=$(this).attr("data-utype");o({feature:"show-sponsor-speaker",sponsor_id:$(this).attr("data-sponsor_id"),speaker_id:s}),"speaker"==t?(Layout.hide("speakers-details",!0),Speakers.showDetails(s)):(Layout.hide("attendees-details",!0),Attendees.showDetails(s))}function i(){var s=AppData.sponsors.find((function(s){return localState.sponsors.itemIndex==s.id})),o=AppData.favorites.find((function(s){return"sponsor"===s.type&&s.data===localState.sponsors.itemIndex})),n=Boolean(o),a=Boolean(o)&&!o.sent;if(null!=s){s.file?($("#sponsors-details .sponsor-img").attr("src",s.file.path),$("#sponsors-details .sponsor-img-cont").show()):$("#sponsors-details .sponsor-img-cont").hide(),$("#sponsors-details .sponsor-title").html(s.name[localState.lang]),$("#sponsors-details .sponsor-website a").attr("href",s.link),$("#sponsors-details .sponsor-website").attr("data-id",s.id),$("#sponsors-details .sponsor-linkedin a").attr("href",s.linkedin_link),$("#sponsors-details .sponsor-linkedin").attr("data-id",s.id),""!=s.networking_link&&null!=s.networking_link?$("#sponsors-details .sponsor-networking").show():$("#sponsors-details .sponsor-networking").hide(),$("#sponsors-details .sponsor-description").html(nl2br(s.description[localState.lang]));var e=AppData.attendees.filter((function(t){return t.sponsor==s.id})),i=AppData.speakers.filter((function(t){return t.sponsor==s.id}));if(e=e.concat(i),$("#sponsors-details .sponsor-users").html(""),void 0!==s.solutions&&s.solutions[localState.lang].length){var r="<strong>"+AppData.languages[localState.lang]["profile-interests"]+'</strong><ul class="sponsorinterests">';s.solutions[localState.lang].forEach((function(s){AppData.select_fields.SOLUTIONS[localState.lang][s]&&(r+="<li>"+AppData.select_fields.SOLUTIONS[localState.lang][s]+"</li>")})),r+="</ul>",$("#sponsors-details").find(".data-interests").show(),$("#sponsors-details").find(".data-interests>span").html(r),sortListUl(".sponsorinterests")}else $("#sponsors-details").find(".data-interests").hide();for(var l=0;l<e.length;l++){var p=t.clone();p.attr("data-index",e[l].id).attr("data-utype",e[l].group),p.attr("data-sponsor_id",s.id),p.find(".data-name").text(e[l].name[localState.lang]),p.find(".data-job").text(e[l].job[localState.lang]),p.find(".data-img").attr("src",e[l].img?"upload/users/"+e[l].img:"img/profile-picture-placeholder.png"),$("#sponsors-details .sponsor-users").append(p)}var d=$("#sponsors-details article");d.find(".favorite.save").toggleClass("hidden",n),d.find(".favorite.saved").toggleClass("hidden",!n),d.find(".favorite.cancel").toggleClass("hidden",!a)}}function r(s){localState.sponsors={itemIndex:s},i(),Layout.show("sponsors-details")}function l(s){s.preventDefault(),$("#sponsors .search-wrapper input").val("").trigger("input")}function p(s){(s.wich||13===s.keyCode)&&this.blur()}function d(s){var t,o=!1,n=$("#sponsors .search-wrapper .btn-clear"),a=$("#sponsors .no-result"),e=$.trim($("#sponsors .search-wrapper input").val()),i=e.split(" ").join("|"),r=new RegExp(strCanonical(i),"i"),l=new RegExp(strCanonical(i),"i"),p=new RegExp(strCanonical(i),"i"),d=new RegExp(strCanonical(i),"i");localState.sponsors.search=e,$("#sponsors .sponsorsList").find(".sponsors_cont .link").hide(),$.each(AppData.sponsors,(function(s,n){t=!1,void 0!==n.name&&$.each(n.name,(function(s,o){o=strCanonical(o.split(" ").join("")),t=r.test(o)||t})),void 0!==n.description&&$.each(n.description,(function(s,o){o=strCanonical(o.split(" ").join("")),t=l.test(o)||t})),void 0!==n.solutions&&$.each(n.solutions,(function(s,o){var n=s;$.each(o,(function(s,o){let a=strCanonical(AppData.select_fields.SOLUTIONS[n][o].split(" ").join(""));t=p.test(a)||t}))}));var a=AppData.speakers.filter((function(s){return s.sponsor==n.id}));a.length>0&&$.each(a,(function(s,o){$.each(o.name,(function(s,n){n=strCanonical(n.split(" ").join("")),t=d.test(n)||t;var a=AppData.agenda.filter((function(s){if(void 0!==s.speakers&&""!==s.speakers){var t=s.speakers.filter((function(s){return s.speaker_id===o.id}));return Boolean(t.length)}return!1}));a.length>0&&$.each(a,(function(s,o){$.each(o.title,(function(s,o){o=strCanonical(o.split(" ").join("")),t=d.test(o)||t}));$.each(o.details,(function(s,o){o=strCanonical(o.split(" ").join("")),t=d.test(o)||t}))}))}))})),t&&$("#sponsors .sponsorsList").find(".sponsors_cont .link").each((function(s,t){t.dataset.id===n.id&&$(t).show()})),o=!!t||o})),n.toggle(Boolean(e.length)),a.toggle(!o)}function c(){var s=$("#sponsors-details");s.find(".favorite.save").addClass("hidden"),s.find(".favorite.saved").removeClass("hidden"),s.find(".favorite.cancel").removeClass("hidden"),$.post("api/",{do:"saveFavoriteSponsor",data:{id:localState.sponsors.itemIndex||!1,lang:localState.lang}},(function(s){AppData.favorites=s,BookedAgenda.renderList(),Modal.resultconfirmation({canClose:!0,title:AppData.languages[localState.lang].businesscardrequest_title,text:AppData.languages[localState.lang].businesscardrequest_text}),s=null})),s=null}function u(){var s=$("#sponsors-details"),t=AppData.favorites.find((function(s){return"sponsor"===s.type&&s.data===localState.sponsors.itemIndex}));s.find(".favorite.save").removeClass("hidden"),s.find(".favorite.saved").addClass("hidden"),s.find(".favorite.cancel").addClass("hidden"),$.post("api/",{do:"removeFavorite",data:t.id},(function(s){AppData.favorites=s,BookedAgenda.renderList(),s=null})),s=null}return{Init:function(){null==localState.sponsors&&(localState.sponsors={itemIndex:0}),s=$("template#tplSponsorsItem").contents().remove(),t=$("template#tplSponsorSpeaker").contents().remove(),n(),i(),$("#sponsorsIframeId").unbind("load"),$(document).on("click","#sponsors .link",a),$(document).on("click","#sponsors-details .sponsor-users .item",e).on("input","#sponsors .search-wrapper input",d).on("keyup","#sponsors .search-wrapper input",p).on("click","#sponsors .search-wrapper .btn-clear",l).on("click","#sponsors .map-btn",(function(){$("#sponsors .search-wrapper").addClass("hidden"),$("#sponsors .sponsorsList").addClass("hidden"),$("#sponsors .sponsor_map").removeClass("hidden")})).on("click","#sponsors .list-btn",(function(){$("#sponsors .search-wrapper").removeClass("hidden"),$("#sponsors .sponsorsList").removeClass("hidden"),$("#sponsors .sponsor_map").addClass("hidden")})).on("click","#sponsors .sponsor_map #logok [data-sponsorid]",(function(){let s=$(this).attr("data-sponsorid");Sponsors.showDetails(s)})).on("click","#sponsors-details .sponsor-networking button",(function(){Weblinks.showDetails("45570664")})).on("click","#sponsors-details .favorite.save",c).on("click","#sponsors-details .favorite.cancel",u).on("click","#sponsors-details .sponsor-website",o).on("click","#sponsors-details .sponsor-linkedin",o),"search"in localState.sponsors&&$("#sponsors .search-wrapper input").val(localState.sponsors.search).trigger("input")},render:n,showDetails:r,update:function(){$.post("api/",{do:"getSponsors"},(function(s){AppData.sponsors=s,n(),s=null}))},updateGroups:function(){$.post("api/",{do:"getSponsorgroups"},(function(s){AppData.sponsorgroups=s,n(),s=null}))},clickSponsors:a}}();
var Stage=function(){"use strict";var e,a;function t(){var t=$("#stage .stageList, #landing .landing_elements .stage_cont .stageList"),n=$(document.createDocumentFragment()),s=AppData.agenda.filter((function(e){if("director"==AppData.profile.group)return!0;if(e.speakers)for(var a=e.speakers,t=0;t<a.length;t++)if(a[t].speaker_id==AppData.profile.id)return!0;return!1})),i=[];$.each(s,(function(e,a){i.push(a.rooms)})),"director"==AppData.profile.group&&(i=AppData.profile.rooms);var r=AppData.issues.filter((function(e){if(e.room_id&&e.active)switch(a){case"all":return(i&&($.inArray(e.room_id,i)>-1||e.room_id==i)||"director"==AppData.profile.group||"all"===e.room_id)&&e.approved;case"answered":return(i&&($.inArray(e.room_id,i)>-1||e.room_id==i)||"director"==AppData.profile.group||"all"===e.room_id)&&e.approved&&e.answered;case"denied":return(i&&($.inArray(e.room_id,i)>-1||e.room_id==i)||"director"==AppData.profile.group||"all"===e.room_id)&&e.approved&&!1===e.answered;case"waiting":return(i&&($.inArray(e.room_id,i)>-1||e.room_id==i)||"director"==AppData.profile.group||"all"===e.room_id)&&e.approved&&void 0===e.answered}return!1}));r.sort((function(e,a){return null==e.approve_date||null==a.approve_date?-1:a.approve_date-e.approve_date})),$.each(r,(function(a,t){var s=e.clone();s.attr("data-index",t.id);var i=AppData.speakers.find((function(e){return e.id==t.speaker})),r=t.username[localState.lang],o=AppData.agenda.find((function(e){return e.id===t.agenda})),d="";AppData.modulsettings.qandashowprogram&&(d+=o?"Agenda: "+o.title[localState.lang]+"<br>":""),d+=i?"To: "+i.name[localState.lang]+"<br>":"",d+=r?"From: "+(t.is_anonym?"Anonymous":r)+"<br>":"",d+=t.email?(t.is_anonym?"Anonymous":t.email)+"<br>":"",d+="<br><span class='issues-title'>Question:</span> "+t.question,d+=t.answer?"<div class='answer_cont'><span class='issues-title'>Answer:</span> "+t.answer+"</div>":"",d+=t.note?"<div class='note_cont'><span class='issues-title'>Note:</span> "+t.note+"</div>":"",s.find(".data-question").html(d),s.appendTo(n),void 0===t.answered&&!1===AppData.modulsettings.qandaapprove_by_speaker&&s.find(".answer-btn").addClass("hidden"),t.answered&&(s.find(".answer-btn").addClass("hidden"),s.addClass("answered"),s.children("i").first().removeClass("fa-question").addClass("fa-check")),!1===t.answered&&(s.find(".deny-btn").addClass("hidden"),s.addClass("denied"),s.children("i").first().removeClass("fa-question").addClass("fa-times"))})),t.html(n);var o=Language.getItem("stage-answer");$(".stage-answer").text(o);var d=Language.getItem("stage-deny");$(".stage-deny").text(d),$("#stage").find(".no-result").toggle(Boolean(!AppData.issues.length))}function n(e){$("button[class*='filter']").removeClass("bg-primary"),$(this).addClass("bg-primary"),a=e.data.filter,t()}return $(document).on("click","#stage .item .answer-btn, #landing .stage_cont .item .answer-btn",(function(){var e=$(this).closest(".item").attr("data-index");$(this).prop("disabled",!0),$.post("api/",{do:"answerIssues",data:{id:e,answered:!0}},(function(e){AppData.issues=e,t(),Socket.Send("refreshModule",{module:["Issues","Stage"],appdata:"issues",data:e,callback:["Build","renderList"]},{client:["client","issues"]})}))})).on("click","#stage .item .deny-btn, #landing .stage_cont .item .deny-btn",(function(){var e=$(this).closest(".item").attr("data-index");$(this).prop("disabled",!0),$.post("api/",{do:"answerIssues",data:{id:e,answered:!1}},(function(e){AppData.issues=e,t(),Socket.Send("refreshModule",{module:["Issues","Stage"],appdata:"issues",data:e,callback:["Build","renderList"]},{client:["client","issues"]})}))})).on("click","#stage .filter-all, #landing .stage_cont .filter-all",{filter:"all"},n).on("click","#stage .filter-answered, #landing .stage_cont .filter-answered",{filter:"answered"},n).on("click","#stage .filter-waiting, #landing .stage_cont .filter-waiting",{filter:"waiting"},n).on("click","#stage .filter-denied, #landing .stage_cont .filter-denied",{filter:"denied"},n),{Init:function(){e=$("template#tplStageItem").remove().contents(),a="all",$(".filter-all").addClass("bg-primary"),t(),delete Stage.Init},BuildFromSource:function(){$.post("api/",{do:"getIssues"},(function(e){AppData.issues=e,t()}))},Build:function(){t()},renderList:t,UpdateModule:function(e){AppData.issues=e,t()},notify:function(e){user_rooms.indexOf(e.room_id)>-1&&Notify.show(e)}}}();
var Surveys=function(){"use strict";var t,e,a,i,s,n,r,d,l,o,c=!0;function u(){var e=$("#surveys #surveysList"),a=$(document.createDocumentFragment()),i=AppData.surveys.filter((function(t){return!0===t.active}));!function(t){t.sort((function(t,e){return void 0!==t.sort_id&&void 0!==e.sort_id?parseInt(t.sort_id)>parseInt(e.sort_id)?1:-1:0}))}(i),$.each(i,(function(e,i){if(i.active){var s=t.clone();s.attr("data-index",i.id),s.find(".filledsurveydisplay").css("display",p(i)?"block":"none"),s.find(".chevron").css("display",p(i)?"none":"block"),s.find(".data-title").text(i.title[localState.lang]),s.appendTo(a)}})),e.html(a),$("#surveys .no-result").toggle(Boolean(!i.length))}function p(t){var e=AppData.surveysdata.filter((function(e){return e.survey===t.id})),a=void 0!==t.answers_multiple_times&&t.answers_multiple_times;return e.length>0&&!a}function f(){if("surveys"in localState){var t,u,p=$("#surveys-details article"),f=$("#surveys-details .data-label"),v=$(document.createDocumentFragment()),m=AppData.surveys.find((function(t){return t.id===localState.surveys.itemIndex}))||AppData.surveys[0],h=AppData.surveysdata.find((function(t){return t.survey===localState.surveys.itemIndex}));if(!m)return!1;if(h=Boolean(h)&&!m.answers_multiple_times,f.text(m.title[localState.lang]),f.text(AppData.languages[AppData.settings.lang]["nav-surveys"]),p.find(".survey_title h3").html(m.title[localState.lang]),o=new Array,$.each(m.parts,(function(p,f){let h="";switch(f.answer_required&&m.show_asterisk&&(h=" *"),f.type){case"grouprating":(t=a.clone()).find(".data-title").html(f.question[localState.lang]+h),void 0!==f.description&&t.find(".data-description").html(f.description[localState.lang]).css("display","block"),f.answers&&$.each(f.answers[localState.lang].split("||"),(function(e,a){if((u=i.clone()).find(".data-label").html(a),u.find("input").attr("data-id",f.id),void 0!==f.rating_star_count&&""!=f.rating_star_count&&f.rating_star_count>0)for(var s=0;s<f.rating_star_count;s++)u.find(".rating_icons").html(u.find(".rating_icons").html()+'<i class="far fa-fw fa-2x fa-star"></i>');u.appendTo(t)})),t.find(".answer-required").val(String(f.answer_required)),t.find("input").attr("data-answer-required",String(f.answer_required)),t.appendTo(v),f.answer_required&&-1==$.inArray("parts_"+p,o)&&o.push("parts_"+p);break;case"rating":if((t=e.clone()).find(".data-title").html(f.question[localState.lang]+h),void 0!==f.description&&t.find(".data-description").html(f.description[localState.lang]).css("display","block"),t.find(".answer-required").val(String(f.answer_required)),t.find("input").attr("data-id",f.id),t.find("input").attr("data-answer-required",String(f.answer_required)),t.appendTo(v),void 0!==f.rating_star_count&&""!=f.rating_star_count&&f.rating_star_count>0)for(var y=0;y<f.rating_star_count;y++)t.find(".rating_icons").html(t.find(".rating_icons").html()+'<i class="far fa-fw fa-2x fa-star"></i>');f.answer_required&&-1==$.inArray("parts_"+p,o)&&o.push("parts_"+p);break;case"radio":(t=s.clone()).find(".data-title").html(f.question[localState.lang]+h),void 0!==f.description&&t.find(".data-description").html(f.description[localState.lang]).css("display","block"),f.answers&&$.each(f.answers[localState.lang].split("||"),(function(e,a){(u=n.clone()).find(".data-label").html(a),u.find("input").val(a),u.appendTo(t)})),t.find(".answer-required").val(String(f.answer_required)),t.find("input").attr("data-id",f.id),t.find("input").attr("data-answer-required",String(f.answer_required)),t.appendTo(v),f.answer_required&&-1==$.inArray("parts_"+p,o)&&o.push("parts_"+p);break;case"check":t=r.clone(),u=d.clone();var g=""!==f.checkbox_min&&""!==f.checkbox_max&&f.checkbox_min>0&&f.checkbox_max>f.checkbox_min,_=f.answer_required||g;t.find(".data-title").html(f.question[localState.lang]+(_?h:"")),void 0!==f.description&&t.find(".data-description").html(f.description[localState.lang]).css("display","block"),f.answers&&$.each(f.answers[localState.lang].split("||"),(function(e,a){(u=d.clone()).find(".data-label").html(a),u.find("input").val(a),u.find("input").addClass("parts_"+p),_&&(u.find("input").attr("data-name","parts_"+p),-1==$.inArray("parts_"+p,o)&&o.push("parts_"+p)),u.appendTo(t)})),t.find(".answer-required").val(String(f.answer_required)),t.find("input").attr("data-id",f.id),t.find("input").attr("data-answer-required",String(f.answer_required)),t.find("input").attr("data-checkbox_min",String(f.checkbox_min)),t.find("input").attr("data-checkbox_max",String(f.checkbox_max)),t.appendTo(v);break;case"text":(t=l.clone()).find(".data-title").html(f.question[localState.lang]+h),void 0!==f.description&&t.find(".data-description").html(f.description[localState.lang]).css("display","block"),t.find("textarea").attr("data-id",f.id),t.find("textarea").attr("placeholder",Language.getItem("write-here")),t.find("textarea").attr("data-answer-required",String(f.answer_required)),t.find(".answer-required").val(String(f.answer_required)),t.appendTo(v),f.answer_required&&-1==$.inArray("parts_"+p,o)&&o.push("parts_"+p)}c=c&&!f.answer_required,t.find("input, textarea").attr("name","parts_"+p)})),m.survey_description&&p.find(".survey_description").html(m.survey_description[localState.lang]).show(),m.sponsormedia&&""!=m.sponsormedia){var y=AppData.medias.filter((function(t){return t.id===m.sponsormedia}))[0];y&&(p.find(".survey_sponsormedia").find(".sponsormediaimg").attr("src","upload/media/"+y.filename),p.find(".survey_sponsormedia").show())}else p.find(".survey_sponsormedia").hide();p.find(".items").html(v),p.find("[type=submit]").addClass("disabled"),p.find(".data-thank-you").html(m.thxtext[localState.lang]),p.find(".data-thank-you").toggle(h),p.find("form").toggle(!h),t=null}}function v(){localState.surveys.itemIndex=String($(this).data("index"))||0,$(this).find(".filledsurveydisplay").is(":visible")?writeDbLog("view filled",localState.surveys.itemIndex,"user_logs","surveys"):writeDbLog("start fill",localState.surveys.itemIndex,"user_logs","surveys"),f(),Layout.show("surveys-details")}function m(t){var e,a,i,s=""!==this.dataset.checkbox_min&&""!==this.dataset.checkbox_max&&this.dataset.checkbox_min>0&&this.dataset.checkbox_max>this.dataset.checkbox_min;switch(t.target.type){case"hidden":case"radio":e=!0;break;case"textarea":e=""!=t.target.value;break;case"checkbox":var n=0;$.each($("#surveys-details").find(".items ."+this.name),(function(t,a){e=e||a.checked,a.checked&&n++})),s&&n<this.dataset.checkbox_min&&(e=!1),s&&n>this.dataset.checkbox_max&&(e=!1)}("true"==this.dataset.answerRequired||s)&&(e?(a=o,i=this.name,o=a.filter((function(t){return t!=i}))):o.push(this.name)),$(this).closest("form").find("[type=submit]").toggleClass("disabled",Boolean(0!=o.length))}return localState.surveys=localState.surveys||{},localState.surveys.itemIndex=localState.surveys.itemIndex||0,$(document).on("change","#surveys-details input[type=radio], #surveys-details input[type=checkbox]",(function(){var t="state-checked animated pulse",e=$(this).closest("label");if("radio"===this.type&&e.siblings().removeClass(t),"checkbox"==this.type){let t=parseInt($(this).attr("data-checkbox_max"));$(".state-checked",$(this).closest(".item")).length==t&&$(this).prop("checked",!1)}e.toggleClass(t,this.checked)})).on("click","#surveys #surveysList .item",v).on("input","#surveys-details form textarea",m).on("change","#surveys-details form input",m).on("click","#surveys-details .survey-star .fa-star",(function(){var t=$(this);t.prevAll().addBack().removeClass("far").addClass("fas"),t.nextAll().removeClass("fas").addClass("far"),t.parent().siblings("input").val(t.index()+1).trigger("change")})).on("submit","#surveys-details form",(function(t){t.preventDefault();var e,a=$(this),i=a.serializeObject();(e=$("#surveys-details form")).find("input[type=hidden]").val(""),e.find("input[type=radio], input[type=checkbox]").prop("checked",!1),e.find("label").removeClass("state-checked animated pulse"),e.find(".fa-star").removeClass("fas").addClass("far"),e.find("textarea").val("");let s={};$.each(a.find("input, textarea"),(function(t,e){i[e.name]&&(s[e.name]={id:e.dataset.id,type:e.type,values:i[e.name]})})),s.survey=localState.surveys.itemIndex,writeDbLog("submit",localState.surveys.itemIndex,"user_logs","surveys"),AppData.settings.start_survey==localState.surveys.itemIndex&&Layout.hide("surveys-details"),a.hide(),a.closest("div.main").find(".data-thank-you").show(),a.closest("div.main").find(".survey_description").hide(),$.post("api/",{do:"saveSurveyData",data:s},(function(t){AppData.surveysdata=t,u(),t=null}))})),{Init:function(){t=$("template#tplSurveysItem").remove().contents(),e=$("template#tplSurveysStarRating").remove().contents(),a=$("template#tplSurveysStarGroupRating").remove().contents(),i=a.find("template#tplSurveysStarGroupRatingItem").remove().contents(),s=$("template#tplSurveysRadio").remove().contents(),n=s.find("template#tplSurveysRadioItem").remove().contents(),r=$("template#tplSurveysCheck").remove().contents(),d=r.find("template#tplSurveysCheckItem").remove().contents(),l=$("template#tplSurveysText").remove().contents(),$("template#tplSurveysHidden").remove().contents(),u(),f(),delete Surveys.Init},BuildFromSource:function(){$.post("api/",{do:"getSurveys"},(function(t){AppData.surveys=t,$.post("api/",{do:"getSurveysData"},(function(t){AppData.surveysdata=t,u(),f(),t=null})),t=null}))},showQuestion:function(t){t&&(localState.surveys.itemIndex=String(t),f(),Layout.show("surveys-details"))},showDetails:function(t){t&&(localState.surveys.itemIndex=String(t),f(),Layout.show("surveys-details"))},evtClickDetails:v}}();
/*!
 * BlockRain.js 0.2.0
 * jQuery plugin that lets you put a playable (and configurable) game of Tetris in your site or just leave it in auto in the background.
 * http://aerolab.github.io/blockrain.js/
 *
 * Copyright (c) 2015 Aerolab <hey@aerolab.co>
 *
 * Released under the MIT license
 * http://aerolab.github.io/blockrain.js/LICENSE.txt
 */
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}((function(t){var e=0,i=Array.prototype.slice;t.cleanData=function(e){return function(i){var o,n,s;for(s=0;null!=(n=i[s]);s++)try{(o=t._data(n,"events"))&&o.remove&&t(n).triggerHandler("remove")}catch(t){}e(i)}}(t.cleanData),t.widget=function(e,i,o){var n,s,a,r,h={},l=e.split(".")[0];return e=e.split(".")[1],n=l+"-"+e,o||(o=i,i=t.Widget),t.expr[":"][n.toLowerCase()]=function(e){return!!t.data(e,n)},t[l]=t[l]||{},s=t[l][e],a=t[l][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new a(t,e)},t.extend(a,s,{version:o.version,_proto:t.extend({},o),_childConstructors:[]}),(r=new i).options=t.widget.extend({},r.options),t.each(o,(function(e,o){return t.isFunction(o)?void(h[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},n=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,s=this._superApply;return this._super=t,this._superApply=n,e=o.apply(this,arguments),this._super=i,this._superApply=s,e}}()):void(h[e]=o)})),a.prototype=t.widget.extend(r,{widgetEventPrefix:s&&r.widgetEventPrefix||e},h,{constructor:a,namespace:l,widgetName:e,widgetFullName:n}),s?(t.each(s._childConstructors,(function(e,i){var o=i.prototype;t.widget(o.namespace+"."+o.widgetName,a,i._proto)})),delete s._childConstructors):i._childConstructors.push(a),t.widget.bridge(e,a),a},t.widget.extend=function(e){for(var o,n,s=i.call(arguments,1),a=0,r=s.length;r>a;a++)for(o in s[a])n=s[a][o],s[a].hasOwnProperty(o)&&void 0!==n&&(e[o]=t.isPlainObject(n)?t.isPlainObject(e[o])?t.widget.extend({},e[o],n):t.widget.extend({},n):n);return e},t.widget.bridge=function(e,o){var n=o.prototype.widgetFullName||e;t.fn[e]=function(s){var a="string"==typeof s,r=i.call(arguments,1),h=this;return s=!a&&r.length?t.widget.extend.apply(null,[s].concat(r)):s,a?this.each((function(){var i,o=t.data(this,n);return"instance"===s?(h=o,!1):o?t.isFunction(o[s])&&"_"!==s.charAt(0)?(i=o[s].apply(o,r))!==o&&void 0!==i?(h=i&&i.jquery?h.pushStack(i.get()):i,!1):void 0:t.error("no such method '"+s+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+s+"'")})):this.each((function(){var e=t.data(this,n);e?(e.option(s||{}),e._init&&e._init()):t.data(this,n,new o(s,this))})),h}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(i,o){o=t(o||this.defaultElement||this)[0],this.element=t(o),this.uuid=e++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),o!==this&&(t.data(o,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===o&&this.destroy()}}),this.document=t(o.style?o.ownerDocument:o.document||o),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),i),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var o,n,s,a=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(a={},o=e.split("."),e=o.shift(),o.length){for(n=a[e]=t.widget.extend({},this.options[e]),s=0;o.length-1>s;s++)n[o[s]]=n[o[s]]||{},n=n[o[s]];if(e=o.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=i}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,i,o){var n,s=this;"boolean"!=typeof e&&(o=i,i=e,e=!1),o?(i=n=t(i),this.bindings=this.bindings.add(i)):(o=i,i=this.element,n=this.widget()),t.each(o,(function(o,a){function r(){return e||!0!==s.options.disabled&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?s[a]:a).apply(s,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||t.guid++);var h=o.match(/^([\w:-]*)\s*(.*)$/),l=h[1]+s.eventNamespace,c=h[2];c?n.delegate(c,l,r):i.bind(l,r)}))},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(i).undelegate(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){var i=this;return setTimeout((function(){return("string"==typeof t?i[t]:t).apply(i,arguments)}),e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,o){var n,s,a=this.options[e];if(o=o||{},(i=t.Event(i)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],s=i.originalEvent)for(n in s)n in i||(i[n]=s[n]);return this.element.trigger(i,o),!(t.isFunction(a)&&!1===a.apply(this.element[0],[i].concat(o))||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},(function(e,i){t.Widget.prototype["_"+e]=function(o,n,s){"string"==typeof n&&(n={effect:n});var a,r=n?!0===n||"number"==typeof n?i:n.effect||i:e;"number"==typeof(n=n||{})&&(n={duration:n}),a=!t.isEmptyObject(n),n.complete=s,n.delay&&o.delay(n.delay),a&&t.effects&&t.effects.effect[r]?o[e](n):r!==e&&o[r]?o[r](n.duration,n.easing,s):o.queue((function(i){t(this)[e](),s&&s.call(o[0]),i()}))}})),t.widget})),function(t){"use strict";t.widget("aerolab.blockrain",{options:{autoplay:!1,autoplayRestart:!0,showFieldOnStart:!0,theme:null,blockWidth:10,autoBlockWidth:!1,autoBlockSize:24,difficulty:"normal",speed:20,asdwKeys:!0,playText:"Let's play some Tetris",playButtonText:"Play",gameOverText:"Game Over",restartButtonText:"Play Again",scoreText:"Score",onStart:function(){},onRestart:function(){},onGameOver:function(t){},onPlaced:function(){},onLine:function(t,e,i){}},start:function(){this._doStart(),this.options.onStart.call(this.element)},restart:function(){this._doStart(),this.options.onRestart.call(this.element)},gameover:function(){this.showGameOverMessage(),this._board.gameover=!0,this.options.onGameOver.call(this.element,this._filled.score)},_doStart:function(){this._filled.clearAll(),this._filled._resetScore(),this._board.cur=this._board.nextShape(),this._board.started=!0,this._board.gameover=!1,this._board.dropDelay=5,this._board.render(!0),this._board.animate(),this._$start.fadeOut(150),this._$gameover.fadeOut(150),this._$score.fadeIn(150)},setspeed:function(t){this.options.speed=t},getspeed:function(){return this.options.speed},pause:function(){this._board.paused=!0},resume:function(){this._board.paused=!1},autoplay:function(t){"boolean"!=typeof t&&(t=!0),this.options.autoplay=t,t&&!this._board.started&&this._doStart(),this._setupControls(!t),this._setupTouchControls(!t)},controls:function(t){"boolean"!=typeof t&&(t=!0),this._setupControls(t)},touchControls:function(t){"boolean"!=typeof t&&(t=!0),this._setupTouchControls(t)},score:function(t){return void 0!==t&&parseInt(t)>=0&&(this._filled.score=parseInt(t),this._$scoreText.text(this._filled_score)),this._filled.score},freesquares:function(){return this._filled.getFreeSpaces()},showStartMessage:function(){this._$start.show()},showGameOverMessage:function(){this._$gameover.show()},updateSizes:function(){this._PIXEL_WIDTH=this.element.innerWidth(),this._PIXEL_HEIGHT=this.element.innerHeight(),this._BLOCK_WIDTH=this.options.blockWidth,this._BLOCK_HEIGHT=Math.floor(this.element.innerHeight()/this.element.innerWidth()*this._BLOCK_WIDTH),this._block_size=Math.floor(this._PIXEL_WIDTH/this._BLOCK_WIDTH),this._border_width=2,this._PIXEL_WIDTH=this._block_size*this._BLOCK_WIDTH,this._PIXEL_HEIGHT=this._block_size*this._BLOCK_HEIGHT,this._$canvas.attr("width",this._PIXEL_WIDTH).attr("height",this._PIXEL_HEIGHT)},theme:function(e){if(void 0===e)return this.options.theme||this._theme;"string"==typeof e?(this.options.theme=e,this._theme=t.extend(!0,{},BlockrainThemes[e])):(this.options.theme=null,this._theme=e),void 0!==this._theme&&null!==this._theme||(this._theme=t.extend(!0,{},BlockrainThemes.retro),this.options.theme="retro"),(isNaN(parseInt(this._theme.strokeWidth))||"number"!=typeof parseInt(this._theme.strokeWidth))&&(this._theme.strokeWidth=2),this._preloadThemeAssets(),null!==this._board&&("string"==typeof this._theme.background&&this._$canvas.css("background-color",this._theme.background),this._board.render())},_theme:{},_$game:null,_$canvas:null,_$gameholder:null,_$start:null,_$gameover:null,_$score:null,_$scoreText:null,_canvas:null,_ctx:null,_create:function(){var e=this;this.theme(this.options.theme),this._createHolder(),this._createUI(),this._refreshBlockSizes(),this.updateSizes(),t(window).resize((function(){})),this._SetupShapeFactory(),this._SetupFilled(),this._SetupInfo(),this._SetupBoard(),this._info.init(),this._board.init();var i=function(){requestAnimationFrame(i),e._board.render()};i(),this.options.autoplay?(this.autoplay(!0),this._setupTouchControls(!1)):(this._setupControls(!0),this._setupTouchControls(!1))},_checkCollisions:function(t,e,i,o){for(var n,s,a=0,r=i.length;a<r;a+=2){if(n=t+i[a],(s=e+i[a+1])>=this._BLOCK_HEIGHT||this._filled.check(n,s))return!0;if(!o&&n<0||n>=this._BLOCK_WIDTH)return!0}return!1},_board:null,_info:null,_filled:null,_drawBackground:function(){if("string"==typeof this._theme.background){if(this._theme.backgroundGrid instanceof Image){if(0===this._theme.backgroundGrid.width||0===this._theme.backgroundGrid.height)return;this._ctx.globalAlpha=1;for(var t=0;t<this._BLOCK_WIDTH;t++)for(var e=0;e<this._BLOCK_HEIGHT;e++){var i=t*this._block_size,o=e*this._block_size;this._ctx.drawImage(this._theme.backgroundGrid,0,0,this._theme.backgroundGrid.width,this._theme.backgroundGrid.height,i,o,this._block_size,this._block_size)}}else if("string"==typeof this._theme.backgroundGrid){var n=this._theme.strokeWidth;Math.round(.23*this._block_size),Math.round(.3*this._block_size);this._ctx.globalAlpha=1,this._ctx.fillStyle=this._theme.backgroundGrid;for(t=0;t<this._BLOCK_WIDTH;t++)for(e=0;e<this._BLOCK_HEIGHT;e++){i=t*this._block_size,o=e*this._block_size;this._ctx.fillRect(i+n,o+n,this._block_size-2*n,this._block_size-2*n)}}this._ctx.globalAlpha=1}},_shapeFactory:null,_shapes:{line:[[0,-1,0,-2,0,-3,0,-4],[2,-2,1,-2,0,-2,-1,-2],[0,-4,0,-3,0,-2,0,-1],[-1,-2,0,-2,1,-2,2,-2]],square:[[0,0,1,0,0,-1,1,-1],[1,0,1,-1,0,0,0,-1],[1,-1,0,-1,1,0,0,0],[0,-1,0,0,1,-1,1,0]],arrow:[[0,-1,1,-1,2,-1,1,-2],[1,0,1,-1,1,-2,0,-1],[2,-1,1,-1,0,-1,1,0],[1,-2,1,-1,1,0,2,-1]],rightHook:[[2,0,1,0,1,-1,1,-2],[2,-2,2,-1,1,-1,0,-1],[0,-2,1,-2,1,-1,1,0],[0,0,0,-1,1,-1,2,-1]],leftHook:[[0,0,1,0,1,-1,1,-2],[2,0,2,-1,1,-1,0,-1],[2,-2,1,-2,1,-1,1,0],[0,-2,0,-1,1,-1,2,-1]],leftZag:[[0,0,0,-1,1,-1,1,-2],[2,-1,1,-1,1,-2,0,-2],[1,-2,1,-1,0,-1,0,0],[0,-2,1,-2,1,-1,2,-1]],rightZag:[[1,0,1,-1,0,-1,0,-2],[2,-1,1,-1,1,0,0,0],[0,-2,0,-1,1,-1,1,0],[0,0,1,0,1,-1,2,-1]]},_SetupShapeFactory:function(){var e=this;function i(e,i,o,n){return t.extend(this,{x:0,y:0,symmetrical:o,init:function(){return t.extend(this,{orientation:0,x:Math.floor(e._BLOCK_WIDTH/2)-1,y:-1}),this},blockType:n,blockVariation:null,blocksLen:i[0].length,orientations:i,orientation:0,rotate:function(t){var i=(this.orientation+("left"===t?1:-1)+4)%4;e._checkCollisions(this.x,this.y,this.getBlocks(i))||(this.orientation=i,e._board.renderChanged=!0)},moveRight:function(){e._checkCollisions(this.x+1,this.y,this.getBlocks())||(this.x++,e._board.renderChanged=!0)},moveLeft:function(){e._checkCollisions(this.x-1,this.y,this.getBlocks())||(this.x--,e._board.renderChanged=!0)},drop:function(){e._checkCollisions(this.x,this.y+1,this.getBlocks())||(this.y++,e._board.dropCount=-1,e._board.animate(),e._board.renderChanged=!0)},getBlocks:function(t){return this.orientations[void 0!==t?t:this.orientation]},draw:function(t,i,o){for(var n=this.getBlocks(o),s=void 0===t?this.x:t,a=void 0===i?this.y:i,r=0,h=0;r<this.blocksLen;r+=2)e._board.drawBlock(s+n[r],a+n[r+1],this.blockType,this.blockVariation,h,this.orientation,!0),h++},getBounds:function(e){for(var i=t.isArray(e)?e:this.getBlocks(e),o=0,n=i.length,s=999,a=-999,r=999,h=-999;o<n;o+=2)i[o]<s&&(s=i[o]),i[o]>a&&(a=i[o]),i[o+1]<r&&(r=i[o+1]),i[o+1]>h&&(h=i[o+1]);return{left:s,right:a,top:r,bottom:h,width:a-s,height:h-r}}}),this.init()}null===this._shapeFactory&&(this._shapeFactory={line:function(){return new i(e,e._shapes.line,!1,"line")},square:function(){return new i(e,e._shapes.square,!1,"square")},arrow:function(){return new i(e,e._shapes.arrow,!1,"arrow")},leftHook:function(){return new i(e,e._shapes.leftHook,!1,"leftHook")},rightHook:function(){return new i(e,e._shapes.rightHook,!1,"rightHook")},leftZag:function(){return new i(e,e._shapes.leftZag,!1,"leftZag")},rightZag:function(){return new i(e,e._shapes.rightZag,!1,"rightZag")}})},_SetupFilled:function(){var t=this;null===this._filled&&(this._filled={data:new Array(t._BLOCK_WIDTH*t._BLOCK_HEIGHT),score:0,toClear:{},check:function(t,e){return this.data[this.asIndex(t,e)]},add:function(e,i,o,n,s,a){e>=0&&e<t._BLOCK_WIDTH&&i>=0&&i<t._BLOCK_HEIGHT&&(this.data[this.asIndex(e,i)]={blockType:o,blockVariation:n,blockIndex:s,blockOrientation:a})},getFreeSpaces:function(){for(var t=0;t<this.data.length;t++)this.data[t]?1:0},asIndex:function(e,i){return e+i*t._BLOCK_WIDTH},asX:function(e){return e%t._BLOCK_WIDTH},asY:function(e){return Math.floor(e/t._BLOCK_WIDTH)},clearAll:function(){delete this.data,this.data=new Array(t._BLOCK_WIDTH*t._BLOCK_HEIGHT)},_popRow:function(e){for(var i=t._BLOCK_WIDTH*(e+1)-1;i>=0;i--)this.data[i]=i>=t._BLOCK_WIDTH?this.data[i-t._BLOCK_WIDTH]:void 0},checkForClears:function(){var e,i,o,n,s=t._board.lines,a=[];for(e=0,i=this.data.length;e<i;e++)0==(n=this.asX(e))&&(o=0),this.data[e]&&void 0!==this.data[e]&&"string"==typeof this.data[e].blockType&&(o+=1),n==t._BLOCK_WIDTH-1&&o==t._BLOCK_WIDTH&&a.push(this.asY(e));for(e=0,i=a.length;e<i;e++)this._popRow(a[e]),t._board.lines++,t._board.lines%10==0&&t._board.dropDelay>1&&(t._board.dropDelay*=.9);var r=t._board.lines-s;this._updateScore(r)},_updateScore:function(e){if(!(e<=0)){var i=[0,400,1e3,3e3,12e3];e>=i.length&&(e=i.length-1),this.score+=i[e],t._$scoreText.text(this.score),t.options.onLine.call(t.element,e,i[e],this.score)}},_resetScore:function(){this.score=0,t._$scoreText.text(this.score)},draw:function(){for(var e,i=0,o=this.data.length;i<o;i++)if(void 0!==this.data[i]){e=this.asY(i);var n=this.data[i];t._board.drawBlock(this.asX(i),e,n.blockType,n.blockVariation,n.blockIndex,n.blockOrientation)}}})},_SetupInfo:function(){var t=this;this._info={mode:t.options.difficulty,modes:["normal","nice","evil"],modesY:170,autopilotY:null,init:function(){this.mode=t.options.difficulty},setMode:function(e){this.mode=e,t._board.nextShape(!0)}}},_SetupBoard:function(){var e=this,i=this._info;this._board={animateDelay:1e3/e.options.speed,animateTimeoutId:null,cur:null,lines:0,dropCount:0,dropDelay:5,holding:{left:null,right:null,drop:null},holdingThreshold:200,started:!1,gameover:!1,renderChanged:!0,init:function(){this.cur=this.nextShape(),e.options.showFieldOnStart&&(e._drawBackground(),e._board.createRandomBoard(),e._board.render()),this.showStartMessage()},showStartMessage:function(){e._$start.show()},showGameOverMessage:function(){e._$gameover.show()},nextShape:function(o){var n,s,a,r=this.next;if(n="nice"==i.mode||"evil"==i.mode?e._niceShapes:e._randomShapes(),e.options.no_preview){if(this.next=null,o)return null;if(!(s=n(e._filled,e._checkCollisions,e._BLOCK_WIDTH,e._BLOCK_HEIGHT,i.mode)))throw new Error("No shape returned from shape function!",n);s.init(),a=s}else{if(!(s=n(e._filled,e._checkCollisions,e._BLOCK_WIDTH,e._BLOCK_HEIGHT,i.mode)))throw new Error("No shape returned from shape function!",n);if(s.init(),this.next=s,o)return null;a=r||this.nextShape()}return e.options.autoplay&&(e._niceShapes(e._filled,e._checkCollisions,e._BLOCK_WIDTH,e._BLOCK_HEIGHT,"normal",a),a.orientation=a.best_orientation,a.x=a.best_x),void 0!==e._theme.complexBlocks?t.isArray(e._theme.complexBlocks[a.blockType])?a.blockVariation=e._randInt(0,e._theme.complexBlocks[a.blockType].length-1):a.blockVariation=null:void 0!==e._theme.blocks&&(t.isArray(e._theme.blocks[a.blockType])?a.blockVariation=e._randInt(0,e._theme.blocks[a.blockType].length-1):a.blockVariation=null),a},animate:function(){var t=!1,i=!1,o=!1,n=Date.now();if(this.animateTimeoutId&&clearTimeout(this.animateTimeoutId),!this.paused&&!this.gameover&&(this.dropCount++,(this.dropCount>=this.dropDelay||e.options.autoplay||this.holding.drop&&n-this.holding.drop>=this.holdingThreshold)&&(t=!0,i=!0,this.dropCount=0),this.holding.left&&n-this.holding.left>=this.holdingThreshold&&(i=!0,this.cur.moveLeft()),this.holding.right&&n-this.holding.right>=this.holdingThreshold&&(i=!0,this.cur.moveRight()),t)){var s=this.cur,a=s.x,r=s.y,h=s.getBlocks();if(e._checkCollisions(a,r+1,h,!0)){t=!1;for(var l=0,c=0;c<s.blocksLen;c+=2)e._filled.add(a+h[c],r+h[c+1],s.blockType,s.blockVariation,l,s.orientation),r+h[c]<0&&(o=!0),l++;e._filled.checkForClears(),this.cur=this.nextShape(),this.renderChanged=!0,this.holding.left=null,this.holding.right=null,this.holding.drop=null,e.options.onPlaced.call(e.element)}}t&&(i=!0,this.cur.y++),(t||i)&&(this.renderChanged=!0),o?(this.gameover=!0,e.gameover(),e.options.autoplay&&e.options.autoplayRestart&&e.restart(),this.renderChanged=!0):(this.animateDelay=1e3/e.options.speed,this.animateTimeoutId=window.setTimeout((function(){e._board.animate()}),this.animateDelay))},createRandomBoard:function(){var t,i,o,n,s,a;for(t=Object.keys(e._shapeFactory),i=0,o=e._BLOCK_WIDTH;i<o;i++)for(n=0,s=e._randChoice([e._randInt(0,8),e._randInt(5,9)]);n<s;n++)a&&e._randInt(0,3)||(a=e._randChoice(t)),e._filled.add(i,e._BLOCK_HEIGHT-n,a,e._randInt(0,3),null,e._randInt(0,3));e._board.render(!0)},render:function(t){(this.renderChanged||t)&&(this.renderChanged=!1,e._ctx.clearRect(0,0,e._PIXEL_WIDTH,e._PIXEL_HEIGHT),e._drawBackground(),e._filled.draw(),this.cur.draw())},drawBlock:function(t,i,o,n,s,a,r){t*=e._block_size,i*=e._block_size,r="boolean"==typeof r&&r;var h=e._theme.strokeWidth,l=Math.round(.23*e._block_size),c=Math.round(.3*e._block_size),d=this.getBlockColor(o,n,s,r);if(e._ctx.globalAlpha=1,d instanceof Image){if(e._ctx.globalAlpha=1,0===d.width||0===d.height)return;if(void 0!==e._theme.blocks&&null!==e._theme.blocks)e._ctx.drawImage(d,0,0,d.width,d.height,t,i,e._block_size,e._block_size);else if(void 0!==e._theme.complexBlocks&&null!==e._theme.complexBlocks){null==s&&(s=0);var A=function(t,i,o){var n=e._shapes[i][0],s=Math.min(n[0],n[2],n[4],n[6]),a=Math.max(n[0],n[2],n[4],n[6]),r=Math.min(n[1],n[3],n[5],n[7]),h=a-s+1,l=Math.max(n[1],n[3],n[5],n[7])-r+1,c=t.width/h,d=t.height/l;return{x:c*(n[2*o]-s),y:d*Math.abs(r-n[2*o+1]),w:c,h:d}}(d,o,s);e._ctx.save(),e._ctx.translate(t,i),e._ctx.translate(e._block_size/2,e._block_size/2),e._ctx.rotate(-Math.PI/2*a),e._ctx.drawImage(d,A.x,A.y,A.w,A.h,-e._block_size/2,-e._block_size/2,e._block_size,e._block_size),e._ctx.restore()}else e._ctx.fillStyle="#ff0000",e._ctx.fillRect(t,i,e._block_size,e._block_size)}else"string"==typeof d&&(e._ctx.fillStyle=d,e._ctx.fillRect(t,i,e._block_size,e._block_size),"string"==typeof e._theme.innerShadow&&(e._ctx.globalAlpha=1,e._ctx.strokeStyle=e._theme.innerShadow,e._ctx.lineWidth=1,e._ctx.strokeRect(t+1,i+1,e._block_size-2,e._block_size-2)),"string"==typeof e._theme.stroke&&(e._ctx.globalAlpha=1,e._ctx.fillStyle=e._theme.stroke,e._ctx.strokeStyle=e._theme.stroke,e._ctx.lineWidth=h,e._ctx.strokeRect(t,i,e._block_size,e._block_size)),"string"==typeof e._theme.innerStroke&&(e._ctx.fillStyle=e._theme.innerStroke,e._ctx.fillRect(t+l,i+l,e._block_size-2*l,h),e._ctx.fillRect(t+l,i+l+h,h,e._block_size-2*l-h)),"string"==typeof e._theme.innerSquare&&(e._ctx.fillStyle=e._theme.innerSquare,e._ctx.globalAlpha=.2,e._ctx.fillRect(t+c,i+c,e._block_size-2*c,e._block_size-2*c)));e._ctx.globalAlpha=1},getBlockColor:function(i,o,n,s){var a=function(e,i){return t.isArray(e)?null!==i&&void 0!==e[i]?e[i]:e.length>0?e[0]:null:e};return"boolean"!=typeof s&&(s=!0),s?"string"==typeof e._theme.primary&&""!==e._theme.primary?e._theme.primary:void 0!==e._theme.blocks&&null!==e._theme.blocks?a(e._theme.blocks[i],o):a(e._theme.complexBlocks[i],o):"string"==typeof e._theme.secondary&&""!==e._theme.secondary?e._theme.secondary:void 0!==e._theme.blocks&&null!==e._theme.blocks?a(e._theme.blocks[i],o):a(e._theme.complexBlocks[i],o)}},e._niceShapes=e._getNiceShapes()},_randInt:function(t,e){return t+Math.floor(Math.random()*(1+e-t))},_randSign:function(){return 2*this._randInt(0,1)-1},_randChoice:function(t){return t[this._randInt(0,t.length-1)]},_preloadThemeAssets:function(){var e=this,i=new RegExp("^#[A-F0-9+]{3,6}","i"),o=(new RegExp("^data:image/(png|gif|jpg);base64,","i"),function(){e._board&&e._board.render(!0)}),n=function(t){var e=t;return i.test(e)?t=e:((t=new Image).src=e,t.onload=o),t},s=function(e){if(t.isArray(e)&&e.length>0)for(var i=0;i<e.length;i++)e[i]=n(e[i]);else"string"==typeof e&&(e=n(e));return e};if(void 0!==this._theme.complexBlocks)for(var a=Object.keys(this._theme.complexBlocks),r=0;r<a.length;r++)this._theme.complexBlocks[a[r]]=s(this._theme.complexBlocks[a[r]]);else if(void 0!==this._theme.blocks)for(a=Object.keys(this._theme.blocks),r=0;r<a.length;r++)this._theme.blocks[a[r]]=s(this._theme.blocks[a[r]]);if(void 0!==this._theme.backgroundGrid&&"string"==typeof this._theme.backgroundGrid&&!i.test(this._theme.backgroundGrid)){var h=this._theme.backgroundGrid;this._theme.backgroundGrid=new Image,this._theme.backgroundGrid.src=h,this._theme.backgroundGrid.onload=o}},_createHolder:function(){this._$gameholder=t('<div class="blockrain-game-holder"></div>'),this._$gameholder.css("position","relative").css("width","100%").css("height","100%"),this.element.html("").append(this._$gameholder),this._$canvas=t('<canvas style="display:block; width:100%; height:100%; padding:0; margin:0; border:none;" />'),"string"==typeof this._theme.background&&this._$canvas.css("background-color",this._theme.background),this._$gameholder.append(this._$canvas),this._canvas=this._$canvas.get(0),this._ctx=this._canvas.getContext("2d")},_createUI:function(){var e=this;e._$score=t('<div class="blockrain-score-holder"><div class="blockrain-score"><div class="blockrain-score-num">0</div><div class="blockrain-score-msg">'+this.options.scoreText+"</div></div></div>").hide(),e._$scoreText=e._$score.find(".blockrain-score-num"),e._$gameholder.append(e._$score),e._$start=t('<div class="blockrain-start-holder" style="position:absolute;"><div class="blockrain-start"><div class="blockrain-start-msg">'+this.options.playText+'</div><a class="blockrain-btn blockrain-start-btn">'+this.options.playButtonText+"</a></div></div>").hide(),e._$gameholder.append(e._$start),e._$start.find(".blockrain-start-btn").click((function(t){t.preventDefault(),e.start()})),e._$gameover=t('<div class="blockrain-game-over-holder" style="position:absolute;"><div class="blockrain-game-over"><div class="blockrain-game-over-msg">'+this.options.gameOverText+'</div><a class="blockrain-btn blockrain-game-over-btn hidden">'+this.options.restartButtonText+"</a></div></div>").hide(),e._$gameover.find(".blockrain-game-over-btn").click((function(t){t.preventDefault(),e.restart()})),e._$gameholder.append(e._$gameover),this._createControls()},_createControls:function(){var e=this;e._$touchLeft=t('<a class="blockrain-touch blockrain-touch-left" />').appendTo(e._$gameholder),e._$touchRight=t('<a class="blockrain-touch blockrain-touch-right" />').appendTo(e._$gameholder),e._$touchRotateRight=t('<a class="blockrain-touch blockrain-touch-rotate-right" />').appendTo(e._$gameholder),e._$touchRotateLeft=t('<a class="blockrain-touch blockrain-touch-rotate-left" />').appendTo(e._$gameholder),e._$touchDrop=t('<a class="blockrain-touch blockrain-touch-drop" />').appendTo(e._$gameholder)},_refreshBlockSizes:function(){this.options.autoBlockWidth&&(this.options.blockWidth=Math.ceil(this.element.width()/this.options.autoBlockSize))},_getNiceShapes:function(){var t=this,e={};for(var i in this._shapeFactory)e[i]=this._shapeFactory[i]();function o(e,i,o,n,s,a,r){var h,l,c,d,A=i.length,u=0,g={};for(h=0;h<A;h+=2)u+=e[t._filled.asIndex(o+i[h],n+i[h+1])]||0;for(h=0;h<A;h+=2)l=i[h],c=i[h+1],(void 0===g[l]||g[l]<c)&&(g[l]=c);for(l in d=0,g)for(c=g[l=parseInt(l)]+1,h=0;n+c<r;c++,h++)if(!t._filled.check(o+l,n+c)){d+=0==h?2:1;break}return u-=d}var n=function(i,n,s,a,r,h){h||function(){for(var t in e)e[t].x=0,e[t].y=-1}();var l,c,d,A,u,g,b,_,p,f,m,k,I,v,w,C=new Array(s*a),y="evil"==r,B=999*(y?1:-1);for(l=0;l<s;l++)for(c=0;c<=a;c++)if(c==a||i.check(l,c)){for(d=c-4;d<c;d++)C[i.asIndex(l,d)]=d;break}var D=void 0===h?e:{cur:h};for(A in D){for(u=D[A],I=-999,g=0;g<(u.symmetrical?2:4);g++)for(b=u.getBlocks(g),l=-(_=u.getBounds(b)).left;l<s-_.width;l++)for(c=-1;c<a-_.bottom;c++)if(t._checkCollisions(l,c+1,b,!0)){(p=o(C,b,l,c,0,0,a))>I&&(I=p,v=g,w=l);break}(y&&I<B||!y&&I>B)&&(f=u,B=I,m=v,k=w)}return f.best_orientation=m,f.best_x=k,f};return n.no_preview=!0,n},_randomShapes:function(){var e=[];return t.each(this._shapeFactory,(function(t,i){e.push(i)})),this._randChoice(e)},_setupControls:function(e){var i=this,o=function(t){t?i._board.holding.left||(i._board.cur.moveLeft(),i._board.holding.left=Date.now(),i._board.holding.right=null):i._board.holding.left=null},n=function(t){t?i._board.holding.right||(i._board.cur.moveRight(),i._board.holding.right=Date.now(),i._board.holding.left=null):i._board.holding.right=null},s=function(t){t?i._board.holding.drop||(i._board.cur.drop(),i._board.holding.drop=Date.now()):i._board.holding.drop=null},a=function(t){if(!i._board.cur)return!0;var e=!1;if(e=!0,i.options.asdwKeys)switch(t.keyCode){case 65:o(!0);break;case 68:n(!0);break;case 83:s(!0);break;case 87:i._board.cur.rotate("right")}switch(t.keyCode){case 37:o(!0);break;case 39:n(!0);break;case 40:s(!0);break;case 38:case 88:i._board.cur.rotate("right");break;case 90:i._board.cur.rotate("left");break;default:e=!1}return e&&t.preventDefault(),!e},r=function(t){if(!i._board.cur)return!0;var e=!1;if(e=!0,i.options.asdwKeys)switch(t.keyCode){case 65:o(!1);break;case 68:n(!1);break;case 83:s(!1)}switch(t.keyCode){case 37:o(!1);break;case 39:n(!1);break;case 40:s(!1);break;default:e=!1}return e&&t.preventDefault(),!e};function h(t){return"safekeypress."+t.keyCode}t(document).unbind("keydown.blockrain").unbind("keyup.blockrain"),i.options.autoplay||e&&t(document).bind("keydown.blockrain",(function(e){var i=h(e);return t.data(this,i,(t.data(this,i)||0)-1),a.call(this,e)})).bind("keyup.blockrain",(function(e){return t.data(this,h(e),0),r.call(this,e),function(t){var e={stopKeys:{37:1,38:1,39:1,40:1}},i=e.stopKeys[t.keyCode]||e.moreStopKeys&&e.moreStopKeys[t.keyCode];return i&&t.preventDefault(),i}(e)}))},_setupTouchControls:function(t){var e=this;e._$touchLeft.unbind("touchstart touchend click"),e._$touchRight.unbind("touchstart touchend click"),e._$touchRotateLeft.unbind("touchstart touchend click"),e._$touchRotateRight.unbind("touchstart touchend click"),e._$touchDrop.unbind("touchstart touchend click"),!e.options.autoplay&&t?(e._$touchLeft.show().bind("touchstart click",(function(t){t.preventDefault(),e._board.cur.moveLeft(),e._board.holding.left=Date.now(),e._board.holding.right=null,e._board.holding.drop=null})).bind("touchend",(function(t){t.preventDefault(),e._board.holding.left=null})),e._$touchRight.show().bind("touchstart click",(function(t){t.preventDefault(),e._board.cur.moveRight(),e._board.holding.right=Date.now(),e._board.holding.left=null,e._board.holding.drop=null})).bind("touchend",(function(t){t.preventDefault(),e._board.holding.right=null})),e._$touchDrop.show().bind("touchstart click",(function(t){t.preventDefault(),e._board.cur.drop(),e._board.holding.drop=Date.now()})).bind("touchend",(function(t){t.preventDefault(),e._board.holding.drop=null})),e._$touchRotateLeft.show().bind("touchstart click",(function(t){t.preventDefault(),e._board.cur.rotate("left")})),e._$touchRotateRight.show().bind("touchstart click",(function(t){t.preventDefault(),e._board.cur.rotate("right")}))):(e._$touchLeft.hide(),e._$touchRight.hide(),e._$touchRotateLeft.hide(),e._$touchRotateRight.hide(),e._$touchDrop.hide())}})}(jQuery),window.BlockrainThemes={custom:{background:"#ffffff",backgroundGrid:" data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABQAAD/4QMsaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA2LjAtYzAwNiA3OS4xNjQ3NTMsIDIwMjEvMDIvMTUtMTE6NTI6MTMgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCAyMi4zIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2RjZCMzdCMUE4RDMxMUVCQkIzRkI4NjY0MzVENzgxRSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2RjZCMzdCMkE4RDMxMUVCQkIzRkI4NjY0MzVENzgxRSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjZGNkIzN0FGQThEMzExRUJCQjNGQjg2NjQzNUQ3ODFFIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjZGNkIzN0IwQThEMzExRUJCQjNGQjg2NjQzNUQ3ODFFIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+/+4ADkFkb2JlAGTAAAAAAf/bAIQAAgICAgICAgICAgMCAgIDBAMCAgMEBQQEBAQEBQYFBQUFBQUGBgcHCAcHBgkJCgoJCQwMDAwMDAwMDAwMDAwMDAEDAwMFBAUJBgYJDQsJCw0PDg4ODg8PDAwMDAwPDwwMDAwMDA8MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwM/8AAEQgAQABAAwERAAIRAQMRAf/EAF8AAQEBAQAAAAAAAAAAAAAAAAAFBAkBAQAAAAAAAAAAAAAAAAAAAAAQAAAFAQgCAwAAAAAAAAAAAAABAgQFA7MU1FV1lQY2ESExcRIRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/AO9MjImyNvQoN1PXz1SktGiVEjz+C8rWtZ+kpSXyf0REZmAyXjk+Txe5VsCAXjk+Txe5VsCAXjk+Txe5VsCAXjk+Txe5VsCAXjk+Txe5VsCAXjk+Txe5VsCA1x0ib03FCu3UyfMlJS7aKUS/H7LyhaFl6UlRfB/ZGRGQDI47PD6XJWzEBeAAAAAAABBb9nmNLjbZ8AOOzw+lyVsxAXgAAAAAAAQW/Z5jS422fADjs8PpclbMQF4AAAAAAAEFv2eY0uNtnwA47PD6XJWzEBeAAAAAAABBb9nmNLjbZ8AOOzw+lyVsxAXgAAAAAAAQW/Z5jS422fADjs8PpclbMQF4AAAAAAAEFv2eY0uNtnwDXIxxvTb16DhTJ8yUpTR2lJL8fsvC0LQfpSVF8l9GRkZAMl35PnEXttbHAF35PnEXttbHAF35PnEXttbHAF35PnEXttbHAF35PnEXttbHAF35PnEXttbHANcdHGyNxXruFPXz1SVO3akkjz+C8IQhBekpSXwX2ZmZmA//2Q==",complexBlocks:{line:["game_assets/tetris/line_1.png","game_assets/tetris/line_2.png","game_assets/tetris/line_3.png","game_assets/tetris/line_4.png","game_assets/tetris/line_5.png"],square:["game_assets/tetris/square_1.png","game_assets/tetris/square_2.png","game_assets/tetris/square_3.png","game_assets/tetris/square_4.png","game_assets/tetris/square_5.png"],arrow:["game_assets/tetris/arrow_1.png","game_assets/tetris/arrow_2.png","game_assets/tetris/arrow_3.png","game_assets/tetris/arrow_4.png","game_assets/tetris/arrow_5.png"],rightHook:["game_assets/tetris/rightHook_1.png","game_assets/tetris/rightHook_2.png","game_assets/tetris/rightHook_3.png","game_assets/tetris/rightHook_4.png","game_assets/tetris/rightHook_5.png"],leftHook:["game_assets/tetris/leftHook_1.png","game_assets/tetris/leftHook_2.png","game_assets/tetris/leftHook_3.png","game_assets/tetris/leftHook_4.png","game_assets/tetris/leftHook_5.png"],rightZag:["game_assets/tetris/rightZag_1.png","game_assets/tetris/rightZag_2.png","game_assets/tetris/rightZag_3.png","game_assets/tetris/rightZag_4.png","game_assets/tetris/rightZag_5.png"],leftZag:["game_assets/tetris/leftZag_1.png","game_assets/tetris/leftZag_2.png","game_assets/tetris/leftZag_3.png","game_assets/tetris/leftZag_4.png","game_assets/tetris/leftZag_5.png"]}},candy:{background:"#040304",backgroundGrid:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAHHElEQVR4XsVZgZbkqgqkTO77//+dbuvtgQ7QcGwnO3PPZTPG1dhWASIxwP8OEcqTYhJ3ypsAuLqsB7KSNrQ14uMoXAXsnwNihoUDInKKbCdDf2YjPuL+KDRSyOpE1Q5k6JBJV7IJSfnvJUzf8RhyAOh9ADqN3vtz+am+zIXWHIK9l1D5ISuSTbv3aUAJZKfvmMYYBn3O6Y3W/lt2IFmmIHmbQDcCgOM4DCjJqeKsNgQAIe9ag13I4NNHoUWhomMn4BoiubXAqn27qAoNm9HLwhMAfQ10lgYxc5gqvgxcfuw8sdhMHKtD99IrGfCpkXZjBG9x9r8SizJ/JHF8Yww3hYszNDnz5uawDH3WsTESIZBcs6O5r36SVn4gmcFYJVmgSYZOMqmEdjf8vxV8riA4tG0Zo51qeeDQtQxhuP6hUmgYY/U/yu8JKYBVmGdZGznWhqBZoAefTTi7GYOY/jKHEPL57loObBU8zhL4z/P8UxbdN02sUzOSqKmlymZnCLckt2tdq41AOI8KyU4AQGfCrNEOkr0DPjxD767VBUls3qHNEfjdhdpWxa7++zkzVmMB+0PXcndy9yMogcwsd5fJAFzotccfgKBfArmukPKQQ8dCOvrGAXkNxBPekvMahyNbMZbfFFcDLcVPfgV8MoJOcgo2QcWDQZiNNh3lJ9IdaNRskCk0FMUZFJJhgTnpspxF3l5S/3UhuXgpq1EopxxQyX7V3pdB8ndxXo4aukmapDQaJAlSGGZzAu8bIdIDr/Lb6BnXTtgk/wLJnoCUbLSPR+PNTbAMmt3HCDPonnN/c0BrMU7MawAAmAQggOIweu9oGEUmiHLQBPxS+v2WSgDIwTgmjwrblgk1kBbtVId1p/453BAPR+5fJyKuQGQ49KLDWvnLSNQJse8e+SiunI/UcAQ5aTBo6ncj+HMLmGBH04WOqVkm+qPnQkwYBKR1GEpXcXOfpNVAOnSQmJS8euloqxd1fWLZUi2I4JCkvySWN/psMd8HDJhzyD/DdW5fBAFvIzvqKLsErOwcRkKUXT8D5CJdpkCvEG7Szz0r6qVFE6q0faCSxuV05kO8/GUBdOlNkL0wStgd/reRSgCE0FWPhoXfiS5Eg47P6CH8TBlSc+RSP31RCgjwytR5J0riVjsyh60AH3uVgKFPipkiQ/CBAyoUNsVvhE1HkL+SM6Gc6kW0QJrnSHENDa8J9jiYal07ND3uc75GAEkl4GWBkufc8hmsHYQeoUs3vb26TYfeoxBE6NBHxctbKwFV2eFvsdcU/2FdGsv/USX3nd01IfweWHx7i+qm6VmQ4ULBTAo+JrKjgHLXv386gveoiPIo1pEN5d4zyLVHnYYZYVkyjBAgmLUZzV3XPSHo6IMoe4p0U8Z6d/R7VRIoSwsINl5VzVSEXfdcL8P+gYPJD/CuEuAqus/FaQW70Vld/47EOiCawZRAiSBrZ+yooFy7+VG0yHcX4l8eTXLpQn0oIADxIUMBeoDtrsHW87EdsvtvbxgQSResFIHjRFZtj6KEX+ucgZ0D9+iL89avBCLvBMQ5RCUU3pOwvmVSwKwPMNWFoHvSTrXoCenqi8FwZMN7rYEOEN4bJnFBRcK4gi21nClKFOYZ7ZJLYxKwDRYEeXJs1tl92fv9tq/nQkguSVgF9FPonquwBi1ssdbxApQcgkvIAHbpdADKHsLw/C430332xJ8JYSJ6Z2emUHg6ehBCwB0JsQU1ENgmKz2WouXmWCUjKN4CYGOBqn4IWLlmxPTZuYUOh/Kqg6hnY/clDrbsh0jTsMe/lf0oflbRjYAlIiTXYRy3ImfbEN76xG+QT8c5KZPEVBKjKRgFY9vf4KTpkL2F1Ia6fK+2xTrvX5bmnO1Lvd6nkno8nxp6jkEBkOMNwi1GnS5MopWs7c6f9mMoKmlM4sDctT5VHo/Hi4DKgTF8LnLqPQbHLMNahn859fKCESuoLqtoBZC2zfj5LtHsun8+n19fX3/KOVXhyQLkyzknJylTcBw4j6GoHYCBLi/lNRKGC61fQZHA8yJe7AafzV3/oZJei5GjEC8ak4Q8XsobHFrJ2x9IYXtzjQAFpibC+kmUE3f6tJ4P0LGWU/c/Wi/ofYrzdR9G4eIqU54PhXoA42oXRi49BCNY2VCUPIgxiB47AYCC7HB8vgzBpAwgEVChSn2hiayfcZF8zikPOUXGIaBMDQBzUtEfA0Yg1Mp+YqU+eVVIRW8GiO8pIlNCGPfwnwg7RWiL+J+BEY3FK3wVTc7Hw9YPXaGkkDKZxAO0VTn1ojDaqaU1+lOqHuoVffkDducA9e4Th1sApnswouIEByhD5iRBe0TAMSzj85P8IAW3Rjp/prYL7E4CQu0IA033s1C/lUIO5QMBEQQOlHOhnogxciC+12k3l3DffqyXx01JP8p8CemsQ/9yGcwBFfk/Wqz6T1UU/3cAAAAASUVORK5CYII=",blocks:{line:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAIAAADZrBkAAAACuklEQVR4Xi2MzW4cRRSFz/2p6p4eT2zjjE2MHBQWvAALNjwDS8SOFc/FIyCxQgh2LFHkBQgJyQo/wXKCEZ7x9E9VV93LBPNJ516dxXfo/U8+HTZ9uzrZympTjLo4DbtDiBpXSBGMocI5lkaMhKv0fz+LVX9P6ZuvvxqBby+3L3eJu6Zt27DL4qgIWW0KsxPC3Kjxz5fPT3z48csvtHSHd0C/1374RddPX/9xK6JdcjEutNfqFJMBsQat3By+i/7VxqJ6c/zd5avvn1+N7dl2V9Ad92M2ViI2ksyWSJ2QXQXc5/H25jYcHHKl1YYebcJqw/rW03OOzfr89NHbR8vH3Wq9Olofrddni+XhycXJhBSkKFLxWeHBZFFDVyD343Rzc/0XeYSXeXZIJaam2V9pLsBOtRIKYAorXqvAg8giaKsCKw1zJAGFbKhwtxrdG9E3BQxAIW1xyYUKUIwNxMAwDEwuSgA5iAw2l5ITOeE/GLRMihIOsnQZnKqOlWXRUWidyYkFpCxtCF1s8D+seBggYVYRhChkqqjmld3NKhhu1XKuKUf4g6egEitkvqc5ewo+3ZOVZJO4Q4OSEDGRRyAQkYH8QfMUCR07KS8DIsO8xhjcnUXnSv4GMRYShSUG2MFCeby/awOJFyvF3TU22ckk3E3FQjci+mJVggwz12rKVEvWOk3dwWpIr7ezrU4XZ+9ciBAxWCVlhDb2o5cZTgBR17R3w45hgg8/fu+Dj643adZVXzCmebsbp5T6fhr2L9W8z5xLNsyDpl2btrsXPynS9NvVVc28xzMLPDCUYbVUMy+TMgdinupCEapdvPv0lqGwjW9fHsXjF39eIzRpnFbLdiy918qCWmclnq3mcWhVnzw5v+83XYz0+LPP/8lL704NB3BBdbCDKlChAq8QgRvmGSFouyo3vz7Lr/8FMHqie3VCpNQAAAAASUVORK5CYII=",square:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAIAAADZrBkAAAACfUlEQVR4Xh3LvY5cRRBA4VNV3ffe+fEaZARgWfBExEhEZEg8A69AgkC8AzEiICMgJCdAxggsGRuW3Z3dmenbXVWskT6d7MiXnz3qclu87esm1qW3NteRuqaCIAmQABwPvPU2NyeaUa6P159/9QV3l/HqlWqN41El0PaadEJAoZBKqS9+eybL/tvvvi8PrHA4ku33pz9v5rafKmc0I7QhbiGaJSikyeCh1T7OG6fMluOvP/5+8csb+/RxhUtlEXA5KUMpiEpWwZKU3D799Zl1CtpEjsoh++HRxUMBVhgry4yUXLvstnE8qWi/HZndTEwpppj5XLIg7fZ4+fJlb91jzSlGhjc2O7RMj995nApRIRW0BHRl9UXLona6PYiGGKpaa50qPtQ96/5BCgkpBKghpI7VJZK5bmYju5IxQkZONqtbu+txd5ZEQFI0KaRRJxEZY0wjh/dqKqbZ/z9tqmJIqpQSnaD8T9sYkGqWmuTIZHgoWYupKh4SqSQimqrJfeV1gTECF4NKmUHwDFRqNSuJjMTxFQANNKGUyTBxYqSX6J6USdc1BquYFhEMFEQCUvSeC5rheL/Y74kAvX/OPXRZojIkqHkaLpMwWdYJm1fHlZIJotdXN7tFtczvvfuB5MIyRZwQ11pora2BTKOvva3zPKtStpsKLNNmmcr53xtFMtLaGLSR61IKKaPHenO1L2+qThqrn5FvPuGjjz8s4x+NI6Ptdvtxckywo0cjstZZZfZhNhSWNuoPP/5Udhebc8+tbp4//zPd6dcaGtJtWtUiVkhTWSJkTn3y5P15M19ervL1p9UZFzX9zHYmO1Ph3KFQK+rkIBMScbY7DicOzn+QRoW5iamqhgAAAABJRU5ErkJggg==",arrow:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAIAAADZrBkAAAACsklEQVR4XhWPu25bVxREZz/OuQ9RVKhXjBSu8gX5h+QD0udD8ilByjRpUqZxa6RxY8DuYlhwHhAc2qRIieK9vOfsvUMNBoPVrGLoh6+++7y7mbFfTNIVdShCxCGuAgE8tSilhOVWU6lrtPjPK33ffvvb6xd4KG9/+f1kenIYoAgOIc+AF9u5Rdteuvubty9LU168fqW9z7AFanr36uPZSOIgWHB1IJABKE0keSr3QdLolXitjw1n717++sfPP/7Ula6pfbYmeU7eaBybnzg6ewwpT8DW/vth2acFkzf9Pi0OOU1+/eVlM2/m14vZ+Rfz88t+Np+fnZ8tns1OL66vLss0FIughgppDumLzIpmYBrHz+uVsZVSsraorJoMQU5dOs3K3jaiSXGciNYoG3cQcbJjwiKC3Ny9ljhEEUlGBnh4IJwR+qQ6q7FbuMPBLEQCVjaYA0mYwcyIY6p5qYFQQqOexRMhHOqg6sV8mtiqQki51gSHV6YAMYMMxgIC2IOcBcIsQipBBCIjNqEQBWARjjAOHAtSh1eqk9bqLpBKQUSZE4ccIqpJFnWQiRSKypjUA1DgEDw5janNkgA4zKmGQtpgsNqhMoRCmRni4AgKJh6DB842TffENWWqU+m448eYje186GZT31nXo5EqPhUGIqoGwd1gtWFtRBeLxcXF1TydYh+td1E5lMdpOOxGr9bPOzdrtFGWk2lAg84e9/fYbGmsync0xD7mfkITgUMbJaKc26GOVn2sB61Gf958OE992wsoQjSSjBHUwEmlISTsxjEsOIsxP3v+/M3tey3wrRVh29wuA2Vo3Xoe3KP6Endhzh3v92NjKefcXZzETKxR+Sa+vt2s3/3z127YrYfN+mGz2m4+rT+tNuu77d3yfvn3+vbh8eH4bb3dLrer97c3q7L6H15gvODKB5u4AAAAAElFTkSuQmCC",rightHook:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAIAAADZrBkAAAACqElEQVR4Xh3PO2tlZRSH8f9a73XvPTkTExl1dLAIKFpNY2Fl4UcT7G3FwmIaO3sbEfQjWAxDAkIORDHJyXFf3stayzC/9qke+ubrF0u7zqwfsJNFXEKtCAJriBGBoB0gNAZ5WIekcC0f+br8++3Pr1AP5Y/f6Xgfx4RqoB2kI27QgkYQw5BA2L95M+vTn379y0c2HI+Y5Ob6z3B/M/ZmlTieV7ISj9rXZ2n338NciEMedGshJacbZ9X16vK3H76vh/1paCOWiWvos5M1U9llLIebKeqz0zG4PmZ/dfl6XWc/9p4Ox/fMwnIcXrwL6ohPg54OZhYTUUc+w1YQ83z3kMadEKdp8EmE54cnKifTBLOr17cqtwIf4gAuKhUd8Lh4+TKPowjyOK1l8cxAm9nK2nWnsQeAyNtgldnClCLntkrRrTBcFyPjYRg8AEAY4JDhkhp7uOBIRbyqrmK+KcBm1qU30UbSxHcGnIGpKYk63dQxnC2sPcWo2slZUCCGYXPkkBnUqjcCSAGFsaOUQk5koqUqPFV5G2sDai+tG3vv6ZF3BojBzFrvpeij4KtDZTjPXTWGBA91uWJTo1WkqTAZoAbpT3ejd0YOBW1zoAHE/tG8FThm52KOLnDv1dA8DACTwbRU6TxSaX1WZII/1qBgwLvWtgN6ieQc2hC9hwLGTFS35eTJ7uOL5xxTkZI44l7BDGpwBke8FFCA9Pj2EAipHbd8Qre3fxOMDWykGryyM2Vv67JwmCJ7cQRRM6JXX+CrLz97/uHJ4bgHFUdKBi8B5gECLLAys4grAkr5Vt758ZdLTwhuPNvfHP7ZPzjrBAHYLBlChwPQ+jrtpq2UJv3i0/clni/Y03efYzxPvZdBkAzeAKATukENAoTA86ynZ3GrVQl3Eu/yJ/8D33mmeKR3Cz8AAAAASUVORK5CYII=",leftHook:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAIAAADZrBkAAAACq0lEQVR4Xg3HO24mVRBH8X/Vrfv4ut02BjS8GSBAQuyCmE0gwSLICFgCBLASAhLiiQjQICFBMAMSFn63v+77qCp89EsO5U+/rus/0zQPPW8thXRQABLAjtHAAZ2gzGk2HRCG1YMPwgdf/fnXj1fX+O7732s/A0kzbwEUCW5Fgh8HGVdFTOn5H79NiZ/98rPATBVS8OzX5xTehYsxd3KFwXcGEljVOGVJ8a7W4Q4YT8sb33z70xdf/oB8HufzhjI0m2a3JLykuAyV4RGxrLVN5+f/3dxSKXJc59qfUk77djhdXhGx0/mMAg/rpm30bXq97Fp3su1mrMe19e46BLLw9Nb1w0WaZoO+fPmCNbTW3D1Fcjci77Cnn3wMhCBpWU7vuwqo3evgaar6QHRqfRXKhQiELFG1O6H3MZUyLpTIx24UMkNASbqZwZiN3AQsgKhZ6/VYR9OcDw/blg5xmKqPnIRBLQUZw4iIWQKydRcEcvLOOZ2A80Nv8SRv1iiHQWPXewbztm3MbObMYgpGCMwiwgwAIhJCAGBmjMD+KDJJThJzTI8TKZm5E9S7U3c0s6PrkVujvYbm0Qr1iceJ+GZ9772OMawNDNAgVm8cADcAQSgzCSiChZj8MRLwXCTPufQEC8SlVKPWNTJJ4BTDcds58tCaMsVoIQ8Nq2AgS97uVg2h7v29Dz86W86MGqB922F+djjsdbWE0eu233fbwF0opd57KYU43l5ewQ43N7d17CwUHJnlsl4QmUwkJJKZ5uXaLdBrnzl6EGbTbV2nVIiMuMU44EMwMjn76GMHeWAKhKuLvyXoC+F3IvXrfy9zmO/WKyUM6c1riWUY7btKiA+9UkyvPnk7KFMPtLz/uS9vrjVFLNqTUSEJNLN5hQL7gIXpsGytO0ekCduR/fg/hV+olVqSm3YAAAAASUVORK5CYII=",rightZag:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAIAAADZrBkAAAACt0lEQVR4Xg3LOW6eVRQG4PcM937DP9hYlkgUQ6RQsAiEWAC7YCWUtGyAFqhpEHRI0CCBIjpHJBSxEhzkxP6H+93pHPz0D3358IsbuyY/XlCs7/YU5zjFZgdGp07BEDq4KXwA0PvuqIfDGbT0u69/+hZvr/DrH1gc1WENwUAGM3RDcXQGRbA9/e3nJPX3F5dqdY/ja8ztx++/+YhX5S6P47REODW2Pra+qsbOR5VFWwjHVPKJJF1FevPn019++O7jeYo3h5VG8Ua5OLnCh25T7+RwYfZavVz993q5OehccfImnV3nqdLjD54gTiDAF3cnEJrBAbZNSS//vTKP1FcTk0ppsfYzkpEt58Pls8vb29vTabDWYZJzjsqnJ+vHjx9tVvf3qG3QVpXJ0Y5L2xWmYbPt7W5WeK7RKUqICic7poQY6q4Fw2AUDSykUGUlQ0cUy3XUqCxm8Obe4SypVoRwOC7kLE5szIoBHsmlO6NJO3Qv5GEozI3IiE25K2EeLAiYADiBOwi51NLdCRrGcQ5xTLVUcg1BVeFszXtaWinkIAcALigQDwISby0Vq3dpR8IA2r1cKNfZRTq9F2c1iLuYqQcHg2Dmvbam08QUG1V07zASqDCLouSSE0tojCbGablFoMgkpMxht9QukvICASIXtNLy7rDDakVDeGepzpIUup1mlIZs5Dbo9OknnwEELGgZJgBhHHDYIx/v8/r98+d/P2cVVSOkitRPN9uXfz0j2rRSh1CZDKRmFomgnns62Wyvrq+ncTy2JJ/rRXv76vx04ymr83pci9gYRYISS4N3cgRKvYb15EHOHzy8fPaPgtMe8zHG5y8uH6y3wa7LPbNOIIkQRpCOZt7KzatHFx+Ww0Ki9NX8ZHWy7Sltchtz2aj32nicjZkpLr1m760vp5tN2e8jtHX0Yf4f3da+1L4oEEQAAAAASUVORK5CYII=",leftZag:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAIAAADZrBkAAAACtElEQVR4Xg2Lu25cZRhF93f5L3OOPeOQmJuDhEIHDa/CC/B4SHSICqS0CERDE2MJAYKEmITEcewZz/nvH7O0taq16eTL++P66nhCDegOAEhghFYhDDM0hSgowQkKkDIwJi0pP/72G9j24vIi8S7nN34lYG1VyOKg0uVKFFIiY/XL+R8s977+6nvttBMkovTDz9/Np3G3fTlvYkoFJswzaxtya2haQ0nUdGa2PLY6GD/9+vjJ+Y+bD+K2vFxtrLS3cQq9t1rLwUZ7IpuOAmQQ8u9/PgFDWbG5708/jK/Ti9OzExErhYVU1TMrCZqV7fY2Or2+uQ5H7zgPMNQF5HL7+upZeFeHLU//etrraM2YedQBAXsnoPXHn8yrcHVzE0LICWoECTQf+SG19dRqK3tMUxSRZtkIZtqbsblW+vF8/Pzy1XoNvdthjDas7He7swdno+JkM21v997r6A1MIKNBwiCiXssqhNsbcAwQosPTeek1MzBa947NmnewYcGR8Oh1sZG8s5LvQoACaK0Yegi+965MNWXnxIAx0AdyWnqDMjuh1KoIkYGNUPqh0zHaYcpwoin1ZiBFjFBVEWLm1ppzTkQAsAQYQdwhTap+dBCRXzkW6g2lIpdqRkYE1v1+AZgEuiRo8G2YaCBo75ZylSCdiMnoYPVefO1k8AYm7rlAjUDi7/ZN18HIffbp5zFO22Vf0bzXfsBQUu4DIJ6P1/t/XowB9RGl4Xj94M62zy+vou2sDUySyhJjTDXpAeL9YFKXaxYnuoL2BRfnzxghj7YKm4liHkszGkOUjtxIYjKM9ncpTnPr4+HDj8j+U5/B5R5k/vfv344m6rfXHb3NSqKvdrs5xKUWeN95nUd69Oi9vpQI0PtfTAn7eE/eLF0Y92eUjrcDISBmrBjbgkrIDPFYCfoCLPgflXOjuIEFgMYAAAAASUVORK5CYII="}},modern:{background:"#000000",backgroundGrid:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAIAAAC0Ujn1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjZTg0NzU4MC00ODk3LTRkNjAtOWNhYi1mZTk1NzQ5NzhiNjkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTEzOEQwMDc5MDQyMTFFNDlBMzlFNzY4RjBCNkNENzMiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTEzOEQwMDY5MDQyMTFFNDlBMzlFNzY4RjBCNkNENzMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDplNDRjOWZiNC0yNzE5LTQ3NDYtYmRmMi0wMmY2ZTA4ZjAxMmUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MzMwNTNEOTk5MDM1MTFFNDlBMzlFNzY4RjBCNkNENzMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7Y01+zAAAAMklEQVR42mJgGAWjYBSMgkEJGIlUd+j/WjjbjjGYGC1MtHP10DR6FIyCUTAKBikACDAA0NoDCLGGjH8AAAAASUVORK5CYII=",primary:null,secondary:null,stroke:null,blocks:{line:"#fa1e1e",square:"#f1fa1e",arrow:"#d838cb",rightHook:"#f5821f",leftHook:"#42c6f0",rightZag:"#4bd838",leftZag:"#fa1e1e"}},retro:{background:"#000000",backgroundGrid:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAIAAAC0Ujn1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjZTg0NzU4MC00ODk3LTRkNjAtOWNhYi1mZTk1NzQ5NzhiNjkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTEzOEQwMDc5MDQyMTFFNDlBMzlFNzY4RjBCNkNENzMiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTEzOEQwMDY5MDQyMTFFNDlBMzlFNzY4RjBCNkNENzMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDplNDRjOWZiNC0yNzE5LTQ3NDYtYmRmMi0wMmY2ZTA4ZjAxMmUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MzMwNTNEOTk5MDM1MTFFNDlBMzlFNzY4RjBCNkNENzMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7Y01+zAAAAMklEQVR42mJgGAWjYBSMgkEJGIlUd+j/WjjbjjGYGC1MtHP10DR6FIyCUTAKBikACDAA0NoDCLGGjH8AAAAASUVORK5CYII=",primary:null,secondary:null,stroke:"#000000",innerStroke:"#000000",blocks:{line:"#fa1e1e",square:"#f1fa1e",arrow:"#d838cb",rightHook:"#f5821f",leftHook:"#42c6f0",rightZag:"#4bd838",leftZag:"#fa1e1e"}},monochrome:{background:"#000000",backgroundGrid:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAIAAAC0Ujn1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjZTg0NzU4MC00ODk3LTRkNjAtOWNhYi1mZTk1NzQ5NzhiNjkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTEzOEQwMDc5MDQyMTFFNDlBMzlFNzY4RjBCNkNENzMiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTEzOEQwMDY5MDQyMTFFNDlBMzlFNzY4RjBCNkNENzMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDplNDRjOWZiNC0yNzE5LTQ3NDYtYmRmMi0wMmY2ZTA4ZjAxMmUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MzMwNTNEOTk5MDM1MTFFNDlBMzlFNzY4RjBCNkNENzMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7Y01+zAAAAMklEQVR42mJgGAWjYBSMgkEJGIlUd+j/WjjbjjGYGC1MtHP10DR6FIyCUTAKBikACDAA0NoDCLGGjH8AAAAASUVORK5CYII=",primary:"#ffffff",secondary:"#ffffff",stroke:"#000000",innerStroke:"#000000"},aerolab:{background:"#ffffff",primary:"#ff7b00",secondary:"#000000"},gameboy:{background:"#C4CFA1",primary:null,secondary:null,stroke:"#414141",innerStroke:"#414141",innerSquare:"#000000",blocks:{line:"#88926A",square:"#585E44",arrow:"#A4AC8C",rightHook:"#6B7353",leftHook:"#6B7353",rightZag:"#595F45",leftZag:"#595F45"}},vim:{background:"#000000",backgroundGrid:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAIAAAC0Ujn1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjZTg0NzU4MC00ODk3LTRkNjAtOWNhYi1mZTk1NzQ5NzhiNjkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTEzOEQwMDc5MDQyMTFFNDlBMzlFNzY4RjBCNkNENzMiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTEzOEQwMDY5MDQyMTFFNDlBMzlFNzY4RjBCNkNENzMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDplNDRjOWZiNC0yNzE5LTQ3NDYtYmRmMi0wMmY2ZTA4ZjAxMmUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MzMwNTNEOTk5MDM1MTFFNDlBMzlFNzY4RjBCNkNENzMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7Y01+zAAAAMklEQVR42mJgGAWjYBSMgkEJGIlUd+j/WjjbjjGYGC1MtHP10DR6FIyCUTAKBikACDAA0NoDCLGGjH8AAAAASUVORK5CYII=",primary:"#C2FFAE",secondary:"#C2FFAE",stroke:"#000000",strokeWidth:3,innerStroke:null}};
var Tetris=function(){let t=!1,e=0;function o(){$("#tetris .tetris_cont, #tetris .tetris_footer").removeClass("hidden"),t=!1,e=0,$("#tetris .game").blockrain({showFieldOnStart:!1,blockWidth:15,autoBlockWidth:!1,autoplay:!1,theme:"custom",difficulty:"normal",scoreText:Language.getItem("game-points"),gameOverText:Language.getItem("grat-text"),onGameOver:function(e){t||($("#tetris .tetris_cont, #tetris .tetris_footer").addClass("hidden"),$("#tetris .final_score").html(e),$("#tetris .final_content").fadeIn(400),$.ajax({url:"api/",method:"post",data:{do:"saveTetris",score:e},success:function(t){setTimeout((function(){$("#tetris .final_content").fadeOut(400),$("#tetris .start_content").fadeIn(400)}),5e3)}}))},onLine:function(t,o,n){e+=t;let r=parseInt($("#tetris .game").blockrain("getspeed"));r+=4,$("#tetris .game").blockrain("setspeed",r)}}),$("#tetris .game").blockrain("setspeed",20),$("#tetris .game").blockrain("start"),$("#tetris .blockrain-score-holder").appendTo($("#tetris .tetris_footer"))}return{Init:function(){$(document).on("mouseup touchend","body",(function(t){var e=$.Event("keyup",{keyCode:39});$("body").trigger(e);e=$.Event("keyup",{keyCode:39});$("body").trigger(e);e=$.Event("keyup",{keyCode:37});$("body").trigger(e);e=$.Event("keyup",{keyCode:38});$("body").trigger(e)})),$(document).on("mousedown touchstart","#tetris .right",(function(t){t.preventDefault();var e=$.Event("keydown",{keyCode:39});$("body").trigger(e)})),$(document).on("mousedown touchstart","#tetris .left",(function(t){t.preventDefault();var e=$.Event("keydown",{keyCode:37});$("body").trigger(e)})),$(document).on("mousedown touchstart","#tetris canvas",(function(t){t.preventDefault();var e=$.Event("keydown",{keyCode:38});$("body").trigger(e)})),$(".start_btn",$("#tetris")).on("mouseup touchend",(function(t){t.preventDefault(),$("#tetris .start_content").fadeOut(400),o()}))},startGame:o,pauseGame:function(){t=!0;try{$("#tetris .game").blockrain("gameover"),$("#tetris .tetris_cont, #tetris .tetris_footer").addClass("hidden"),$("#tetris .start_content").fadeIn(400)}catch(t){}}}}();
var Texts=function(){var t;function e(){var e=AppData.texts.filter((function(t){return t.active})),a=$(document.createDocumentFragment()),n=$("#texts #textsList");$.each(e,(function(e,n){var l=t.clone();l.attr("data-index",n.id),l.find(".data-title").html(n.title[localState.lang]),l.appendTo(a)})),n.html(a),$("#texts").find(".noresults").toggle(Boolean(!e.length))}function a(t){writeDbLog("open text",String(t),"user_logs","texts"),t&&(null!=localState.texts?t===localState.texts.itemIndex&&0!==localState.texts.itemIndex||(localState.texts.itemIndex=String(t),n()):(localState.texts={itemIndex:String(t)},n()),Layout.show("texts-details"))}function n(){var t=$.grep(AppData.texts,(function(t){return t.id===localState.texts.itemIndex}));if(t.length>0&&null!=t[0].text[localState.lang]){t[0].text[localState.lang].indexOf("{{name}}")>-1&&(t[0].text[localState.lang]=t[0].text[localState.lang].replace("{{name}}",AppData.profile.name[localState.lang])),t[0].text[localState.lang].indexOf("{{email}}")>-1&&(t[0].text[localState.lang]=t[0].text[localState.lang].replace("{{email}}",AppData.profile.email));var e=$("#texts-details");let a=t[0].text[localState.lang],n=/#([a-z0-9 ;.,?!/_-]*)#/gi,l=n.exec(a);for(;null!=l;){let t=l[1].split(";");4==t.length&&(a="1"==t[0]?a.replace(l[0],'<button class="btn bcbtn" data-broadcast="'+t[2].trim()+'" data-channel="'+t[3]+'">'+t[1].trim()+"</button>"):a.replace(l[0],'<button class="btn vstagebtn" data-room="'+t[2].trim()+'" data-channel="'+t[3]+'">'+t[1].trim()+"</button>")),l=n.exec(a)}$("#texts-details .header-secondary .data-label").html(nl2brStrict(t[0].title[localState.lang])),e.find(".data-text-title").html(nl2brStrict(t[0].title[localState.lang])),e.find(".data-text").html(a),$("#texts-details .outer .container .jump_to_a").click((function(){!function(t){let e=$("#texts-details .outer .container"),a=$("[name='"+t+"']");e.get(0).scrollTop=a.get(0).offsetTop}($(this).data("jump"))}))}}return $(document).on("click","#texts .item",(function(t){a(this.dataset.index)})),$(document).on("click","#texts-details .vstagebtn",(function(){let t=$(this).attr("data-room"),e=$(this).attr("data-channel");null!=e&&"undefined"!=e&&""!=e&&Channels.setChannel(e),openTrueConfCall(t,"workshop"),$("#landing .navplusbutton i").hasClass("fa-minus")&&$("#landing .navplusbutton .open-main").trigger("mouseup")})),$(document).on("click","#texts-details .bcbtn",(function(){let t=$(this).attr("data-broadcast"),e=$(this).attr("data-channel");null!=e&&"undefined"!=e&&""!=e&&Channels.setChannel(e),Layout.hideAll(),Broadcast.playStreamByURL("https://"+t),$("#landing .navplusbutton i").hasClass("fa-minus")&&$("#landing .navplusbutton .open-main").trigger("mouseup")})),{Init:function(){t=$("template#tplTextItem").remove().contents(),localState.texts=localState.texts||{},localState.texts.itemIndex=localState.texts.itemIndex||0,e(),n()},renderList:e,update:function(){$.post("api/",{do:"getTexts"},(function(t){AppData.texts=t,e(),n(),t=null}))},showDetails:a,renderDetails:n}}();
var Translator=function(){var t,a,n,e,i,s=new wowzawebrtcpublish,l=!1;let o;function r(){var a=$(document.createDocumentFragment()),n=t.clone();AppData.translator.sort((function(t,a){return void 0!==t.sort_id&&void 0!==a.sort_id?parseInt(t.sort_id)>parseInt(a.sort_id)?1:-1:0})),$.each(AppData.translator,(function(e,i){null!=i.visible&&i.visible&&((n=t.clone()).attr("data-id",i.id),n.find(".data-name").html(i.name[localState.lang]).attr("data-id",i.id).attr("data-server_url",i.server_url),n.appendTo(a))})),$("#translator #translatorList").html(a)}$(document).on("click","#translatorList .item .publish",(function(t){t.stopPropagation();var s=$(this).closest(".item");if(i=s,"turnoffTranslation"!=(a=s.attr("data-id"))&&(n=s.attr("data-id")),$("#translatorList .item").addClass("disabled"),s.removeClass("disabled"),null!=e&&l)return $("#translatorList .item").removeClass("publishing"),$("#translatorList .item .vol-settings i").addClass("hidden"),void m();if("turnoffTranslation"==a||a==n&&null!=e)return $("#translatorList .item").removeClass("publishing"),$("#translatorList .item .vol-settings i").addClass("hidden"),void(null!=e&&l&&m());var r=AppData.translator.find((function(t){return t.id==a}));writeDbLog("start",a,"user_logs","translator"),console.info("---------------------------------",a),e=r.stream_name,o={publishing:!1,pendingPublish:!1,pendingPublishTimeout:void 0,muted:!1,video:!1,selectedCam:"",selectedMic:"",settings:{sdpURL:r.signaling_url,applicationName:r.application_name,streamName:r.stream_name,audioBitrate:"64",audioCodec:"opus",videoBitrate:"3500",videoCodec:"42e01f",videoFrameRate:"30",frameSize:"default"}},l?(f(),u(o.settings),c(),s.addClass("publishing"),$(".vol-settings i.unmuted",i).removeClass("hidden")):(d(_,v,h,p),u(o.settings))}));const d=(t,a,n,e)=>{s.on({gotDevices:()=>{},devicesReady:()=>{l||(l=!0,c())},onStateChanged:e=>{console.log("WowzaWebRTCPublish.onStateChanged"),console.log(e),"connected"===e.connectionState?t():"failed"===e.connectionState?a():n()},onCameraChanged:t=>{if(t!==o.selectedCam){o.selectedCam=t;let a="CameraMobile_"+t;"screen"===t&&(a="screen_screen")}},onMicrophoneChanged:t=>{t!==o.selectedMic&&(o.selectedMic=t)},onError:e}),s.set({videoElementPublish:$("#translator #localVideo"),useSoundMeter:!1})},u=t=>(o.settings=t,s.set(t)),c=()=>{(()=>{if(""===o.settings.sdpURL)throw"No stream configured.";if(""===o.settings.applicationName)throw"Missing application name.";if(""===o.settings.streamName)throw"Missing stream name.";return!0})()&&(s.start(),f(),i.addClass("publishing"),console.log(i),console.log($("#translatorList .vol-settings i.unmuted",i)),$(".vol-settings i.unmuted",i).removeClass("hidden"))},m=()=>{s.stop(),$("#translatorList .item").removeClass("disabled"),$("#translatorList .item .vol-settings i").addClass("hidden"),b()},p=t=>{let a;"OverconstrainedError"==t.name?(a="Your browser or camera does not support this frame size",(t=>{let a=JSON.parse(JSON.stringify(s.getState().constraints));"default"===t?(a.video.width={min:"640",ideal:"1280",max:"1920"},a.video.height={min:"360",ideal:"720",max:"1080"}):(a.video.width={exact:t[0]},a.video.height={exact:t[1]}),s.set({constraints:a})})("default")):a=t.message?t.message:t,console.log(a),m()},g=t=>{t?(o.pendingPublish=!0,o.pendingPublishTimeout=setTimeout((()=>{m(),p({message:"Publish failed. Unable to connect."}),g(!1)}),1e4)):(o.pendingPublish=!1,null!=o.pendingPublishTimeout&&(clearTimeout(o.pendingPublishTimeout),o.pendingPublishTimeout=void 0))},_=()=>{o.publishing=!0,g(!1)},v=()=>{g(!1),_(),p({message:"Peer connection failed."}),$("#translatorList .item").removeClass("disabled"),$("#translatorList .item .vol-settings i").addClass("hidden"),b()},h=()=>{o.pendingPublish||(o.publishing=!1)};function f(){Socket.Send("Soundchannels.showOnAir",a,{client:"client"})}function b(){Socket.Send("Soundchannels.streamFinished",n,{client:"client"}),e=void 0,a=void 0,n=void 0}return $(document).on("click","#translatorList .item .vol-settings .unmuted",(function(t){t.stopPropagation();var a=$(this).closest(".item");o.muted=!0,s.setAudioEnabled(!1),$(this).addClass("hidden"),$(".muted",a).removeClass("hidden")})),$(document).on("click","#translatorList .item .vol-settings .muted",(function(t){t.stopPropagation();var a=$(this).closest(".item");o.muted=!1,s.setAudioEnabled(!0),$(this).addClass("hidden"),$(".unmuted",a).removeClass("hidden")})),{Init:function(){if(t=$("template#tplTranslatorItem").remove().contents(),r(),"translator"==AppData.profile.group)if(AppData.modulsettings.translator_use_relay){$("#landing .translator_buttons").removeClass("hidden");let t=AppData.translator.find((function(t){return t.main_lang})),a=AppData.translator.find((function(t){return t.is_floor})),n=AppData.translator.find((function(t){return t.assigned_translator.indexOf(AppData.profile.id)>-1}));if(null!=n){let e=$(document.createDocumentFragment()),i=$("<div/>").addClass("relay_outputs"),s=$("<div/>").addClass("relay_inputs"),l=$("<button/>").addClass("btn translator_main_lang translator_output_btn").attr("data-main_lang",t.main_lang).html(t.name[localState.lang]),o=$("<button/>").addClass("btn translator_own_lang translator_output_btn active").attr("data-main_lang",n.main_lang).html(n.name[localState.lang]);i.append('<div class="outputs_title">Output</div>'),i.append(l),i.append(o);let r=$("<button/>").addClass("btn translator_main_in_lang translator_input_btn").attr("data-id",t.id).html(t.name[localState.lang]),d=$("<button/>").addClass("btn translator_floor_lang translator_input_btn").attr("data-id",a.id).html(a.name[localState.lang]),u=$("<button/>").addClass("btn translator_floor_lang translator_input_btn active").attr("data-id","turnoffTranslation").html("Turn off");s.append('<div class="inputs_title">Input</div>'),s.append(r),s.append(d),s.append(u),e.append(s),e.append(i),$("#landing .translator_buttons").html(e),$("#landing .translator_output_btn").on("click",(function(){$("#landing .translator_output_btn").removeClass("active"),$(this).addClass("active");let t={user_id:AppData.profile.id,main_lang:$(this).attr("data-main_lang")};Socket.Send("Translator.setOwnLang",{sender_lang:n.id,main_clicked:t.main_lang},{group:["translator"]}),Socket.Send("TranslatorRelay.changeInputs",t)})),$("#landing .translator_input_btn").on("click",(function(){$("#landing .translator_input_btn").removeClass("active"),$(this).addClass("active");let t=$(this).attr("data-id");Soundchannels.showDetails(t)}))}}else $("#landing .translator_buttons").addClass("hidden");else $("#landing .translator_buttons").remove()},BuildFromSource:function(){$.post("api/",{do:"getTranslator"},(function(t){AppData.translator=t,r()}))},showDetails:function(t){},setOwnLang:function(t){let a=AppData.translator.find((function(t){return t.assigned_translator.indexOf(AppData.profile.id)>-1}));t.sender_lang==a.id?"true"==t.main_clicked?($("#landing .translator_output_btn").removeClass("active"),$("#landing .translator_main_lang").addClass("active")):($("#landing .translator_output_btn").removeClass("active"),$("#landing .translator_own_lang").addClass("active")):"true"==t.main_clicked&&($("#landing .translator_output_btn").removeClass("active"),$("#landing .translator_own_lang").addClass("active"))},toggleRelayBtns:function(){AppData.modulsettings.translator_use_relay?$("#landing .translator_buttons").removeClass("hidden"):$("#landing .translator_buttons").addClass("hidden")}}}();
var TranslatorRelay=function(){let t=[];let e=!1;return $(document).on("click",".start-publishing",(function(){for(let e in t)t[e].initialized||(t[e].init(),t[e].update(t[e].state.settings))})),$(document).on("click",".set-input-devices",(function(){if(!e){e=!0;let t=[];$("#translator-relay .input-select").each((function(e,a){t.push({translator_id:$(this).attr("data-translator"),device_id:$(this).val()})})),$.ajax({method:"post",url:"api/",data:{do:"setDefaultDevices",data:t},success:function(t){AppData.translator=t,Modal.alert("Saved."),e=!1},error:function(){Modal.alert("Error."),e=!1}})}})),{Init:function(){t=[],$.each(AppData.translator,(function(e,a){if(null!=a.visible&&a.visible){let e=new WebRTCPublisher(a);t.push(e)}}));let e=AppData.translator.find((function(t){return t.is_floor}));if(e){let a=new WebRTCPublisher(e);t.push(a)}},BuildFromSource:function(){$.post("api/",{do:"getTranslator"},(function(t){AppData.translator=t}))},showDetails:function(t){},changeInputs:function(e){if(console.log(e),t.length>0){let a,n,i=[];for(let r in t)t[r].is_main?a=t[r]:t[r].translator_item.assigned_translator.indexOf(e.user_id)>-1?n=t[r]:i.push(t[r]);"true"==e.main_lang?(a.inputSelect.val(n.translator_item.deviceId),a.changeInput(n.translator_item.deviceId),n.inputSelect.val(a.translator_item.deviceId),n.changeInput(a.translator_item.deviceId)):(a.inputSelect.val(a.translator_item.deviceId),a.changeInput(a.translator_item.deviceId),n.inputSelect.val(n.translator_item.deviceId),n.changeInput(n.translator_item.deviceId));for(let t in i)i[t].inputSelect.val(i[t].translator_item.deviceId),i[t].changeInput(i[t].translator_item.deviceId)}}}}();
var Trueconf=function(){var t;function n(){t=$("template#tplTrueconfItem").contents(),o()}function o(){var n=$(document.createDocumentFragment()),o=t.clone();AppData.trueconf.sort((function(t,n){return void 0!==t.sort_id&&void 0!==n.sort_id?parseInt(t.sort_id)>parseInt(n.sort_id)?1:-1:0})),$.each(AppData.trueconf,(function(e,r){null!=r.visible&&r.visible&&((o=t.clone()).attr("data-id",r.id).attr("data-room",r.trueconf_room),o.find(".data-name").html(r.title[AppData.settings.lang]),o.appendTo(n))})),$("#trueconf #trueconfList").html(n)}function e(t){if(t){var n,o,e;let a=!1;if("exhibitor"==t)n=AppData.profile.trueconf_room,o="exhibitor","director"!=AppData.profile.group&&"moderator"!=AppData.profile.group||(o="workshop"),"translator"==AppData.profile.group&&AppData.modulsettings.translator_use_relay&&(a=!0);else{var r=AppData.trueconf.find((function(n){return n.id==t}));o="workshop",n=r.trueconf_room,e=r.channel}a?trueconf_translator_opened?closeTrueConfCall("translator"):(closeTrueConfCall("translator"),openTrueConfCall(n,o,e,!1,a)):trueconf_opened?closeTrueConfCall("default"):(closeTrueConfCall("default"),openTrueConfCall(n,o,e))}}return $(document).on("click","#trueconfList .item",(function(t){e($(this).attr("data-id"))})),$(document).on("click",".landing_elements .trueconf .translator_btn",(function(){Layout.show("soundchannels")})),$(document).on("click",".landing_elements .trueconf .closetrueconf_btn",(function(){closeTrueConfCall("default")})),{Init:n,BuildFromSource:function(){$.post("api/",{do:"getTrueconf"},(function(t){AppData.trueconf=t,n()}))},BuildBroadcast:o,showDetails:e,showTranslator:function(){AppData.modulsettings.showtransbutton_trueconf?$("#landing .landing_elements .trueconf .translator_btn").show():$("#landing .landing_elements .trueconf .translator_btn").hide()},pushTcRoom:function(t){closeTrueConfCall(),openTrueConfCall(t,"workshop")}}}();
var Unity3d=function(){var e,t,n,i,o,d="showexit:1";function a(){AppData.unity3d.sort((function(e,t){return void 0!==e.sort_id&&void 0!==t.sort_id?parseInt(e.sort_id)>parseInt(t.sort_id)?1:-1:0})),function(){var e=$("#unity3d .unity3dList"),t=$("template#tplUnity3dItem").contents(),n=$(document.createDocumentFragment());$.each(AppData.unity3d,(function(e,i){if(Boolean(i.active)){var o=t.clone();o.attr("data-id",i.u3did),o.find(".data-title").html(i.title),o.appendTo(n)}})),e.html(n),$("#unity3d").find(".no-result").toggle(Boolean(!AppData.unity3d.length))}(),n=videojs("unity_video")}function s(n,i){$("#unity3d-details").show(),$("#unity3d-details .loader").show(),t=n,from3d=i||AppData.settings.unity_url,void 0!==e&&o==from3d?e.SendMessage("Logic","LoadScene",n):createUnityInstance(document.querySelector("#unitcanvas"),{dataUrl:from3d+"webgl.data.unityweb",frameworkUrl:from3d+"webgl.framework.js.unityweb",codeUrl:from3d+"webgl.wasm.unityweb",streamingAssetsUrl:"StreamingAssets",companyName:"DefaultCompany",productName:"bus_terminal",productVersion:"0.1"},(function(e){let t=Math.round(100*e);$("#unity3d-details .loader .percentage-line").css({width:t+"%"})})).then((t=>{e=t,o=from3d}))}let c=!0,u=1e3,l={};function r(){if(c&&Object.keys(l).length>0){c=!1,setTimeout((function(){c=!0}),u),u=1e4;for(let t in l)f(l[t],(function(n){let i=n.participants;console.log(t+"|Active users\n"+i.length),e.SendMessage("Logic","UpdateString",t+"|Active users\n"+i.length)}))}}function f(e,t){$.ajax({method:"post",url:"api/",dataType:"json",data:{do:"checkTrueConfRoom",room:e,server:"exhibitor"},success:function(e){t(e)}})}function y(e){$("#unity3d-details .tutorial .slide").each((function(t,n){$(this).removeClass("out-left"),$(this).removeClass("out-right"),t<e?$(this).addClass("out-left"):t>e&&$(this).addClass("out-right")}));var t=$("#unity3d-details .dots .dot");t.each((function(t,n){$(this).removeClass("completed"),t<=e&&$(this).addClass("completed")}));var n=$("#unity3d-details #next-tutorial");e===t.length-1?n.html("Enter"):n.html("Next")}return $(document).on("click","#unity3d-details #unityContainer",(function(t){e.SendMessage("Logic","ContinueGame")})),$(document).on("click","#unity3d-details .close_poster",(function(e){$("#unity3d-details .end3d").hide(),$("#unity3d-details #poster_viewer").attr("src",""),$("#unity3d-details .poster_viewer").hide()})),$(document).on("click","#unity3d-details .close_stand",(function(e){$("#unity3d-details .end3d").hide(),$("#unity3d-details #stand_viewer").attr("src",""),$("#unity3d-details .stand_viewer").hide()})),$(document).on("click","#unity3d-details .close_video",(function(e){$("#unity3d-details .end3d").hide(),n.pause(),$("#unity3d-details .video_viewer").hide()})),$(document).on("pointerlockchange",(function(t){if(console.log("pointerlock change",d,document.pointerLockElement),null==document.pointerLockElement){var n="esc";console.log(d),""!=d&&(n+=";"+d),e.SendMessage("Logic","Keypress",n),d="showexit:1"}})),$(document).on("click","#unity3d-details #end-tutorial",(function(){e.SendMessage("Logic","ContinueGame")})),$(document).on("click","#unity3d-details #next-tutorial",(function(){var t=$("#unity3d-details .dots .dot:not(.completed)");if(t.length>0){let e=t.attr("data-index");y(parseInt(e))}else e.SendMessage("Logic","ContinueGame"),$("#unity3d-details #unityContainer canvas").get(0).requestPointerLock(),$("#unity3d-details .tutorial").hide(),$("#unity3d-details .help").removeClass("not-shown")})),$(document).on("click","#unity3d-details #end-tutorial",(function(){e.SendMessage("Logic","ContinueGame"),$("#unity3d-details #unityContainer canvas").get(0).requestPointerLock(),$("#unity3d-details .tutorial").hide(),$("#unity3d-details .help").removeClass("not-shown")})),$(document).on("click","#unity3d-details .dots .dot",(function(){y(parseInt($(this).attr("data-index")))})),$(document).on("click","#unity3d-details #cancel-logout",(function(){e.SendMessage("Logic","ContinueGame"),$("#unity3d-details .end3d").hide()})),$(document).on("click","#unity3d-details #accept-logout",(function(){e.SendMessage("Logic","ReleaseKeyBoard"),$("#unity3d-details .end3d").hide(),$("#unity3d-details").hide(),from3d=!1})),$(document).on("click","#unity3d-details #cancel-open",(function(){e.SendMessage("Logic","ContinueGame"),$("#unity3d-details .open_new_window").hide()})),$(document).on("click","#unity3d-details #accept-open",(function(){e.SendMessage("Logic","Keypress","esc;showexit:0"),$("#unity3d-details .open_new_window").hide(),$("#unity3d-details #poster_viewer").attr("src","upload/"+i+".pdf"),$("#unity3d-details .poster_viewer").show(),$("#unity3d-details .reactivate").show()})),$(document).on("click","#unity3d-details .reactivate",(function(){e.SendMessage("Logic","ContinueGame"),$("#unity3d-details #unityContainer canvas").get(0).requestPointerLock(),$("#unity3d-details .reactivate").hide()})),$(document).on("click","#unity3d .unity3dList .item",(function(e){s(this.dataset.id)})),{Init:a,BuildFromSource:function(){$.post("api/",{do:"getUnity3d"},(function(e){AppData.unity3d=e,a()}))},Build:function(){},showDetails:function(e){s(AppData.unity3d.filter((function(t){return t.id===e}))[0].u3did)},entered:function(t){if(console.log("Entered",t),"coffe_approach"!=t.door){if("chat_corner"==t.area)return e.SendMessage("Logic","Keypress","esc;showexit:0"),closeTrueConfCall("3d"),void openTrueConfCall(l[t.door],"exhibitor");if("pdf"==t.area)return e.SendMessage("Logic","Keypress","esc;showexit:0"),$("#unity3d-details .open_new_window").show(),void(i=t.door);if("exhibitor"==t.area){e.SendMessage("Logic","Keypress","esc;showexit:0");var n=AppData.settings.infopanel_url+"/"+t.door;return n+="?pid="+encodeURIComponent(btoa(AppData.profile.id)),$("#unity3d-details #stand_viewer").attr("src",n),void $("#unity3d-details .stand_viewer").css("display","flex").hide().fadeIn(400,(function(){$("#unity3d-details .reactivate").show()}))}}else r()},exited:function(e){console.log("Exited",e)},start:function(n){console.log("start",n),n.current_scene_id!==t&&e.SendMessage("Logic","LoadScene",t),r(),function(){if("poster_hall"===t){var n=AppData.countries.filter((function(e){return 1===parseInt(e.is_active)})).map((function(e){return e.iso.toLowerCase()}));e.SendMessage("Logic","HandleData","fisu_hall:,"+n.join(","))}}(),$("#unity3d-details .loader").fadeOut(400,(function(){$("#unity3d-details .help").addClass("not-shown"),$("#unity3d-details .tutorial").fadeIn(400)}))},mouseUp:function(e){console.log("mouseUp",e)},keypress:function(e){if("esc"==e.key&&""!=e.additionalData){var t=e.additionalData.split(","),n={};t.forEach((function(e){var t=e.split(":");n[t[0]]=t[1]})),1==n.showexit&&$("#unity3d-details .end3d").show(),d=e.additionalData}},load3DPlayer:s,callbackHandler:function(e,t){"function"==typeof Unity3d[e]&&Unity3d[e](JSON.parse(t))},call_exhibitor:function(t){e.SendMessage("Logic","Keypress","esc;showexit:0"),f(t,(function(t){for(var n=!1,i=t.participants,o=0;o<i.length;o++)if(i[o].id.indexOf("exhibitor")>-1){n=!0;break}n?(closeTrueConfCall("3d"),openTrueConfCall(t.room,"exhibitor"),$("#unity3d-details .reactivate").hide()):Modal.alert(Language.getItem("exhibitor-not-available"),(function(){e.SendMessage("Logic","ContinueGame")}))}))},openTextChat:function(t){null!=e&&e.SendMessage("Logic","ReleaseKeyBoard"),Chat.showFloatingChat(t)}}}();
var Useful=function(){"use strict";var t,e;function l(){e.sort((function(t,e){return t.title[localState.lang].localeCompare(e.title[localState.lang])}));var l=$("#useful #usefulList"),a=$(document.createDocumentFragment()),u=e.filter((function(t){return!0===t.visible}));$.each(u,(function(e,l){var u=t.clone();u.attr("data-index",l.id),u.find(".data-title").text(l.title[localState.lang]),u.appendTo(a)})),l.html(a)}function a(){localState.useful={itemIndex:$(this).data("index")||0},u(),Layout.show("useful-details")}function u(){if("useful"in localState){var t=$("#useful-details .data-label"),l=e.find((function(t){return t.id===localState.useful.itemIndex}))||e[0];if(!l)return!1;t.text(l.title[localState.lang]),$("#useful-details embed").attr("src","./pdfjs/web/viewer.html?file=../../upload/docs/"+l.files[localState.lang].filename)}}return{Init:function(){t=$("template#tplUsefulItem").remove().contents(),e=AppData.docs.filter((function(t){return"useful"==t.type&&t.visible})),l(),u(),$(document).on("click","#useful .item",a),delete Useful.Init},showDetails:function(t){t&&(null!=localState.useful?t===localState.useful.itemIndex&&0!==localState.useful.itemIndex||(localState.useful.itemIndex=String(t),u()):localState.useful={itemIndex:String(t)},Layout.show("useful-details"))},BuildFromSource:function(){$.post("api/",{do:"getDocs"},(function(t){AppData.docs=t,e=AppData.docs.filter((function(t){return"useful"==t.type&&t.visible})),l(),t=null}))}}}();
var Weblinks=function(){let n,e,i,t=!0;function a(n){var e,i,a;if((e=null!=n.link?n.link:$(this).attr("data-link")).indexOf("{{hash}}")>-1&&(e=e.replace("{{hash}}",AppData.profile.hash)),void 0===window.webkit)if("undefined"==typeof Android||null===Android){if(e.indexOf("{{user_hash}}")>-1&&(e=e.replace("{{user_hash}}","/?uid="+AppData.profile.hash+"&lang="+localState.lang),getIsPremium()),e.indexOf("airmeet")>-1&&null!=AppData.profile.airmeet_link&&""!=AppData.profile.airmeet_link&&(e=AppData.profile.airmeet_link),i=null!=n.open_in_blank?n.open_in_blank:$(this).attr("data-blank"),"1"==(null!=n.open_in_landing?n.open_in_landing:$(this).attr("data-landing")))return a=null!=n.is_hidden?n.is_hidden:$(this).attr("data-hidden"),$("#viewer360").unbind("load").bind("load",(function(){"1"===n.show_close_button_on_landing?$("#landing .landing_elements .closeweblink_btn").show():l()})),$(".landing_elements .viewer360 #viewer360").is(":visible")||$(".landing_elements .viewer360 #viewer360").attr("src",e),$(".landing_elements .viewer360").addClass("shown"),void("1"==a?$(".landing_elements .viewer360").css("flex","0"):$(".landing_elements .viewer360").css("flex",""));"1"!=i?(t=!0,writeDbLog("open link",e,"user_logs","weblinks"),$("#weblinksIframeId").attr("src",e),Layout.show("weblinks-details")):window.open(e)}else Android.openUrl(e);else window.webkit.messageHandlers.openUrl.postMessage(e)}function l(){$(".landing_elements .viewer360").removeClass("shown"),$(".landing_elements .viewer360 #viewer360").attr("src",""),$("#landing .landing_elements .closeweblink_btn").hide()}function d(e){AppData.weblinks.sort((function(n,e){return void 0!==n.sort_id&&void 0!==e.sort_id?parseInt(n.sort_id)>parseInt(e.sort_id)?1:-1:0})),AppData.weblinkgroups.sort((function(n,e){return void 0!==n.sort_id&&void 0!==e.sort_id?parseInt(n.sort_id)>parseInt(e.sort_id)?1:-1:0}));var t=$("#weblinks .weblinksList"),a=$(document.createDocumentFragment()),l=[];0==AppData.weblinkgroups.length&&(l=AppData.weblinks);var d=AppData.weblinkgroups;(null!=e&&(d=AppData.weblinkgroups.filter((function(n){return $.inArray(n.id,e)>-1}))),i=e,$.each(d,(function(e,i){var t=0,d=$("<h3/>").addClass("grouptitle").css({color:i.titlecolor||"#555555"}).html(i.title[localState.lang]);d.appendTo(a),$.each(AppData.weblinks,(function(e,d){var s=l.find((function(n){return n.id==d.id}));if(""!=d.group&&null!=d.group||null!=s||l.push(d),d.group==i.id&&d.active){t++;var o=n.clone();o.find(".data-title").html(d.name[localState.lang]),o.attr("data-link",d.link),o.attr("data-blank",d.open_in_blank),o.attr("data-landing",d.open_in_landing),o.attr("data-hidden",d.is_hidden),o.appendTo(a),d.file&&o.find(".data-image").attr("src",d.file.path),1==d.show_image?(i.alignment&&o.find(".info").css("text-align",i.alignment),o.find(".data-title").hide(),o.find(".data-image").show(),i.logo_height&&o.find(".data-image").css("max-height",i.logo_height+"px"),o.find(".fa-sticky-note").hide()):(o.find(".data-title").show(),o.find(".data-image").hide(),o.find(".fa-sticky-note").show())}})),0==t&&d.remove()})),l.length>0)&&($("<h3/>").addClass("grouptitle").html("&nbsp;").appendTo(a),$.each(l,(function(e,i){if(i.active){var t=n.clone();t.find(".data-title").html(i.name[localState.lang]),t.attr("data-link",i.link),t.attr("data-blank",i.open_in_blank),t.attr("data-landing",i.open_in_landing),t.attr("data-hidden",i.is_hidden),t.appendTo(a),i.file&&t.find(".data-image").attr("src",i.file.path),1==i.show_image?(t.find(".data-title").hide(),t.find(".data-image").show(),t.find(".fa-sticky-note").hide()):(t.find(".data-title").show(),t.find(".data-image").hide(),t.find(".fa-sticky-note").show())}})));t.html(a),$("#weblinks").find(".no-result").toggle(Boolean(!AppData.weblinks.length))}return $(document).on("click","#weblinks-details .close_stand",(function(n){$("#weblinks-details #stand_viewer").attr("src",""),$("#weblinks-details .stand_viewer").hide()})),$(document).on("click",".landing_elements .closeweblink_btn",(function(n){$(".landing_elements .viewer360").toggleClass("shown"),$(".landing_elements .closeweblink_btn").hide(),$(".landing_elements .viewer360 #viewer360").attr("src","")})),{Init:function(){n=$("template#tplWeblinksItem").contents().remove(),d(),$("#weblinksIframeId").unbind("load"),$(document).on("click","#weblinks .item",a)},render:d,showDetails:function(n){if("all_links"==n){d(AppData.weblinkgroups.map((function(n){return n.id}))),Layout.show("weblinks")}else{var e=AppData.weblinks.find((function(e){return n==e.id}));if(null!=e)"1"!=e.open_in_blank&&e.open_in_landing,a(e),"1"!=e.open_in_blank&&e.open_in_landing;else{var i=AppData.weblinkgroups.find((function(e){return n==e.id}));null!=i&&(d([i.id]),Layout.show("weblinks"))}}},update:function(n){$.post("api/",{do:"getWeblinks"},(function(n){AppData.weblinks=n,d(i),n=null}))},updateGroups:function(){$.post("api/",{do:"getWeblinkgroups"},(function(n){AppData.weblinkgroups=n,d(i),n=null}))},showPortal:function(n){$("#weblinks-details #stand_viewer").attr("src",n),$("#weblinks-details .stand_viewer").css("display","flex").hide().fadeIn(400,(function(){}))},loadtimer:e,checkCloseBtn:function(n){$.post("api/",{do:"getWeblinks"},(function(e){AppData.weblinks=e,"1"===(n=AppData.weblinks.filter((function(e){return e.id===n}))[0]).show_close_button_on_landing?$("#landing .landing_elements .closeweblink_btn").show():$("#landing .landing_elements .closeweblink_btn").hide(),e=null}))},closeWeblinkIframe:l}}();

var Modal=function(){"use strict";var t,n,e,o="icon-main far fa-window-restore";return{Init:function(){(t=$("#modal")).hide(),$(document).on("click","#modal .btn.accept, #modal .btn.close",(function(){t.hide(),"function"==typeof n&&(n.call(),n=null)})),$(document).on("click","#modal .btn.dismiss",(function(){t.hide(),"function"==typeof e&&(e.call(),e=null)})),delete Modal.Init},alert:function(e,i,a=!1){t.removeClass("dark"),t.find(".image").removeClass("shown"),t.find(".modalchk_cont").hide(),t.addClass("small_popup"),t.find("article").addClass("small_popup"),t.find(".icon_cont").show(),t.find(".icon_cont i").removeClass().addClass(o),n=i,t.find(".title").text(Language.getItem("modal-alert")),t.find(".text").html(e),t.find(".btn.accept").hide(),t.find(".btn.dismiss").hide(),t.find(".modal_closebutton").text(Language.getItem("close")),t.find(".btn.close").show(),!0===a&&(t.find(".icon_cont").hide(),t.find(".title").hide()),t.show()},confirm:function(e,i){t.find(".icon_cont").show(),t.find(".icon_cont i").removeClass().addClass(o),t.removeClass("dark"),t.find(".modalchk_cont").hide(),t.find(".image").removeClass("shown"),n=i,t.find(".title").text(Language.getItem("modal-confirm")),t.find(".text").text(e),t.find(".btn.accept").show(),t.find(".btn.dismiss").show(),t.find(".btn.close").hide(),t.show()},notification:function(e,o){n=o,""!=e.icon||null!=e.icon?(t.find(".icon_cont i").removeClass().addClass("icon-main").addClass(e.icon),t.find(".icon_cont").show()):t.find(".icon_cont").hide(),e.small_popup?(t.addClass("small_popup"),t.find("article").addClass("small_popup")):(t.removeClass("small_popup"),t.find("article").removeClass("small_popup")),t.removeClass("dark"),t.find(".modalchk_cont").hide(),t.find(".title").text(e.title[localState.lang]),t.find(".text").html(e.text[localState.lang]),void 0!==e.closebuttontext&&""!==e.closebuttontext[localState.lang]?t.find(".modal_closebutton").text(e.closebuttontext[localState.lang]):t.find(".modal_closebutton").text(AppData.languages[localState.lang].close);var i=e.files||void 0;t.find(".image").removeClass("shown"),i&&null!=i[localState.lang]&&t.find(".image").html('<img src="'+i[localState.lang].path+'">').addClass("shown"),t.find(".btn.accept").hide(),t.find(".btn.dismiss").hide(),e.canClose?t.find(".btn.close").show():t.find(".btn.close").hide(),e.has_checkbox?(t.find(".modalchk_cont").show(),void 0!==e.checkboxtext&&""!==e.checkboxtext[localState.lang]?t.find(".checkboxtext").text(e.checkboxtext[localState.lang]):t.find(".checkboxtext").text(AppData.languages[localState.lang].checkboxtext)):t.find(".modalchk_cont").hide(),e.darkmode?t.addClass("dark"):t.removeClass("dark"),t.show()},resultconfirmation:function(e,o){n=o,t.removeClass("dark"),t.find(".modalchk_cont").hide(),t.find(".title").text(e.title),t.find(".text").text(e.text),t.find(".btn.accept").hide(),t.find(".btn.dismiss").hide(),e.canClose?t.find(".btn.close").show():t.find(".btn.close").hide(),t.show()},confirmWithDismiss:function(i,a,l){t.find(".icon_cont").show(),t.find(".icon_cont i").removeClass().addClass(o),t.removeClass("dark"),t.find(".modalchk_cont").hide(),t.find(".image").removeClass("shown"),t.addClass("small_popup"),t.find("article").addClass("small_popup"),n=a,e=l,t.find(".title").text(Language.getItem("modal-confirm")),t.find(".text").text(i),t.find(".btn.accept").show(),t.find(".btn.dismiss").show(),t.find(".btn.close").hide(),t.show()}}}();
var Notify=function(){var t,n;return $(document).on("click","#notify .notify-btn",(function(){t?Layout.swap(t):Layout.hide("notify")})),{show:function(o){(n=$("#notify")).find(".notify-title").text(Language.getItem(o.title)),n.find(".notify-text").text(Language.getItem(o.text)),t=o.layoutToShow,Layout.show("notify")}}}();